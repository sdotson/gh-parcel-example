parcelRequire=function(e,r,t,n){var i,o="function"==typeof parcelRequire&&parcelRequire,u="function"==typeof require&&require;function f(t,n){if(!r[t]){if(!e[t]){var i="function"==typeof parcelRequire&&parcelRequire;if(!n&&i)return i(t,!0);if(o)return o(t,!0);if(u&&"string"==typeof t)return u(t);var c=new Error("Cannot find module '"+t+"'");throw c.code="MODULE_NOT_FOUND",c}p.resolve=function(r){return e[t][1][r]||r},p.cache={};var l=r[t]=new f.Module(t);e[t][0].call(l.exports,p,l,l.exports,this)}return r[t].exports;function p(e){return f(p.resolve(e))}}f.isParcelRequire=!0,f.Module=function(e){this.id=e,this.bundle=f,this.exports={}},f.modules=e,f.cache=r,f.parent=o,f.register=function(r,t){e[r]=[function(e,r){r.exports=t},{}]};for(var c=0;c<t.length;c++)try{f(t[c])}catch(e){i||(i=e)}if(t.length){var l=f(t[t.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=l:"function"==typeof define&&define.amd?define(function(){return l}):n&&(this[n]=l)}if(parcelRequire=f,i)throw i;return f}({"vCxL":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.__extends=e,exports.__rest=n,exports.__decorate=o,exports.__param=a,exports.__metadata=i,exports.__awaiter=u,exports.__generator=c,exports.__createBinding=f,exports.__exportStar=l,exports.__values=s,exports.__read=p,exports.__spread=y,exports.__spreadArrays=_,exports.__await=h,exports.__asyncGenerator=v,exports.__asyncDelegator=d,exports.__asyncValues=b,exports.__makeTemplateObject=w,exports.__importStar=x,exports.__importDefault=m,exports.__classPrivateFieldGet=O,exports.__classPrivateFieldSet=g,exports.__assign=void 0;var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};function e(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}var r=function(){return exports.__assign=r=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},r.apply(this,arguments)};function n(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(t);o<n.length;o++)e.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(t,n[o])&&(r[n[o]]=t[n[o]])}return r}function o(t,e,r,n){var o,a=arguments.length,i=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(t,e,r,n);else for(var u=t.length-1;u>=0;u--)(o=t[u])&&(i=(a<3?o(i):a>3?o(e,r,i):o(e,r))||i);return a>3&&i&&Object.defineProperty(e,r,i),i}function a(t,e){return function(r,n){e(r,n,t)}}function i(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}function u(t,e,r,n){return new(r||(r=Promise))(function(o,a){function i(t){try{c(n.next(t))}catch(e){a(e)}}function u(t){try{c(n.throw(t))}catch(e){a(e)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then(i,u)}c((n=n.apply(t,e||[])).next())})}function c(t,e){var r,n,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function u(a){return function(u){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;i;)try{if(r=1,n&&(o=2&a[0]?n.return:a[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,a[1])).done)return o;switch(n=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,n=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===a[0]||2===a[0])){i=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){i.label=a[1];break}if(6===a[0]&&i.label<o[1]){i.label=o[1],o=a;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(a);break}o[2]&&i.ops.pop(),i.trys.pop();continue}a=e.call(t,i)}catch(u){a=[6,u],n=0}finally{r=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,u])}}}function f(t,e,r,n){void 0===n&&(n=r),t[n]=e[r]}function l(t,e){for(var r in t)"default"===r||e.hasOwnProperty(r)||(e[r]=t[r])}function s(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function p(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,o,a=r.call(t),i=[];try{for(;(void 0===e||e-- >0)&&!(n=a.next()).done;)i.push(n.value)}catch(u){o={error:u}}finally{try{n&&!n.done&&(r=a.return)&&r.call(a)}finally{if(o)throw o.error}}return i}function y(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(p(arguments[e]));return t}function _(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;var n=Array(t),o=0;for(e=0;e<r;e++)for(var a=arguments[e],i=0,u=a.length;i<u;i++,o++)n[o]=a[i];return n}function h(t){return this instanceof h?(this.v=t,this):new h(t)}function v(t,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,o=r.apply(t,e||[]),a=[];return n={},i("next"),i("throw"),i("return"),n[Symbol.asyncIterator]=function(){return this},n;function i(t){o[t]&&(n[t]=function(e){return new Promise(function(r,n){a.push([t,e,r,n])>1||u(t,e)})})}function u(t,e){try{(r=o[t](e)).value instanceof h?Promise.resolve(r.value.v).then(c,f):l(a[0][2],r)}catch(n){l(a[0][3],n)}var r}function c(t){u("next",t)}function f(t){u("throw",t)}function l(t,e){t(e),a.shift(),a.length&&u(a[0][0],a[0][1])}}function d(t){var e,r;return e={},n("next"),n("throw",function(t){throw t}),n("return"),e[Symbol.iterator]=function(){return this},e;function n(n,o){e[n]=t[n]?function(e){return(r=!r)?{value:h(t[n](e)),done:"return"===n}:o?o(e):e}:o}}function b(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e,r=t[Symbol.asyncIterator];return r?r.call(t):(t="function"==typeof s?s(t):t[Symbol.iterator](),e={},n("next"),n("throw"),n("return"),e[Symbol.asyncIterator]=function(){return this},e);function n(r){e[r]=t[r]&&function(e){return new Promise(function(n,o){(function(t,e,r,n){Promise.resolve(n).then(function(e){t({value:e,done:r})},e)})(n,o,(e=t[r](e)).done,e.value)})}}}function w(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}function x(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}function m(t){return t&&t.__esModule?t:{default:t}}function O(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)}function g(t,e,r){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,r),r}exports.__assign=r;
},{}],"KxmD":[function(require,module,exports) {
var global = arguments[3];
var r=arguments[3];Object.defineProperty(exports,"__esModule",{value:!0}),exports.areCookiesEnabled=w,exports.async=X,exports.calculateBackoffMillis=hr,exports.contains=F,exports.createSubscribe=G,exports.deepCopy=u,exports.deepExtend=f,exports.errorPrefix=Z,exports.getUA=l,exports.isBrowser=_,exports.isBrowserExtension=y,exports.isElectron=E,exports.isEmpty=z,exports.isIE=g,exports.isIndexedDBAvailable=O,exports.isMobileCordova=v,exports.isNode=b,exports.isNodeSdk=S,exports.isReactNative=x,exports.isSafari=m,exports.isUWP=A,exports.jsonEval=j,exports.map=U,exports.ordinal=ur,exports.querystring=H,exports.querystringDecode=q,exports.safeGet=W,exports.stringify=k,exports.validateCallback=tr,exports.validateContextObject=er,exports.validateIndexedDBOpenable=C,exports.validateNamespace=rr,exports.validateArgCount=exports.stringToByteArray=exports.stringLength=exports.issuedAtTime=exports.isValidTimestamp=exports.isValidFormat=exports.isAdmin=exports.decode=exports.base64Encode=exports.base64Decode=exports.base64=exports.assertionError=exports.assert=exports.Sha1=exports.RANDOM_FACTOR=exports.MAX_VALUE_MILLIS=exports.FirebaseError=exports.ErrorFactory=exports.Deferred=exports.CONSTANTS=void 0;var t=require("tslib"),e={NODE_CLIENT:!1,NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"};exports.CONSTANTS=e;var o=function(r,t){if(!r)throw n(t)};exports.assert=o;var n=function(r){return new Error("Firebase Database ("+e.SDK_VERSION+") INTERNAL ASSERT FAILED: "+r)};exports.assertionError=n;var i=function(r){for(var t=[],e=0,o=0;o<r.length;o++){var n=r.charCodeAt(o);n<128?t[e++]=n:n<2048?(t[e++]=n>>6|192,t[e++]=63&n|128):55296==(64512&n)&&o+1<r.length&&56320==(64512&r.charCodeAt(o+1))?(n=65536+((1023&n)<<10)+(1023&r.charCodeAt(++o)),t[e++]=n>>18|240,t[e++]=n>>12&63|128,t[e++]=n>>6&63|128,t[e++]=63&n|128):(t[e++]=n>>12|224,t[e++]=n>>6&63|128,t[e++]=63&n|128)}return t},s=function(r){for(var t=[],e=0,o=0;e<r.length;){var n=r[e++];if(n<128)t[o++]=String.fromCharCode(n);else if(n>191&&n<224){var i=r[e++];t[o++]=String.fromCharCode((31&n)<<6|63&i)}else if(n>239&&n<365){var s=((7&n)<<18|(63&(i=r[e++]))<<12|(63&(a=r[e++]))<<6|63&r[e++])-65536;t[o++]=String.fromCharCode(55296+(s>>10)),t[o++]=String.fromCharCode(56320+(1023&s))}else{i=r[e++];var a=r[e++];t[o++]=String.fromCharCode((15&n)<<12|(63&i)<<6|63&a)}}return t.join("")},a={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray:function(r,t){if(!Array.isArray(r))throw Error("encodeByteArray takes an array as a parameter");this.init_();for(var e=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,o=[],n=0;n<r.length;n+=3){var i=r[n],s=n+1<r.length,a=s?r[n+1]:0,c=n+2<r.length,h=c?r[n+2]:0,u=i>>2,f=(3&i)<<4|a>>4,p=(15&a)<<2|h>>6,d=63&h;c||(d=64,s||(p=64)),o.push(e[u],e[f],e[p],e[d])}return o.join("")},encodeString:function(r,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(r):this.encodeByteArray(i(r),t)},decodeString:function(r,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(r):s(this.decodeStringToByteArray(r,t))},decodeStringToByteArray:function(r,t){this.init_();for(var e=t?this.charToByteMapWebSafe_:this.charToByteMap_,o=[],n=0;n<r.length;){var i=e[r.charAt(n++)],s=n<r.length?e[r.charAt(n)]:0,a=++n<r.length?e[r.charAt(n)]:64,c=++n<r.length?e[r.charAt(n)]:64;if(++n,null==i||null==s||null==a||null==c)throw Error();var h=i<<2|s>>4;if(o.push(h),64!==a){var u=s<<4&240|a>>2;if(o.push(u),64!==c){var f=a<<6&192|c;o.push(f)}}}return o},init_:function(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(var r=0;r<this.ENCODED_VALS.length;r++)this.byteToCharMap_[r]=this.ENCODED_VALS.charAt(r),this.charToByteMap_[this.byteToCharMap_[r]]=r,this.byteToCharMapWebSafe_[r]=this.ENCODED_VALS_WEBSAFE.charAt(r),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[r]]=r,r>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(r)]=r,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(r)]=r)}}};exports.base64=a;var c=function(r){var t=i(r);return a.encodeByteArray(t,!0)};exports.base64Encode=c;var h=function(r){try{return a.decodeString(r,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};function u(r){return f(void 0,r)}function f(r,t){if(!(t instanceof Object))return t;switch(t.constructor){case Date:return new Date(t.getTime());case Object:void 0===r&&(r={});break;case Array:r=[];break;default:return t}for(var e in t)t.hasOwnProperty(e)&&p(e)&&(r[e]=f(r[e],t[e]));return r}function p(r){return"__proto__"!==r}exports.base64Decode=h;var d=function(){function r(){var r=this;this.reject=function(){},this.resolve=function(){},this.promise=new Promise(function(t,e){r.resolve=t,r.reject=e})}return r.prototype.wrapCallback=function(r){var t=this;return function(e,o){e?t.reject(e):t.resolve(o),"function"==typeof r&&(t.promise.catch(function(){}),1===r.length?r(e):r(e,o))}},r}();function l(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function v(){return"undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(l())}function b(){try{return"[object process]"===Object.prototype.toString.call(r.process)}catch(t){return!1}}function _(){return"object"==typeof self&&self.self===self}function y(){var r="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof r&&void 0!==r.id}function x(){return"object"==typeof navigator&&"ReactNative"===navigator.product}function E(){return l().indexOf("Electron/")>=0}function g(){var r=l();return r.indexOf("MSIE ")>=0||r.indexOf("Trident/")>=0}function A(){return l().indexOf("MSAppHost/")>=0}function S(){return!0===e.NODE_CLIENT||!0===e.NODE_ADMIN}function m(){return!b()&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function O(){return"indexedDB"in self&&null!=indexedDB}function C(){return new Promise(function(r,t){try{var e=!0,o="validate-browser-context-for-indexeddb-analytics-module",n=window.indexedDB.open(o);n.onsuccess=function(){n.result.close(),e||window.indexedDB.deleteDatabase(o),r(!0)},n.onupgradeneeded=function(){e=!1},n.onerror=function(){var r;t((null===(r=n.error)||void 0===r?void 0:r.message)||"")}}catch(i){t(i)}})}function w(){return!(!navigator||!navigator.cookieEnabled)}exports.Deferred=d;var D="FirebaseError",T=function(r){function e(t,o,n){var i=r.call(this,o)||this;return i.code=t,i.customData=n,i.name=D,Object.setPrototypeOf(i,e.prototype),Error.captureStackTrace&&Error.captureStackTrace(i,N.prototype.create),i}return(0,t.__extends)(e,r),e}(Error);exports.FirebaseError=T;var N=function(){function r(r,t,e){this.service=r,this.serviceName=t,this.errors=e}return r.prototype.create=function(r){for(var t=[],e=1;e<arguments.length;e++)t[e-1]=arguments[e];var o=t[0]||{},n=this.service+"/"+r,i=this.errors[r],s=i?M(i,o):"Error",a=this.serviceName+": "+s+" ("+n+").";return new T(n,a,o)},r}();function M(r,t){return r.replace(B,function(r,e){var o=t[e];return null!=o?String(o):"<"+e+"?>"})}exports.ErrorFactory=N;var B=/\{\$([^}]+)}/g;function j(r){return JSON.parse(r)}function k(r){return JSON.stringify(r)}var P=function(r){var t={},e={},o={},n="";try{var i=r.split(".");t=j(h(i[0])||""),e=j(h(i[1])||""),n=i[2],o=e.d||{},delete e.d}catch(s){}return{header:t,claims:e,data:o,signature:n}};exports.decode=P;var I=function(r){var t=P(r).claims,e=Math.floor((new Date).getTime()/1e3),o=0,n=0;return"object"==typeof t&&(t.hasOwnProperty("nbf")?o=t.nbf:t.hasOwnProperty("iat")&&(o=t.iat),n=t.hasOwnProperty("exp")?t.exp:o+86400),!!e&&!!o&&!!n&&e>=o&&e<=n};exports.isValidTimestamp=I;var L=function(r){var t=P(r).claims;return"object"==typeof t&&t.hasOwnProperty("iat")?t.iat:null};exports.issuedAtTime=L;var V=function(r){var t=P(r).claims;return!!t&&"object"==typeof t&&t.hasOwnProperty("iat")};exports.isValidFormat=V;var R=function(r){var t=P(r).claims;return"object"==typeof t&&!0===t.admin};function F(r,t){return Object.prototype.hasOwnProperty.call(r,t)}function W(r,t){return Object.prototype.hasOwnProperty.call(r,t)?r[t]:void 0}function z(r){for(var t in r)if(Object.prototype.hasOwnProperty.call(r,t))return!1;return!0}function U(r,t,e){var o={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(o[n]=t.call(e,r[n],n,r));return o}function H(r){for(var t=[],e=function(r,e){Array.isArray(e)?e.forEach(function(e){t.push(encodeURIComponent(r)+"="+encodeURIComponent(e))}):t.push(encodeURIComponent(r)+"="+encodeURIComponent(e))},o=0,n=Object.entries(r);o<n.length;o++){var i=n[o];e(i[0],i[1])}return t.length?"&"+t.join("&"):""}function q(r){var t={};return r.replace(/^\?/,"").split("&").forEach(function(r){if(r){var e=r.split("=");t[e[0]]=e[1]}}),t}exports.isAdmin=R;var J=function(){function r(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=64,this.pad_[0]=128;for(var r=1;r<this.blockSize;++r)this.pad_[r]=0;this.reset()}return r.prototype.reset=function(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0},r.prototype.compress_=function(r,t){t||(t=0);var e=this.W_;if("string"==typeof r)for(var o=0;o<16;o++)e[o]=r.charCodeAt(t)<<24|r.charCodeAt(t+1)<<16|r.charCodeAt(t+2)<<8|r.charCodeAt(t+3),t+=4;else for(o=0;o<16;o++)e[o]=r[t]<<24|r[t+1]<<16|r[t+2]<<8|r[t+3],t+=4;for(o=16;o<80;o++){var n=e[o-3]^e[o-8]^e[o-14]^e[o-16];e[o]=4294967295&(n<<1|n>>>31)}var i,s,a=this.chain_[0],c=this.chain_[1],h=this.chain_[2],u=this.chain_[3],f=this.chain_[4];for(o=0;o<80;o++){o<40?o<20?(i=u^c&(h^u),s=1518500249):(i=c^h^u,s=1859775393):o<60?(i=c&h|u&(c|h),s=2400959708):(i=c^h^u,s=3395469782);n=(a<<5|a>>>27)+i+f+s+e[o]&4294967295;f=u,u=h,h=4294967295&(c<<30|c>>>2),c=a,a=n}this.chain_[0]=this.chain_[0]+a&4294967295,this.chain_[1]=this.chain_[1]+c&4294967295,this.chain_[2]=this.chain_[2]+h&4294967295,this.chain_[3]=this.chain_[3]+u&4294967295,this.chain_[4]=this.chain_[4]+f&4294967295},r.prototype.update=function(r,t){if(null!=r){void 0===t&&(t=r.length);for(var e=t-this.blockSize,o=0,n=this.buf_,i=this.inbuf_;o<t;){if(0===i)for(;o<=e;)this.compress_(r,o),o+=this.blockSize;if("string"==typeof r){for(;o<t;)if(n[i]=r.charCodeAt(o),++o,++i===this.blockSize){this.compress_(n),i=0;break}}else for(;o<t;)if(n[i]=r[o],++o,++i===this.blockSize){this.compress_(n),i=0;break}}this.inbuf_=i,this.total_+=t}},r.prototype.digest=function(){var r=[],t=8*this.total_;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(var e=this.blockSize-1;e>=56;e--)this.buf_[e]=255&t,t/=256;this.compress_(this.buf_);var o=0;for(e=0;e<5;e++)for(var n=24;n>=0;n-=8)r[o]=this.chain_[e]>>n&255,++o;return r},r}();function G(r,t){var e=new K(r,t);return e.subscribe.bind(e)}exports.Sha1=J;var K=function(){function r(r,t){var e=this;this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(function(){r(e)}).catch(function(r){e.error(r)})}return r.prototype.next=function(r){this.forEachObserver(function(t){t.next(r)})},r.prototype.error=function(r){this.forEachObserver(function(t){t.error(r)}),this.close(r)},r.prototype.complete=function(){this.forEachObserver(function(r){r.complete()}),this.close()},r.prototype.subscribe=function(r,t,e){var o,n=this;if(void 0===r&&void 0===t&&void 0===e)throw new Error("Missing Observer.");void 0===(o=$(r,["next","error","complete"])?r:{next:r,error:t,complete:e}).next&&(o.next=Q),void 0===o.error&&(o.error=Q),void 0===o.complete&&(o.complete=Q);var i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(function(){try{n.finalError?o.error(n.finalError):o.complete()}catch(r){}}),this.observers.push(o),i},r.prototype.unsubscribeOne=function(r){void 0!==this.observers&&void 0!==this.observers[r]&&(delete this.observers[r],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))},r.prototype.forEachObserver=function(r){if(!this.finalized)for(var t=0;t<this.observers.length;t++)this.sendOne(t,r)},r.prototype.sendOne=function(r,t){var e=this;this.task.then(function(){if(void 0!==e.observers&&void 0!==e.observers[r])try{t(e.observers[r])}catch(o){"undefined"!=typeof console&&console.error&&console.error(o)}})},r.prototype.close=function(r){var t=this;this.finalized||(this.finalized=!0,void 0!==r&&(this.finalError=r),this.task.then(function(){t.observers=void 0,t.onNoObservers=void 0}))},r}();function X(r,t){return function(){for(var e=[],o=0;o<arguments.length;o++)e[o]=arguments[o];Promise.resolve(!0).then(function(){r.apply(void 0,e)}).catch(function(r){t&&t(r)})}}function $(r,t){if("object"!=typeof r||null===r)return!1;for(var e=0,o=t;e<o.length;e++){var n=o[e];if(n in r&&"function"==typeof r[n])return!0}return!1}function Q(){}var Y=function(r,t,e,o){var n;if(o<t?n="at least "+t:o>e&&(n=0===e?"none":"no more than "+e),n)throw new Error(r+" failed: Was called with "+o+(1===o?" argument.":" arguments.")+" Expects "+n+".")};function Z(r,t,e){var o="";switch(t){case 1:o=e?"first":"First";break;case 2:o=e?"second":"Second";break;case 3:o=e?"third":"Third";break;case 4:o=e?"fourth":"Fourth";break;default:throw new Error("errorPrefix called with argumentNumber > 4.  Need to update it?")}var n=r+" failed: ";return n+=o+" argument "}function rr(r,t,e,o){if((!o||e)&&"string"!=typeof e)throw new Error(Z(r,t,o)+"must be a valid firebase namespace.")}function tr(r,t,e,o){if((!o||e)&&"function"!=typeof e)throw new Error(Z(r,t,o)+"must be a valid function.")}function er(r,t,e,o){if((!o||e)&&("object"!=typeof e||null===e))throw new Error(Z(r,t,o)+"must be a valid context object.")}exports.validateArgCount=Y;var or=function(r){for(var t=[],e=0,n=0;n<r.length;n++){var i=r.charCodeAt(n);if(i>=55296&&i<=56319){var s=i-55296;o(++n<r.length,"Surrogate pair missing trail surrogate."),i=65536+(s<<10)+(r.charCodeAt(n)-56320)}i<128?t[e++]=i:i<2048?(t[e++]=i>>6|192,t[e++]=63&i|128):i<65536?(t[e++]=i>>12|224,t[e++]=i>>6&63|128,t[e++]=63&i|128):(t[e++]=i>>18|240,t[e++]=i>>12&63|128,t[e++]=i>>6&63|128,t[e++]=63&i|128)}return t};exports.stringToByteArray=or;var nr=function(r){for(var t=0,e=0;e<r.length;e++){var o=r.charCodeAt(e);o<128?t++:o<2048?t+=2:o>=55296&&o<=56319?(t+=4,e++):t+=3}return t};exports.stringLength=nr;var ir=1e3,sr=2,ar=144e5;exports.MAX_VALUE_MILLIS=ar;var cr=.5;function hr(r,t,e){void 0===t&&(t=ir),void 0===e&&(e=sr);var o=t*Math.pow(e,r),n=Math.round(cr*o*(Math.random()-.5)*2);return Math.min(ar,o+n)}function ur(r){return Number.isFinite(r)?r+fr(r):""+r}function fr(r){var t=(r=Math.abs(r))%100;if(t>=10&&t<=20)return"th";var e=r%10;return 1===e?"st":2===e?"nd":3===e?"rd":"th"}exports.RANDOM_FACTOR=cr;
},{"tslib":"vCxL"}],"sLOu":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Provider=exports.ComponentContainer=exports.Component=void 0;var t=require("tslib"),e=require("@firebase/util"),n=function(){function t(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}return t.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},t.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},t.prototype.setServiceProps=function(t){return this.serviceProps=t,this},t}();exports.Component=n;var r="[DEFAULT]",i=function(){function n(t,e){this.name=t,this.container=e,this.component=null,this.instances=new Map,this.instancesDeferred=new Map}return n.prototype.get=function(t){void 0===t&&(t=r);var n=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(n)){var i=new e.Deferred;this.instancesDeferred.set(n,i);try{var o=this.getOrInitializeService(n);o&&i.resolve(o)}catch(s){}}return this.instancesDeferred.get(n).promise},n.prototype.getImmediate=function(e){var n=(0,t.__assign)({identifier:r,optional:!1},e),i=n.identifier,o=n.optional,s=this.normalizeInstanceIdentifier(i);try{var a=this.getOrInitializeService(s);if(!a){if(o)return null;throw Error("Service "+this.name+" is not available")}return a}catch(c){if(o)return null;throw c}},n.prototype.getComponent=function(){return this.component},n.prototype.setComponent=function(e){var n,i;if(e.name!==this.name)throw Error("Mismatching Component "+e.name+" for Provider "+this.name+".");if(this.component)throw Error("Component for "+this.name+" has already been provided");if(this.component=e,s(e))try{this.getOrInitializeService(r)}catch(l){}try{for(var o=(0,t.__values)(this.instancesDeferred.entries()),a=o.next();!a.done;a=o.next()){var c=(0,t.__read)(a.value,2),p=c[0],h=c[1],u=this.normalizeInstanceIdentifier(p);try{var f=this.getOrInitializeService(u);h.resolve(f)}catch(l){}}}catch(d){n={error:d}}finally{try{a&&!a.done&&(i=o.return)&&i.call(o)}finally{if(n)throw n.error}}},n.prototype.clearInstance=function(t){void 0===t&&(t=r),this.instancesDeferred.delete(t),this.instances.delete(t)},n.prototype.delete=function(){return(0,t.__awaiter)(this,void 0,void 0,function(){var e;return(0,t.__generator)(this,function(n){switch(n.label){case 0:return e=Array.from(this.instances.values()),[4,Promise.all((0,t.__spread)(e.filter(function(t){return"INTERNAL"in t}).map(function(t){return t.INTERNAL.delete()}),e.filter(function(t){return"_delete"in t}).map(function(t){return t._delete()})))];case 1:return n.sent(),[2]}})})},n.prototype.isComponentSet=function(){return null!=this.component},n.prototype.getOrInitializeService=function(t){var e=this.instances.get(t);return!e&&this.component&&(e=this.component.instanceFactory(this.container,o(t)),this.instances.set(t,e)),e||null},n.prototype.normalizeInstanceIdentifier=function(t){return this.component?this.component.multipleInstances?t:r:t},n}();function o(t){return t===r?void 0:t}function s(t){return"EAGER"===t.instantiationMode}exports.Provider=i;var a=function(){function t(t){this.name=t,this.providers=new Map}return t.prototype.addComponent=function(t){var e=this.getProvider(t.name);if(e.isComponentSet())throw new Error("Component "+t.name+" has already been registered with "+this.name);e.setComponent(t)},t.prototype.addOrOverwriteComponent=function(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)},t.prototype.getProvider=function(t){if(this.providers.has(t))return this.providers.get(t);var e=new i(t,this);return this.providers.set(t,e),e},t.prototype.getProviders=function(){return Array.from(this.providers.values())},t}();exports.ComponentContainer=a;
},{"tslib":"vCxL","@firebase/util":"KxmD"}],"TUpU":[function(require,module,exports) {
"use strict";function e(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var o=Array(e),n=0;for(t=0;t<r;t++)for(var l=arguments[t],i=0,s=l.length;i<s;i++,n++)o[n]=l[i];return o}var t;Object.defineProperty(exports,"__esModule",{value:!0}),exports.setLogLevel=g,exports.setUserLogHandler=u,exports.Logger=exports.LogLevel=void 0;var r,o=[];exports.LogLevel=r,function(e){e[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT"}(r||(exports.LogLevel=r={}));var n={debug:r.DEBUG,verbose:r.VERBOSE,info:r.INFO,warn:r.WARN,error:r.ERROR,silent:r.SILENT},l=r.INFO,i=((t={})[r.DEBUG]="log",t[r.VERBOSE]="log",t[r.INFO]="info",t[r.WARN]="warn",t[r.ERROR]="error",t),s=function(t,r){for(var o=[],n=2;n<arguments.length;n++)o[n-2]=arguments[n];if(!(r<t.logLevel)){var l=(new Date).toISOString(),s=i[r];if(!s)throw new Error("Attempted to log a message with an invalid logType (value: "+r+")");console[s].apply(console,e(["["+l+"]  "+t.name+":"],o))}},a=function(){function t(e){this.name=e,this._logLevel=l,this._logHandler=s,this._userLogHandler=null,o.push(this)}return Object.defineProperty(t.prototype,"logLevel",{get:function(){return this._logLevel},set:function(e){if(!(e in r))throw new TypeError('Invalid value "'+e+'" assigned to `logLevel`');this._logLevel=e},enumerable:!1,configurable:!0}),t.prototype.setLogLevel=function(e){this._logLevel="string"==typeof e?n[e]:e},Object.defineProperty(t.prototype,"logHandler",{get:function(){return this._logHandler},set:function(e){if("function"!=typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(e){this._userLogHandler=e},enumerable:!1,configurable:!0}),t.prototype.debug=function(){for(var t=[],o=0;o<arguments.length;o++)t[o]=arguments[o];this._userLogHandler&&this._userLogHandler.apply(this,e([this,r.DEBUG],t)),this._logHandler.apply(this,e([this,r.DEBUG],t))},t.prototype.log=function(){for(var t=[],o=0;o<arguments.length;o++)t[o]=arguments[o];this._userLogHandler&&this._userLogHandler.apply(this,e([this,r.VERBOSE],t)),this._logHandler.apply(this,e([this,r.VERBOSE],t))},t.prototype.info=function(){for(var t=[],o=0;o<arguments.length;o++)t[o]=arguments[o];this._userLogHandler&&this._userLogHandler.apply(this,e([this,r.INFO],t)),this._logHandler.apply(this,e([this,r.INFO],t))},t.prototype.warn=function(){for(var t=[],o=0;o<arguments.length;o++)t[o]=arguments[o];this._userLogHandler&&this._userLogHandler.apply(this,e([this,r.WARN],t)),this._logHandler.apply(this,e([this,r.WARN],t))},t.prototype.error=function(){for(var t=[],o=0;o<arguments.length;o++)t[o]=arguments[o];this._userLogHandler&&this._userLogHandler.apply(this,e([this,r.ERROR],t)),this._logHandler.apply(this,e([this,r.ERROR],t))},t}();function g(e){o.forEach(function(t){t.setLogLevel(e)})}function u(e,t){for(var l=function(o){var l=null;t&&t.level&&(l=n[t.level]),o.userLogHandler=null===e?null:function(t,o){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];var s=n.map(function(e){if(null==e)return null;if("string"==typeof e)return e;if("number"==typeof e||"boolean"==typeof e)return e.toString();if(e instanceof Error)return e.message;try{return JSON.stringify(e)}catch(t){return null}}).filter(function(e){return e}).join(" ");o>=(null!=l?l:t.logLevel)&&e({level:r[o].toLowerCase(),message:s,args:n,type:t.name})}},i=0,s=o;i<s.length;i++){l(s[i])}}exports.Logger=a;
},{}],"VxYX":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.firebase=exports.default=void 0;var e,n,t=require("tslib"),r=require("@firebase/util"),i=require("@firebase/component"),a=require("@firebase/logger"),o=((e={})["no-app"]="No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()",e["bad-app-name"]="Illegal App name: '{$appName}",e["duplicate-app"]="Firebase App named '{$appName}' already exists",e["app-deleted"]="Firebase App named '{$appName}' already deleted",e["invalid-app-argument"]="firebase.{$appName}() takes either no argument or a Firebase App instance.",e["invalid-log-argument"]="First argument to `onLog` must be null or a function.",e),s=new r.ErrorFactory("app","Firebase",o),p="@firebase/app",l="0.6.14",c="@firebase/analytics",u="@firebase/auth",f="@firebase/database",d="@firebase/functions",m="@firebase/installations",b="@firebase/messaging",h="@firebase/performance",g="@firebase/remote-config",v="@firebase/storage",y="@firebase/firestore",_="firebase-wrapper",w="[DEFAULT]",N=((n={})[p]="fire-core",n[c]="fire-analytics",n[u]="fire-auth",n[f]="fire-rtdb",n[d]="fire-fn",n[m]="fire-iid",n[b]="fire-fcm",n[h]="fire-perf",n[g]="fire-rc",n[v]="fire-gcs",n[y]="fire-fst",n["fire-js"]="fire-js",n[_]="fire-js-all",n),C=new a.Logger("@firebase/app"),E=function(){function e(e,n,a){var o,s,p=this;this.firebase_=a,this.isDeleted_=!1,this.name_=n.name,this.automaticDataCollectionEnabled_=n.automaticDataCollectionEnabled||!1,this.options_=(0,r.deepCopy)(e),this.container=new i.ComponentContainer(n.name),this._addComponent(new i.Component("app",function(){return p},"PUBLIC"));try{for(var l=(0,t.__values)(this.firebase_.INTERNAL.components.values()),c=l.next();!c.done;c=l.next()){var u=c.value;this._addComponent(u)}}catch(f){o={error:f}}finally{try{c&&!c.done&&(s=l.return)&&s.call(l)}finally{if(o)throw o.error}}}return Object.defineProperty(e.prototype,"automaticDataCollectionEnabled",{get:function(){return this.checkDestroyed_(),this.automaticDataCollectionEnabled_},set:function(e){this.checkDestroyed_(),this.automaticDataCollectionEnabled_=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"name",{get:function(){return this.checkDestroyed_(),this.name_},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"options",{get:function(){return this.checkDestroyed_(),this.options_},enumerable:!1,configurable:!0}),e.prototype.delete=function(){var e=this;return new Promise(function(n){e.checkDestroyed_(),n()}).then(function(){return e.firebase_.INTERNAL.removeApp(e.name_),Promise.all(e.container.getProviders().map(function(e){return e.delete()}))}).then(function(){e.isDeleted_=!0})},e.prototype._getService=function(e,n){return void 0===n&&(n=w),this.checkDestroyed_(),this.container.getProvider(e).getImmediate({identifier:n})},e.prototype._removeServiceInstance=function(e,n){void 0===n&&(n=w),this.container.getProvider(e).clearInstance(n)},e.prototype._addComponent=function(e){try{this.container.addComponent(e)}catch(n){C.debug("Component "+e.name+" failed to register with FirebaseApp "+this.name,n)}},e.prototype._addOrOverwriteComponent=function(e){this.container.addOrOverwriteComponent(e)},e.prototype.toJSON=function(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}},e.prototype.checkDestroyed_=function(){if(this.isDeleted_)throw s.create("app-deleted",{appName:this.name_})},e}();E.prototype.name&&E.prototype.options||E.prototype.delete||console.log("dc");var I="8.2.5";function A(e){var n={},o=new Map,p={__esModule:!0,initializeApp:function(t,i){void 0===i&&(i={});if("object"!=typeof i||null===i){var a=i;i={name:a}}var o=i;void 0===o.name&&(o.name=w);var l=o.name;if("string"!=typeof l||!l)throw s.create("bad-app-name",{appName:String(l)});if((0,r.contains)(n,l))throw s.create("duplicate-app",{appName:l});var c=new e(t,o,p);return n[l]=c,c},app:l,registerVersion:function(e,n,t){var r,a=null!==(r=N[e])&&void 0!==r?r:e;t&&(a+="-"+t);var o=a.match(/\s|\//),s=n.match(/\s|\//);if(o||s){var p=['Unable to register library "'+a+'" with version "'+n+'":'];return o&&p.push('library name "'+a+'" contains illegal characters (whitespace or "/")'),o&&s&&p.push("and"),s&&p.push('version name "'+n+'" contains illegal characters (whitespace or "/")'),void C.warn(p.join(" "))}c(new i.Component(a+"-version",function(){return{library:a,version:n}},"VERSION"))},setLogLevel:a.setLogLevel,onLog:function(e,n){if(null!==e&&"function"!=typeof e)throw s.create("invalid-log-argument",{appName:name});(0,a.setUserLogHandler)(e,n)},apps:null,SDK_VERSION:I,INTERNAL:{registerComponent:c,removeApp:function(e){delete n[e]},components:o,useAsService:function(e,n){if("serverAuth"===n)return null;return n}}};function l(e){if(e=e||w,!(0,r.contains)(n,e))throw s.create("no-app",{appName:e});return n[e]}function c(i){var a,c,u=i.name;if(o.has(u))return C.debug("There were multiple attempts to register component "+u+"."),"PUBLIC"===i.type?p[u]:null;if(o.set(u,i),"PUBLIC"===i.type){var f=function(e){if(void 0===e&&(e=l()),"function"!=typeof e[u])throw s.create("invalid-app-argument",{appName:u});return e[u]()};void 0!==i.serviceProps&&(0,r.deepExtend)(f,i.serviceProps),p[u]=f,e.prototype[u]=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return this._getService.bind(this,u).apply(this,i.multipleInstances?e:[])}}try{for(var d=(0,t.__values)(Object.keys(n)),m=d.next();!m.done;m=d.next()){var b=m.value;n[b]._addComponent(i)}}catch(h){a={error:h}}finally{try{m&&!m.done&&(c=d.return)&&c.call(d)}finally{if(a)throw a.error}}return"PUBLIC"===i.type?p[u]:null}return p.default=p,Object.defineProperty(p,"apps",{get:function(){return Object.keys(n).map(function(e){return n[e]})}}),l.App=e,p}function F(){var e=A(E);return e.INTERNAL=(0,t.__assign)((0,t.__assign)({},e.INTERNAL),{createFirebaseNamespace:F,extendNamespace:function(n){(0,r.deepExtend)(e,n)},createSubscribe:r.createSubscribe,ErrorFactory:r.ErrorFactory,deepExtend:r.deepExtend}),e}var P=F(),D=function(){function e(e){this.container=e}return e.prototype.getPlatformInfoString=function(){return this.container.getProviders().map(function(e){if(L(e)){var n=e.getImmediate();return n.library+"/"+n.version}return null}).filter(function(e){return e}).join(" ")},e}();function L(e){var n=e.getComponent();return"VERSION"===(null==n?void 0:n.type)}function O(e,n){e.INTERNAL.registerComponent(new i.Component("platform-logger",function(e){return new D(e)},"PRIVATE")),e.registerVersion(p,l,n),e.registerVersion("fire-js","")}if((0,r.isBrowser)()&&void 0!==self.firebase){C.warn("\n    Warning: Firebase is already defined in the global scope. Please make sure\n    Firebase library is only loaded once.\n  ");var j=self.firebase.SDK_VERSION;j&&j.indexOf("LITE")>=0&&C.warn("\n    Warning: You are trying to load Firebase while using Firebase Performance standalone script.\n    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.\n    ")}var x=P.initializeApp;P.initializeApp=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return(0,r.isNode)()&&C.warn('\n      Warning: This is a browser-targeted Firebase bundle but it appears it is being\n      run in a Node environment.  If running in a Node environment, make sure you\n      are using the bundle specified by the "main" field in package.json.\n      \n      If you are using Webpack, you can specify "main" as the first item in\n      "resolve.mainFields":\n      https://webpack.js.org/configuration/resolve/#resolvemainfields\n      \n      If using Rollup, use the @rollup/plugin-node-resolve plugin and specify "main"\n      as the first item in "mainFields", e.g. [\'main\', \'module\'].\n      https://github.com/rollup/@rollup/plugin-node-resolve\n      '),x.apply(void 0,e)};var k=P;exports.firebase=k,O(k);var S=k;exports.default=S;
},{"tslib":"vCxL","@firebase/util":"KxmD","@firebase/component":"sLOu","@firebase/logger":"TUpU"}],"OJEJ":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),Object.defineProperty(exports,"default",{enumerable:!0,get:function(){return e.default}});var e=r(require("@firebase/app"));function r(e){return e&&e.__esModule?e:{default:e}}var t="firebase",u="8.2.5";e.default.registerVersion(t,u,"app");
},{"@firebase/app":"VxYX"}],"ueHA":[function(require,module,exports) {
var global = arguments[3];
var t=arguments[3];Object.defineProperty(exports,"__esModule",{value:!0}),exports.getStatEventTarget=exports.createWebChannelTransport=exports.XhrIo=exports.WebChannel=exports.Stat=exports.EventType=exports.Event=exports.ErrorCode=exports.default=void 0;var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])})(t,e)};function e(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}function i(t){var n="function"==typeof Symbol&&Symbol.iterator,e=n&&t[n],i=0;if(e)return e.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(n?"Object is not iterable.":"Symbol.iterator is not defined.")}var r,a="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==t?t:"undefined"!=typeof self?self:{},o=o||{},s=a||self;function h(){}function l(t){var n=typeof t;return"array"==(n="object"!=n?n:t?Array.isArray(t)?"array":n:"null")||"object"==n&&"number"==typeof t.length}function u(t){var n=typeof t;return"object"==n&&null!=t||"function"==n}function c(t){return Object.prototype.hasOwnProperty.call(t,f)&&t[f]||(t[f]=++p)}var f="closure_uid_"+(1e9*Math.random()>>>0),p=0;function v(t,n,e){return t.call.apply(t.bind,arguments)}function g(t,n,e){if(!t)throw Error();if(2<arguments.length){var i=Array.prototype.slice.call(arguments,2);return function(){var e=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(e,i),t.apply(n,e)}}return function(){return t.apply(n,arguments)}}function y(t,n,e){return(y=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?v:g).apply(null,arguments)}function d(t,n){var e=Array.prototype.slice.call(arguments,1);return function(){var n=e.slice();return n.push.apply(n,arguments),t.apply(this,n)}}function b(){return Date.now()}function m(t,n){function e(){}e.prototype=n.prototype,t.X=n.prototype,t.prototype=new e,t.prototype.constructor=t,t.Kb=function(t,e,i){for(var r=Array(arguments.length-2),a=2;a<arguments.length;a++)r[a-2]=arguments[a];return n.prototype[e].apply(t,r)}}function w(){this.j=this.j,this.i=this.i}var T=0;w.prototype.j=!1,w.prototype.ja=function(){if(!this.j&&(this.j=!0,this.G(),0!=T))c(this)},w.prototype.G=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var E=Array.prototype.indexOf?function(t,n){return Array.prototype.indexOf.call(t,n,void 0)}:function(t,n){if("string"==typeof t)return"string"!=typeof n||1!=n.length?-1:t.indexOf(n,0);for(var e=0;e<t.length;e++)if(e in t&&t[e]===n)return e;return-1},S=Array.prototype.forEach?function(t,n,e){Array.prototype.forEach.call(t,n,e)}:function(t,n,e){for(var i=t.length,r="string"==typeof t?t.split(""):t,a=0;a<i;a++)a in r&&n.call(e,r[a],a,t)};function C(t){t:{for(var n=De,e=t.length,i="string"==typeof t?t.split(""):t,r=0;r<e;r++)if(r in i&&n.call(void 0,i[r],r,t)){n=r;break t}n=-1}return 0>n?null:"string"==typeof t?t.charAt(n):t[n]}function x(t){return Array.prototype.concat.apply([],arguments)}function I(t){var n=t.length;if(0<n){for(var e=Array(n),i=0;i<n;i++)e[i]=t[i];return e}return[]}function O(t){return/^[\s\xa0]*$/.test(t)}var P,A=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function R(t,n){return-1!=t.indexOf(n)}function j(t,n){return t<n?-1:t>n?1:0}t:{var M=s.navigator;if(M){var L=M.userAgent;if(L){P=L;break t}}P=""}function _(t,n,e){for(var i in t)n.call(e,t[i],i,t)}function X(t){var n={};for(var e in t)n[e]=t[e];return n}var k="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function D(t,n){for(var e,i,r=1;r<arguments.length;r++){for(e in i=arguments[r])t[e]=i[e];for(var a=0;a<k.length;a++)e=k[a],Object.prototype.hasOwnProperty.call(i,e)&&(t[e]=i[e])}}function H(t){return H[" "](t),t}function N(t,n){var e=Z;return Object.prototype.hasOwnProperty.call(e,t)?e[t]:e[t]=n(t)}H[" "]=h;var U,B=R(P,"Opera"),F=R(P,"Trident")||R(P,"MSIE"),K=R(P,"Edge"),Y=K||F,W=R(P,"Gecko")&&!(R(P.toLowerCase(),"webkit")&&!R(P,"Edge"))&&!(R(P,"Trident")||R(P,"MSIE"))&&!R(P,"Edge"),G=R(P.toLowerCase(),"webkit")&&!R(P,"Edge");function J(){var t=s.document;return t?t.documentMode:void 0}t:{var V="",q=function(){var t=P;return W?/rv:([^\);]+)(\)|;)/.exec(t):K?/Edge\/([\d\.]+)/.exec(t):F?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(t):G?/WebKit\/(\S+)/.exec(t):B?/(?:Version)[ \/]?(\S+)/.exec(t):void 0}();if(q&&(V=q?q[1]:""),F){var $=J();if(null!=$&&$>parseFloat(V)){U=String($);break t}}U=V}var z,Z={};function Q(t){return N(t,function(){for(var n=0,e=A(String(U)).split("."),i=A(String(t)).split("."),r=Math.max(e.length,i.length),a=0;0==n&&a<r;a++){var o=e[a]||"",s=i[a]||"";do{if(o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==o[0].length&&0==s[0].length)break;n=j(0==o[1].length?0:parseInt(o[1],10),0==s[1].length?0:parseInt(s[1],10))||j(0==o[2].length,0==s[2].length)||j(o[2],s[2]),o=o[3],s=s[3]}while(0==n)}return 0<=n})}if(s.document&&F){var tt=J();z=tt||(parseInt(U,10)||void 0)}else z=void 0;var nt=z,et=!F||9<=Number(nt),it=F&&!Q("9"),rt=function(){if(!s.addEventListener||!Object.defineProperty)return!1;var t=!1,n=Object.defineProperty({},"passive",{get:function(){t=!0}});try{s.addEventListener("test",h,n),s.removeEventListener("test",h,n)}catch(e){}return t}();function at(t,n){this.type=t,this.a=this.target=n,this.defaultPrevented=!1}function ot(t,n){if(at.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var e=this.type=t.type,i=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=n,n=t.relatedTarget){if(W){t:{try{H(n.nodeName);var r=!0;break t}catch(a){}r=!1}r||(n=null)}}else"mouseover"==e?n=t.fromElement:"mouseout"==e&&(n=t.toElement);this.relatedTarget=n,i?(this.clientX=void 0!==i.clientX?i.clientX:i.pageX,this.clientY=void 0!==i.clientY?i.clientY:i.pageY,this.screenX=i.screenX||0,this.screenY=i.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:st[t.pointerType]||"",this.c=t,t.defaultPrevented&&this.b()}}at.prototype.b=function(){this.defaultPrevented=!0},m(ot,at);var st={2:"touch",3:"pen",4:"mouse"};ot.prototype.b=function(){ot.X.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,it)try{(t.ctrlKey||112<=t.keyCode&&123>=t.keyCode)&&(t.keyCode=-1)}catch(n){}};var ht="closure_listenable_"+(1e6*Math.random()|0),lt=0;function ut(t,n,e,i,r){this.listener=t,this.proxy=null,this.src=n,this.type=e,this.capture=!!i,this.ca=r,this.key=++lt,this.Y=this.Z=!1}function ct(t){t.Y=!0,t.listener=null,t.proxy=null,t.src=null,t.ca=null}function ft(t){this.src=t,this.a={},this.b=0}function pt(t,n){var e=n.type;if(e in t.a){var i,r=t.a[e],a=E(r,n);(i=0<=a)&&Array.prototype.splice.call(r,a,1),i&&(ct(n),0==t.a[e].length&&(delete t.a[e],t.b--))}}function vt(t,n,e,i){for(var r=0;r<t.length;++r){var a=t[r];if(!a.Y&&a.listener==n&&a.capture==!!e&&a.ca==i)return r}return-1}ft.prototype.add=function(t,n,e,i,r){var a=t.toString();(t=this.a[a])||(t=this.a[a]=[],this.b++);var o=vt(t,n,i,r);return-1<o?(n=t[o],e||(n.Z=!1)):((n=new ut(n,this.src,a,!!i,r)).Z=e,t.push(n)),n};var gt="closure_lm_"+(1e6*Math.random()|0),yt={};function dt(t,n,e,i,r){if(i&&i.once)return wt(t,n,e,i,r);if(Array.isArray(n)){for(var a=0;a<n.length;a++)dt(t,n[a],e,i,r);return null}return e=Pt(e),t&&t[ht]?t.va(n,e,u(i)?!!i.capture:!!i,r):bt(t,n,e,!1,i,r)}function bt(t,n,e,i,r,a){if(!n)throw Error("Invalid event type");var o=u(r)?!!r.capture:!!r;if(o&&!et)return null;var s=It(t);if(s||(t[gt]=s=new ft(t)),(e=s.add(n,e,i,o,a)).proxy)return e;if(i=mt(),e.proxy=i,i.src=t,i.listener=e,t.addEventListener)rt||(r=o),void 0===r&&(r=!1),t.addEventListener(n.toString(),i,r);else if(t.attachEvent)t.attachEvent(St(n.toString()),i);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(i)}return e}function mt(){var t=xt,n=et?function(e){return t.call(n.src,n.listener,e)}:function(e){if(!(e=t.call(n.src,n.listener,e)))return e};return n}function wt(t,n,e,i,r){if(Array.isArray(n)){for(var a=0;a<n.length;a++)wt(t,n[a],e,i,r);return null}return e=Pt(e),t&&t[ht]?t.wa(n,e,u(i)?!!i.capture:!!i,r):bt(t,n,e,!0,i,r)}function Tt(t,n,e,i,r){if(Array.isArray(n))for(var a=0;a<n.length;a++)Tt(t,n[a],e,i,r);else i=u(i)?!!i.capture:!!i,e=Pt(e),t&&t[ht]?(t=t.c,(n=String(n).toString())in t.a&&(-1<(e=vt(a=t.a[n],e,i,r))&&(ct(a[e]),Array.prototype.splice.call(a,e,1),0==a.length&&(delete t.a[n],t.b--)))):t&&(t=It(t))&&(n=t.a[n.toString()],t=-1,n&&(t=vt(n,e,i,r)),(e=-1<t?n[t]:null)&&Et(e))}function Et(t){if("number"!=typeof t&&t&&!t.Y){var n=t.src;if(n&&n[ht])pt(n.c,t);else{var e=t.type,i=t.proxy;n.removeEventListener?n.removeEventListener(e,i,t.capture):n.detachEvent?n.detachEvent(St(e),i):n.addListener&&n.removeListener&&n.removeListener(i),(e=It(n))?(pt(e,t),0==e.b&&(e.src=null,n[gt]=null)):ct(t)}}}function St(t){return t in yt?yt[t]:yt[t]="on"+t}function Ct(t,n){var e=t.listener,i=t.ca||t.src;return t.Z&&Et(t),e.call(i,n)}function xt(t,n){if(t.Y)return!0;if(!et){if(!n)t:{n=["window","event"];for(var e=s,i=0;i<n.length;i++)if(null==(e=e[n[i]])){n=null;break t}n=e}return Ct(t,n=new ot(n,this))}return Ct(t,new ot(n,this))}function It(t){return(t=t[gt])instanceof ft?t:null}var Ot="__closure_events_fn_"+(1e9*Math.random()>>>0);function Pt(t){return"function"==typeof t?t:(t[Ot]||(t[Ot]=function(n){return t.handleEvent(n)}),t[Ot])}function At(){w.call(this),this.c=new ft(this),this.J=this,this.C=null}function Rt(t,n){var e,i=t.C;if(i)for(e=[];i;i=i.C)e.push(i);if(t=t.J,i=n.type||n,"string"==typeof n)n=new at(n,t);else if(n instanceof at)n.target=n.target||t;else{var r=n;D(n=new at(i,t),r)}if(r=!0,e)for(var a=e.length-1;0<=a;a--){var o=n.a=e[a];r=jt(o,i,!0,n)&&r}if(r=jt(o=n.a=t,i,!0,n)&&r,r=jt(o,i,!1,n)&&r,e)for(a=0;a<e.length;a++)r=jt(o=n.a=e[a],i,!1,n)&&r}function jt(t,n,e,i){if(!(n=t.c.a[String(n)]))return!0;n=n.concat();for(var r=!0,a=0;a<n.length;++a){var o=n[a];if(o&&!o.Y&&o.capture==e){var s=o.listener,h=o.ca||o.src;o.Z&&pt(t.c,o),r=!1!==s.call(h,i)&&r}}return r&&!i.defaultPrevented}m(At,w),At.prototype[ht]=!0,(r=At.prototype).addEventListener=function(t,n,e,i){dt(this,t,n,e,i)},r.removeEventListener=function(t,n,e,i){Tt(this,t,n,e,i)},r.G=function(){if(At.X.G.call(this),this.c){var t,n=this.c;for(t in n.a){for(var e=n.a[t],i=0;i<e.length;i++)ct(e[i]);delete n.a[t],n.b--}}this.C=null},r.va=function(t,n,e,i){return this.c.add(String(t),n,!1,e,i)},r.wa=function(t,n,e,i){return this.c.add(String(t),n,!0,e,i)};var Mt=s.JSON.stringify;function Lt(){this.b=this.a=null}var _t,Xt=new(function(){function t(t,n){this.c=t,this.f=n,this.b=0,this.a=null}return t.prototype.get=function(){var t;return 0<this.b?(this.b--,t=this.a,this.a=t.next,t.next=null):t=this.c(),t},t}())(function(){return new Dt},function(t){t.reset()});function kt(){var t=Ft,n=null;return t.a&&(n=t.a,t.a=t.a.next,t.a||(t.b=null),n.next=null),n}function Dt(){this.next=this.b=this.a=null}function Ht(t){s.setTimeout(function(){throw t},0)}function Nt(t,n){_t||Ut(),Bt||(_t(),Bt=!0),Ft.add(t,n)}function Ut(){var t=s.Promise.resolve(void 0);_t=function(){t.then(Kt)}}Lt.prototype.add=function(t,n){var e=Xt.get();e.set(t,n),this.b?this.b.next=e:this.a=e,this.b=e},Dt.prototype.set=function(t,n){this.a=t,this.b=n,this.next=null},Dt.prototype.reset=function(){this.next=this.b=this.a=null};var Bt=!1,Ft=new Lt;function Kt(){for(var t;t=kt();){try{t.a.call(t.b)}catch(e){Ht(e)}var n=Xt;n.f(t),100>n.b&&(n.b++,t.next=n.a,n.a=t)}Bt=!1}function Yt(t,n){At.call(this),this.b=t||1,this.a=n||s,this.f=y(this.Za,this),this.g=b()}function Wt(t){t.aa=!1,t.M&&(t.a.clearTimeout(t.M),t.M=null)}function Gt(t,n,e){if("function"==typeof t)e&&(t=y(t,e));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=y(t.handleEvent,t)}return 2147483647<Number(n)?-1:s.setTimeout(t,n||0)}function Jt(t){t.a=Gt(function(){t.a=null,t.c&&(t.c=!1,Jt(t))},t.h);var n=t.b;t.b=null,t.g.apply(null,n)}m(Yt,At),(r=Yt.prototype).aa=!1,r.M=null,r.Za=function(){if(this.aa){var t=b()-this.g;0<t&&t<.8*this.b?this.M=this.a.setTimeout(this.f,this.b-t):(this.M&&(this.a.clearTimeout(this.M),this.M=null),Rt(this,"tick"),this.aa&&(Wt(this),this.start()))}},r.start=function(){this.aa=!0,this.M||(this.M=this.a.setTimeout(this.f,this.b),this.g=b())},r.G=function(){Yt.X.G.call(this),Wt(this),delete this.a};var Vt=function(t){function n(n,e){var i=t.call(this)||this;return i.g=n,i.h=e,i.b=null,i.c=!1,i.a=null,i}return e(n,t),n.prototype.f=function(t){this.b=arguments,this.a?this.c=!0:Jt(this)},n.prototype.G=function(){t.prototype.G.call(this),this.a&&(s.clearTimeout(this.a),this.a=null,this.c=!1,this.b=null)},n}(w);function qt(t){w.call(this),this.b=t,this.a={}}m(qt,w);var $t=[];function zt(t,n,e,i){Array.isArray(e)||(e&&($t[0]=e.toString()),e=$t);for(var r=0;r<e.length;r++){var a=dt(n,e[r],i||t.handleEvent,!1,t.b||t);if(!a)break;t.a[a.key]=a}}function Zt(t){_(t.a,function(t,n){this.a.hasOwnProperty(n)&&Et(t)},t),t.a={}}function Qt(){this.a=!0}function tn(t,n,e,i,r,a){t.info(function(){if(t.a)if(a)for(var o="",s=a.split("&"),h=0;h<s.length;h++){var l=s[h].split("=");if(1<l.length){var u=l[0];l=l[1];var c=u.split("_");o=2<=c.length&&"type"==c[1]?o+(u+"=")+l+"&":o+(u+"=redacted&")}}else o=null;else o=a;return"XMLHTTP REQ ("+i+") [attempt "+r+"]: "+n+"\n"+e+"\n"+o})}function nn(t,n,e,i,r,a,o){t.info(function(){return"XMLHTTP RESP ("+i+") [ attempt "+r+"]: "+n+"\n"+e+"\n"+a+" "+o})}function en(t,n,e,i){t.info(function(){return"XMLHTTP TEXT ("+n+"): "+an(t,e)+(i?" "+i:"")})}function rn(t,n){t.info(function(){return"TIMEOUT: "+n})}function an(t,n){if(!t.a)return n;if(!n)return null;try{var e=JSON.parse(n);if(e)for(t=0;t<e.length;t++)if(Array.isArray(e[t])){var i=e[t];if(!(2>i.length)){var r=i[1];if(Array.isArray(r)&&!(1>r.length)){var a=r[0];if("noop"!=a&&"stop"!=a&&"close"!=a)for(var o=1;o<r.length;o++)r[o]=""}}}return Mt(e)}catch(s){return n}}qt.prototype.G=function(){qt.X.G.call(this),Zt(this)},qt.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},Qt.prototype.info=function(){};var on={},sn=null;function hn(){return sn=sn||new At}function ln(t){at.call(this,on.Fa,t)}function un(t){var n=hn();Rt(n,new ln(n,t))}function cn(t,n){at.call(this,on.STAT_EVENT,t),this.stat=n}function fn(t){var n=hn();Rt(n,new cn(n,t))}function pn(t){at.call(this,on.Ga,t)}function vn(t,n){if("function"!=typeof t)throw Error("Fn must not be null and must be a function");return s.setTimeout(function(){t()},n)}on.Fa="serverreachability",m(ln,at),on.STAT_EVENT="statevent",m(cn,at),on.Ga="timingevent",m(pn,at);var gn={NO_ERROR:0,$a:1,nb:2,mb:3,hb:4,lb:5,ob:6,Da:7,TIMEOUT:8,rb:9},yn={fb:"complete",Bb:"success",Ea:"error",Da:"abort",tb:"ready",ub:"readystatechange",TIMEOUT:"timeout",pb:"incrementaldata",sb:"progress",ib:"downloadprogress",Jb:"uploadprogress"};function dn(){}function bn(t){var n;return(n=t.a)||(n=t.a={}),n}function mn(){}dn.prototype.a=null;var wn,Tn={OPEN:"a",eb:"b",Ea:"c",qb:"d"};function En(){at.call(this,"d")}function Sn(){at.call(this,"c")}function Cn(){}function xn(t,n,e,i){this.g=t,this.c=n,this.f=e,this.S=i||1,this.J=new qt(this),this.P=In,t=Y?125:void 0,this.R=new Yt(t),this.B=null,this.b=!1,this.j=this.l=this.i=this.H=this.u=this.T=this.o=null,this.s=[],this.a=null,this.D=0,this.h=this.m=null,this.N=-1,this.A=!1,this.O=0,this.F=null,this.V=this.C=this.U=this.I=!1}m(En,at),m(Sn,at),m(Cn,dn),wn=new Cn;var In=45e3,On={},Pn={};function An(t,n,e){t.H=1,t.i=Qn(Jn(n)),t.j=e,t.I=!0,Rn(t,null)}function Rn(t,n){t.u=b(),Ln(t),t.l=Jn(t.i);var e=t.l,i=t.S;Array.isArray(i)||(i=[String(i)]),ve(e.b,"t",i),t.D=0,t.a=pi(t.g,t.g.C?n:null),0<t.O&&(t.F=new Vt(y(t.Ca,t,t.a),t.O)),zt(t.J,t.a,"readystatechange",t.Xa),n=t.B?X(t.B):{},t.j?(t.m||(t.m="POST"),n["Content-Type"]="application/x-www-form-urlencoded",t.a.ba(t.l,t.m,t.j,n)):(t.m="GET",t.a.ba(t.l,t.m,null,n)),un(1),tn(t.c,t.m,t.l,t.f,t.S,t.j)}function jn(t,n,e){for(var i=!0;!t.A&&t.D<e.length;){var r=Mn(t,e);if(r==Pn){4==n&&(t.h=4,fn(14),i=!1),en(t.c,t.f,null,"[Incomplete Response]");break}if(r==On){t.h=4,fn(15),en(t.c,t.f,e,"[Invalid Chunk]"),i=!1;break}en(t.c,t.f,r,null),Hn(t,r)}4==n&&0==e.length&&(t.h=1,fn(16),i=!1),t.b=t.b&&i,i?0<e.length&&!t.V&&(t.V=!0,(n=t.g).a==t&&n.U&&!n.F&&(n.c.info("Great, no buffering proxy detected. Bytes received: "+e.length),ai(n),n.F=!0,fn(11))):(en(t.c,t.f,e,"[Invalid Chunked Response]"),Dn(t),kn(t))}function Mn(t,n){var e=t.D,i=n.indexOf("\n",e);return-1==i?Pn:(e=Number(n.substring(e,i)),isNaN(e)?On:(i+=1)+e>n.length?Pn:(n=n.substr(i,e),t.D=i+e,n))}function Ln(t){t.T=b()+t.P,_n(t,t.P)}function _n(t,n){if(null!=t.o)throw Error("WatchDog timer not null");t.o=vn(y(t.Va,t),n)}function Xn(t){t.o&&(s.clearTimeout(t.o),t.o=null)}function kn(t){0==t.g.v||t.A||hi(t.g,t)}function Dn(t){Xn(t);var n=t.F;n&&"function"==typeof n.ja&&n.ja(),t.F=null,Wt(t.R),Zt(t.J),t.a&&(n=t.a,t.a=null,n.abort(),n.ja())}function Hn(t,n){try{var e=t.g;if(0!=e.v&&(e.a==t||Ee(e.b,t)))if(e.I=t.N,!t.C&&Ee(e.b,t)&&3==e.v){try{var i=e.ka.a.parse(n)}catch(d){i=null}if(Array.isArray(i)&&3==i.length){var r=i;if(0==r[0]){t:if(!e.j){if(e.a){if(!(e.a.u+3e3<t.u))break t;si(e),qe(e)}ri(e),fn(18)}}else e.oa=r[1],0<e.oa-e.P&&37500>r[2]&&e.H&&0==e.o&&!e.m&&(e.m=vn(y(e.Sa,e),6e3));if(1>=Te(e.b)&&e.ea){try{e.ea()}catch(d){}e.ea=void 0}}else ui(e,11)}else if((t.C||e.a==t)&&si(e),!O(n))for(n=i=e.ka.a.parse(n),i=0;i<n.length;i++)if(r=n[i],e.P=r[0],r=r[1],2==e.v)if("c"==r[0]){e.J=r[1],e.ga=r[2];var a=r[3];null!=a&&(e.ha=a,e.c.info("VER="+e.ha));var o=r[4];null!=o&&(e.pa=o,e.c.info("SVER="+e.pa));var s=r[5];if(null!=s&&"number"==typeof s&&0<s){var h=1.5*s;e.D=h,e.c.info("backChannelRequestTimeoutMs_="+h)}h=e;var l=t.a;if(l){var u=l.a?l.a.getResponseHeader("X-Client-Wire-Protocol"):null;if(u){var c=h.b;!c.a&&(R(u,"spdy")||R(u,"quic")||R(u,"h2"))&&(c.f=c.g,c.a=new Set,c.b&&(Se(c,c.b),c.b=null))}if(h.A){var f=l.a?l.a.getResponseHeader("X-HTTP-Session-Id"):null;f&&(h.na=f,Zn(h.B,h.A,f))}}e.v=3,e.f&&e.f.ta(),e.U&&(e.N=b()-t.u,e.c.info("Handshake RTT: "+e.N+"ms"));var p=t;if((h=e).la=fi(h,h.C?h.ga:null,h.fa),p.C){Ce(h.b,p);var v=p,g=h.D;g&&v.setTimeout(g),v.o&&(Xn(v),Ln(v)),h.a=p}else ii(h);0<e.g.length&&Ze(e)}else"stop"!=r[0]&&"close"!=r[0]||ui(e,7);else 3==e.v&&("stop"==r[0]||"close"==r[0]?"stop"==r[0]?ui(e,7):Ve(e):"noop"!=r[0]&&e.f&&e.f.sa(r),e.o=0);un(4)}catch(d){}}function Nn(t){if(t.K&&"function"==typeof t.K)return t.K();if("string"==typeof t)return t.split("");if(l(t)){for(var n=[],e=t.length,i=0;i<e;i++)n.push(t[i]);return n}for(i in n=[],e=0,t)n[e++]=t[i];return n}function Un(t,n){if(t.forEach&&"function"==typeof t.forEach)t.forEach(n,void 0);else if(l(t)||"string"==typeof t)S(t,n,void 0);else{if(t.L&&"function"==typeof t.L)var e=t.L();else if(t.K&&"function"==typeof t.K)e=void 0;else if(l(t)||"string"==typeof t){e=[];for(var i=t.length,r=0;r<i;r++)e.push(r)}else for(r in e=[],i=0,t)e[i++]=r;r=(i=Nn(t)).length;for(var a=0;a<r;a++)n.call(void 0,i[a],e&&e[a],t)}}function Bn(t,n){this.b={},this.a=[],this.c=0;var e=arguments.length;if(1<e){if(e%2)throw Error("Uneven number of arguments");for(var i=0;i<e;i+=2)this.set(arguments[i],arguments[i+1])}else if(t)if(t instanceof Bn)for(e=t.L(),i=0;i<e.length;i++)this.set(e[i],t.get(e[i]));else for(i in t)this.set(i,t[i])}function Fn(t){if(t.c!=t.a.length){for(var n=0,e=0;n<t.a.length;){var i=t.a[n];Kn(t.b,i)&&(t.a[e++]=i),n++}t.a.length=e}if(t.c!=t.a.length){var r={};for(e=n=0;n<t.a.length;)Kn(r,i=t.a[n])||(t.a[e++]=i,r[i]=1),n++;t.a.length=e}}function Kn(t,n){return Object.prototype.hasOwnProperty.call(t,n)}(r=xn.prototype).setTimeout=function(t){this.P=t},r.Xa=function(t){t=t.target;var n=this.F;n&&3==Ke(t)?n.f():this.Ca(t)},r.Ca=function(t){try{if(t==this.a)t:{var n=Ke(this.a),e=this.a.ua(),i=this.a.W();if(!(3>n||3==n&&!Y&&!this.a.$())){this.A||4!=n||7==e||un(8==e||0>=i?3:2),Xn(this);var r=this.a.W();this.N=r;var a=this.a.$();if(this.b=200==r,nn(this.c,this.m,this.l,this.f,this.S,n,r),this.b){if(this.U&&!this.C){n:{if(this.a){var o,s=this.a;if((o=s.a?s.a.getResponseHeader("X-HTTP-Initial-Response"):null)&&!O(o)){var h=o;break n}}h=null}if(!h){this.b=!1,this.h=3,fn(12),Dn(this),kn(this);break t}en(this.c,this.f,h,"Initial handshake response via X-HTTP-Initial-Response"),this.C=!0,Hn(this,h)}this.I?(jn(this,n,a),Y&&this.b&&3==n&&(zt(this.J,this.R,"tick",this.Wa),this.R.start())):(en(this.c,this.f,a,null),Hn(this,a)),4==n&&Dn(this),this.b&&!this.A&&(4==n?hi(this.g,this):(this.b=!1,Ln(this)))}else 400==r&&0<a.indexOf("Unknown SID")?(this.h=3,fn(12)):(this.h=0,fn(13)),Dn(this),kn(this)}}}catch(l){}},r.Wa=function(){if(this.a){var t=Ke(this.a),n=this.a.$();this.D<n.length&&(Xn(this),jn(this,t,n),this.b&&4!=t&&Ln(this))}},r.cancel=function(){this.A=!0,Dn(this)},r.Va=function(){this.o=null;var t=b();0<=t-this.T?(rn(this.c,this.l),2!=this.H&&(un(3),fn(17)),Dn(this),this.h=2,kn(this)):_n(this,this.T-t)},(r=Bn.prototype).K=function(){Fn(this);for(var t=[],n=0;n<this.a.length;n++)t.push(this.b[this.a[n]]);return t},r.L=function(){return Fn(this),this.a.concat()},r.get=function(t,n){return Kn(this.b,t)?this.b[t]:n},r.set=function(t,n){Kn(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=n},r.forEach=function(t,n){for(var e=this.L(),i=0;i<e.length;i++){var r=e[i],a=this.get(r);t.call(n,a,r,this)}};var Yn=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Wn(t,n){if(t){t=t.split("&");for(var e=0;e<t.length;e++){var i=t[e].indexOf("="),r=null;if(0<=i){var a=t[e].substring(0,i);r=t[e].substring(i+1)}else a=t[e];n(a,r?decodeURIComponent(r.replace(/\+/g," ")):"")}}}function Gn(t,n){if(this.c=this.j=this.f="",this.h=null,this.i=this.g="",this.a=!1,t instanceof Gn){this.a=void 0!==n?n:t.a,Vn(this,t.f),this.j=t.j,qn(this,t.c),$n(this,t.h),this.g=t.g,n=t.b;var e=new ue;e.c=n.c,n.a&&(e.a=new Bn(n.a),e.b=n.b),zn(this,e),this.i=t.i}else t&&(e=String(t).match(Yn))?(this.a=!!n,Vn(this,e[1]||"",!0),this.j=ee(e[2]||""),qn(this,e[3]||"",!0),$n(this,e[4]),this.g=ee(e[5]||"",!0),zn(this,e[6]||"",!0),this.i=ee(e[7]||"")):(this.a=!!n,this.b=new ue(null,this.a))}function Jn(t){return new Gn(t)}function Vn(t,n,e){t.f=e?ee(n,!0):n,t.f&&(t.f=t.f.replace(/:$/,""))}function qn(t,n,e){t.c=e?ee(n,!0):n}function $n(t,n){if(n){if(n=Number(n),isNaN(n)||0>n)throw Error("Bad port number "+n);t.h=n}else t.h=null}function zn(t,n,e){n instanceof ue?(t.b=n,ye(t.b,t.a)):(e||(n=ie(n,he)),t.b=new ue(n,t.a))}function Zn(t,n,e){t.b.set(n,e)}function Qn(t){return Zn(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^b()).toString(36)),t}function te(t){return t instanceof Gn?Jn(t):new Gn(t,void 0)}function ne(t,n,e,i){var r=new Gn(null,void 0);return t&&Vn(r,t),n&&qn(r,n),e&&$n(r,e),i&&(r.g=i),r}function ee(t,n){return t?n?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function ie(t,n,e){return"string"==typeof t?(t=encodeURI(t).replace(n,re),e&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function re(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}Gn.prototype.toString=function(){var t=[],n=this.f;n&&t.push(ie(n,ae,!0),":");var e=this.c;return(e||"file"==n)&&(t.push("//"),(n=this.j)&&t.push(ie(n,ae,!0),"@"),t.push(encodeURIComponent(String(e)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(e=this.h)&&t.push(":",String(e))),(e=this.g)&&(this.c&&"/"!=e.charAt(0)&&t.push("/"),t.push(ie(e,"/"==e.charAt(0)?se:oe,!0))),(e=this.b.toString())&&t.push("?",e),(e=this.i)&&t.push("#",ie(e,le)),t.join("")};var ae=/[#\/\?@]/g,oe=/[#\?:]/g,se=/[#\?]/g,he=/[#\?@]/g,le=/#/g;function ue(t,n){this.b=this.a=null,this.c=t||null,this.f=!!n}function ce(t){t.a||(t.a=new Bn,t.b=0,t.c&&Wn(t.c,function(n,e){t.add(decodeURIComponent(n.replace(/\+/g," ")),e)}))}function fe(t,n){ce(t),n=ge(t,n),Kn(t.a.b,n)&&(t.c=null,t.b-=t.a.get(n).length,Kn((t=t.a).b,n)&&(delete t.b[n],t.c--,t.a.length>2*t.c&&Fn(t)))}function pe(t,n){return ce(t),n=ge(t,n),Kn(t.a.b,n)}function ve(t,n,e){fe(t,n),0<e.length&&(t.c=null,t.a.set(ge(t,n),I(e)),t.b+=e.length)}function ge(t,n){return n=String(n),t.f&&(n=n.toLowerCase()),n}function ye(t,n){n&&!t.f&&(ce(t),t.c=null,t.a.forEach(function(t,n){var e=n.toLowerCase();n!=e&&(fe(this,n),ve(this,e,t))},t)),t.f=n}(r=ue.prototype).add=function(t,n){ce(this),this.c=null,t=ge(this,t);var e=this.a.get(t);return e||this.a.set(t,e=[]),e.push(n),this.b+=1,this},r.forEach=function(t,n){ce(this),this.a.forEach(function(e,i){S(e,function(e){t.call(n,e,i,this)},this)},this)},r.L=function(){ce(this);for(var t=this.a.K(),n=this.a.L(),e=[],i=0;i<n.length;i++)for(var r=t[i],a=0;a<r.length;a++)e.push(n[i]);return e},r.K=function(t){ce(this);var n=[];if("string"==typeof t)pe(this,t)&&(n=x(n,this.a.get(ge(this,t))));else{t=this.a.K();for(var e=0;e<t.length;e++)n=x(n,t[e])}return n},r.set=function(t,n){return ce(this),this.c=null,pe(this,t=ge(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[n]),this.b+=1,this},r.get=function(t,n){return t&&0<(t=this.K(t)).length?String(t[0]):n},r.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],n=this.a.L(),e=0;e<n.length;e++){var i=n[e],r=encodeURIComponent(String(i));i=this.K(i);for(var a=0;a<i.length;a++){var o=r;""!==i[a]&&(o+="="+encodeURIComponent(String(i[a]))),t.push(o)}}return this.c=t.join("&")};var de=function(){return function(t,n){this.b=t,this.a=n}}();function be(t){this.g=t||me,s.PerformanceNavigationTiming?t=0<(t=s.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):t=!!(s.ia&&s.ia.ya&&s.ia.ya()&&s.ia.ya().Lb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new Set),this.b=null,this.c=[]}var me=10;function we(t){return!!t.b||!!t.a&&t.a.size>=t.f}function Te(t){return t.b?1:t.a?t.a.size:0}function Ee(t,n){return t.b?t.b==n:!!t.a&&t.a.has(n)}function Se(t,n){t.a?t.a.add(n):t.b=n}function Ce(t,n){t.b&&t.b==n?t.b=null:t.a&&t.a.has(n)&&t.a.delete(n)}function xe(t){var n,e;if(null!=t.b)return t.c.concat(t.b.s);if(null!=t.a&&0!==t.a.size){var r=t.c;try{for(var a=i(t.a.values()),o=a.next();!o.done;o=a.next()){var s=o.value;r=r.concat(s.s)}}catch(h){n={error:h}}finally{try{o&&!o.done&&(e=a.return)&&e.call(a)}finally{if(n)throw n.error}}return r}return I(t.c)}function Ie(){}function Oe(){this.a=new Ie}function Pe(t,n,e){var i=e||"";try{Un(t,function(t,e){var r=t;u(t)&&(r=Mt(t)),n.push(i+e+"="+encodeURIComponent(r))})}catch(r){throw n.push(i+"type="+encodeURIComponent("_badmap")),r}}function Ae(t,n){var e=new Qt;if(s.Image){var i=new Image;i.onload=d(Re,e,i,"TestLoadImage: loaded",!0,n),i.onerror=d(Re,e,i,"TestLoadImage: error",!1,n),i.onabort=d(Re,e,i,"TestLoadImage: abort",!1,n),i.ontimeout=d(Re,e,i,"TestLoadImage: timeout",!1,n),s.setTimeout(function(){i.ontimeout&&i.ontimeout()},1e4),i.src=t}else n(!1)}function Re(t,n,e,i,r){try{n.onload=null,n.onerror=null,n.onabort=null,n.ontimeout=null,r(i)}catch(a){}}be.prototype.cancel=function(){var t,n;if(this.c=xe(this),this.b)this.b.cancel(),this.b=null;else if(this.a&&0!==this.a.size){try{for(var e=i(this.a.values()),r=e.next();!r.done;r=e.next()){r.value.cancel()}}catch(a){t={error:a}}finally{try{r&&!r.done&&(n=e.return)&&n.call(e)}finally{if(t)throw t.error}}this.a.clear()}},Ie.prototype.stringify=function(t){return s.JSON.stringify(t,void 0)},Ie.prototype.parse=function(t){return s.JSON.parse(t,void 0)};var je=s.JSON.parse;function Me(t){At.call(this),this.headers=new Bn,this.H=t||null,this.b=!1,this.s=this.a=null,this.B="",this.h=0,this.f="",this.g=this.A=this.l=this.u=!1,this.o=0,this.m=null,this.I=Le,this.D=this.F=!1}m(Me,At);var Le="",_e=/^https?$/i,Xe=["POST","PUT"];function ke(t){return F&&Q(9)&&"number"==typeof t.timeout&&void 0!==t.ontimeout}function De(t){return"content-type"==t.toLowerCase()}function He(t,n){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=n,t.h=5,Ne(t),Be(t)}function Ne(t){t.u||(t.u=!0,Rt(t,"complete"),Rt(t,"error"))}function Ue(t){if(t.b&&void 0!==o&&(!t.s[1]||4!=Ke(t)||2!=t.W()))if(t.l&&4==Ke(t))Gt(t.za,0,t);else if(Rt(t,"readystatechange"),4==Ke(t)){t.b=!1;try{var n,e=t.W();t:switch(e){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var i=!0;break t;default:i=!1}if(!(n=i)){var r;if(r=0===e){var a=String(t.B).match(Yn)[1]||null;if(!a&&s.self&&s.self.location){var h=s.self.location.protocol;a=h.substr(0,h.length-1)}r=!_e.test(a?a.toLowerCase():"")}n=r}if(n)Rt(t,"complete"),Rt(t,"success");else{t.h=6;try{var l=2<Ke(t)?t.a.statusText:""}catch(e){l=""}t.f=l+" ["+t.W()+"]",Ne(t)}}finally{Be(t)}}}function Be(t,n){if(t.a){Fe(t);var e=t.a,i=t.s[0]?h:null;t.a=null,t.s=null,n||Rt(t,"ready");try{e.onreadystatechange=i}catch(r){}}}function Fe(t){t.a&&t.D&&(t.a.ontimeout=null),t.m&&(s.clearTimeout(t.m),t.m=null)}function Ke(t){return t.a?t.a.readyState:0}function Ye(t){var n="";return _(t,function(t,e){n+=e,n+=":",n+=t,n+="\r\n"}),n}function We(t,n,e){t:{for(i in e){var i=!1;break t}i=!0}i||(e=Ye(e),"string"==typeof t?null!=e&&encodeURIComponent(String(e)):Zn(t,n,e))}function Ge(t,n,e){return e&&e.internalChannelParams&&e.internalChannelParams[t]||n}function Je(t){this.pa=0,this.g=[],this.c=new Qt,this.ga=this.la=this.B=this.fa=this.a=this.na=this.A=this.V=this.i=this.O=this.l=null,this.Oa=this.R=0,this.La=Ge("failFast",!1,t),this.H=this.m=this.j=this.h=this.f=null,this.S=!0,this.I=this.oa=this.P=-1,this.T=this.o=this.u=0,this.Ha=Ge("baseRetryDelayMs",5e3,t),this.Ra=Ge("retryDelaySeedMs",1e4,t),this.Ma=Ge("forwardChannelMaxRetries",2,t),this.ma=Ge("forwardChannelRequestTimeoutMs",2e4,t),this.Na=t&&t.g||void 0,this.D=void 0,this.C=t&&t.supportsCrossDomainXhr||!1,this.J="",this.b=new be(t&&t.concurrentRequestLimit),this.ka=new Oe,this.da=t&&t.fastHandshake||!1,this.Ia=t&&t.b||!1,t&&t.f&&(this.c.a=!1),t&&t.forceLongPolling&&(this.S=!1),this.U=!this.da&&this.S&&t&&t.detectBufferingProxy||!1,this.ea=void 0,this.N=0,this.F=!1,this.s=null,(this.Ka=t&&t.c||!1)&&this.c.info("Opt-in to enable Chrome Origin Trials.")}function Ve(t){if($e(t),3==t.v){var n=t.R++,e=Jn(t.B);Zn(e,"SID",t.J),Zn(e,"RID",n),Zn(e,"TYPE","terminate"),ni(t,e),(n=new xn(t,t.c,n,void 0)).H=2,n.i=Qn(Jn(e)),e=!1,s.navigator&&s.navigator.sendBeacon&&(e=s.navigator.sendBeacon(n.i.toString(),"")),!e&&s.Image&&((new Image).src=n.i,e=!0),e||(n.a=pi(n.g,null),n.a.ba(n.i)),n.u=b(),Ln(n)}ci(t)}function qe(t){t.a&&(ai(t),t.a.cancel(),t.a=null)}function $e(t){qe(t),t.j&&(s.clearTimeout(t.j),t.j=null),si(t),t.b.cancel(),t.h&&("number"==typeof t.h&&s.clearTimeout(t.h),t.h=null)}function ze(t,n){t.g.push(new de(t.Oa++,n)),3==t.v&&Ze(t)}function Ze(t){we(t.b)||t.h||(t.h=!0,Nt(t.Ba,t),t.u=0)}function Qe(t,n){return!(Te(t.b)>=t.b.f-(t.h?1:0))&&(t.h?(t.g=n.s.concat(t.g),!0):!(1==t.v||2==t.v||t.u>=(t.La?0:t.Ma))&&(t.h=vn(y(t.Ba,t,n),li(t,t.u)),t.u++,!0))}function ti(t,n){var e;e=n?n.f:t.R++;var i=Jn(t.B);Zn(i,"SID",t.J),Zn(i,"RID",e),Zn(i,"AID",t.P),ni(t,i),t.i&&t.l&&We(i,t.i,t.l),e=new xn(t,t.c,e,t.u+1),null===t.i&&(e.B=t.l),n&&(t.g=n.s.concat(t.g)),n=ei(t,e,1e3),e.setTimeout(Math.round(.5*t.ma)+Math.round(.5*t.ma*Math.random())),Se(t.b,e),An(e,i,n)}function ni(t,n){t.f&&Un({},function(t,e){Zn(n,e,t)})}function ei(t,n,e){e=Math.min(t.g.length,e);var i=t.f?y(t.f.Ja,t.f,t):null;t:for(var r=t.g,a=-1;;){var o=["count="+e];-1==a?0<e?(a=r[0].b,o.push("ofs="+a)):a=0:o.push("ofs="+a);for(var s=!0,h=0;h<e;h++){var l=r[h].b,u=r[h].a;if(0>(l-=a))a=Math.max(0,r[h].b-100),s=!1;else try{Pe(u,o,"req"+l+"_")}catch(c){i&&i(u)}}if(s){i=o.join("&");break t}}return t=t.g.splice(0,e),n.s=t,i}function ii(t){t.a||t.j||(t.T=1,Nt(t.Aa,t),t.o=0)}function ri(t){return!(t.a||t.j||3<=t.o)&&(t.T++,t.j=vn(y(t.Aa,t),li(t,t.o)),t.o++,!0)}function ai(t){null!=t.s&&(s.clearTimeout(t.s),t.s=null)}function oi(t){t.a=new xn(t,t.c,"rpc",t.T),null===t.i&&(t.a.B=t.l),t.a.O=0;var n=Jn(t.la);Zn(n,"RID","rpc"),Zn(n,"SID",t.J),Zn(n,"CI",t.H?"0":"1"),Zn(n,"AID",t.P),ni(t,n),Zn(n,"TYPE","xmlhttp"),t.i&&t.l&&We(n,t.i,t.l),t.D&&t.a.setTimeout(t.D);var e=t.a;t=t.ga,e.H=1,e.i=Qn(Jn(n)),e.j=null,e.I=!0,Rn(e,t)}function si(t){null!=t.m&&(s.clearTimeout(t.m),t.m=null)}function hi(t,n){var e=null;if(t.a==n){si(t),ai(t),t.a=null;var i=2}else{if(!Ee(t.b,n))return;e=n.s,Ce(t.b,n),i=1}if(t.I=n.N,0!=t.v)if(n.b)if(1==i){e=n.j?n.j.length:0,n=b()-n.u;var r=t.u;Rt(i=hn(),new pn(i,e,n,r)),Ze(t)}else ii(t);else if(3==(r=n.h)||0==r&&0<t.I||!(1==i&&Qe(t,n)||2==i&&ri(t)))switch(e&&0<e.length&&(n=t.b,n.c=n.c.concat(e)),r){case 1:ui(t,5);break;case 4:ui(t,10);break;case 3:ui(t,6);break;default:ui(t,2)}}function li(t,n){var e=t.Ha+Math.floor(Math.random()*t.Ra);return t.f||(e*=2),e*n}function ui(t,n){if(t.c.info("Error code "+n),2==n){var e=null;t.f&&(e=null);var i=y(t.Ya,t);e||(e=new Gn("//www.google.com/images/cleardot.gif"),s.location&&"http"==s.location.protocol||Vn(e,"https"),Qn(e)),Ae(e.toString(),i)}else fn(2);t.v=0,t.f&&t.f.ra(n),ci(t),$e(t)}function ci(t){t.v=0,t.I=-1,t.f&&(0==xe(t.b).length&&0==t.g.length||(t.b.c.length=0,I(t.g),t.g.length=0),t.f.qa())}function fi(t,n,e){var i=te(e);if(""!=i.c)n&&qn(i,n+"."+i.c),$n(i,i.h);else{var r=s.location;i=ne(r.protocol,n?n+"."+r.hostname:r.hostname,+r.port,e)}return t.V&&_(t.V,function(t,n){Zn(i,n,t)}),n=t.A,e=t.na,n&&e&&Zn(i,n,e),Zn(i,"VER",t.ha),ni(t,i),i}function pi(t,n){if(n&&!t.C)throw Error("Can't create secondary domain capable XhrIo object.");return(n=new Me(t.Na)).F=t.C,n}function vi(){}function gi(){if(F&&!(10<=Number(nt)))throw Error("Environmental error: no available transport.")}function yi(t,n){At.call(this),this.a=new Je(n),this.o=t,this.b=n&&n.messageUrlParams||null,t=n&&n.messageHeaders||null,n&&n.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.l=t,t=n&&n.initMessageHeaders||null,n&&n.messageContentType&&(t?t["X-WebChannel-Content-Type"]=n.messageContentType:t={"X-WebChannel-Content-Type":n.messageContentType}),n&&n.a&&(t?t["X-WebChannel-Client-Profile"]=n.a:t={"X-WebChannel-Client-Profile":n.a}),this.a.O=t,(t=n&&n.httpHeadersOverwriteParam)&&!O(t)&&(this.a.i=t),this.m=n&&n.supportsCrossDomainXhr||!1,this.l=n&&n.sendRawJson||!1,(n=n&&n.httpSessionIdParam)&&!O(n)&&(this.a.A=n,null!==(t=this.b)&&n in t&&(n in(t=this.b)&&delete t[n])),this.f=new mi(this)}function di(t){En.call(this);var n=t.__sm__;if(n){t:{for(var e in n){t=e;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==n&&t in n?n[t]:void 0):this.data=n}else this.data=t}function bi(){Sn.call(this),this.status=1}function mi(t){this.a=t}(r=Me.prototype).ba=function(t,n,e,i){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.B+"; newUri="+t);n=n?n.toUpperCase():"GET",this.B=t,this.f="",this.h=0,this.u=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=this.H?bn(this.H):bn(wn),this.a.onreadystatechange=y(this.za,this);try{this.A=!0,this.a.open(n,String(t),!0),this.A=!1}catch(a){return void He(this,a)}t=e||"";var r=new Bn(this.headers);i&&Un(i,function(t,n){r.set(n,t)}),i=C(r.L()),e=s.FormData&&t instanceof s.FormData,!(0<=E(Xe,n))||i||e||r.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),r.forEach(function(t,n){this.a.setRequestHeader(n,t)},this),this.I&&(this.a.responseType=this.I),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{Fe(this),0<this.o&&((this.D=ke(this.a))?(this.a.timeout=this.o,this.a.ontimeout=y(this.xa,this)):this.m=Gt(this.xa,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(a){He(this,a)}},r.xa=function(){void 0!==o&&this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,Rt(this,"timeout"),this.abort(8))},r.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,Rt(this,"complete"),Rt(this,"abort"),Be(this))},r.G=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),Be(this,!0)),Me.X.G.call(this)},r.za=function(){this.j||(this.A||this.l||this.g?Ue(this):this.Ua())},r.Ua=function(){Ue(this)},r.W=function(){try{return 2<Ke(this)?this.a.status:-1}catch(t){return-1}},r.$=function(){try{return this.a?this.a.responseText:""}catch(t){return""}},r.Pa=function(t){if(this.a){var n=this.a.responseText;return t&&0==n.indexOf(t)&&(n=n.substring(t.length)),je(n)}},r.ua=function(){return this.h},r.Qa=function(){return"string"==typeof this.f?this.f:String(this.f)},(r=Je.prototype).ha=8,r.v=1,r.Ba=function(t){if(this.h)if(this.h=null,1==this.v){if(!t){this.R=Math.floor(1e5*Math.random()),t=this.R++;var n,e=new xn(this,this.c,t,void 0),i=this.l;if(this.O&&(i?D(i=X(i),this.O):i=this.O),null===this.i&&(e.B=i),this.da)t:{for(var r=n=0;r<this.g.length;r++){var a=this.g[r];if(void 0===(a="__data__"in a.a&&"string"==typeof(a=a.a.__data__)?a.length:void 0))break;if(4096<(n+=a)){n=r;break t}if(4096===n||r===this.g.length-1){n=r+1;break t}}n=1e3}else n=1e3;n=ei(this,e,n),Zn(r=Jn(this.B),"RID",t),Zn(r,"CVER",22),this.A&&Zn(r,"X-HTTP-Session-Id",this.A),ni(this,r),this.i&&i&&We(r,this.i,i),Se(this.b,e),this.Ia&&Zn(r,"TYPE","init"),this.da?(Zn(r,"$req",n),Zn(r,"SID","null"),e.U=!0,An(e,r,null)):An(e,r,n),this.v=2}}else 3==this.v&&(t?ti(this,t):0==this.g.length||we(this.b)||ti(this))},r.Aa=function(){if(this.j=null,oi(this),this.U&&!(this.F||null==this.a||0>=this.N)){var t=2*this.N;this.c.info("BP detection timer enabled: "+t),this.s=vn(y(this.Ta,this),t)}},r.Ta=function(){this.s&&(this.s=null,this.c.info("BP detection timeout reached."),this.c.info("Buffering proxy detected and switch to long-polling!"),this.H=!1,this.F=!0,fn(10),qe(this),oi(this))},r.Sa=function(){null!=this.m&&(this.m=null,qe(this),ri(this),fn(19))},r.Ya=function(t){t?(this.c.info("Successfully pinged google.com"),fn(2)):(this.c.info("Failed to ping google.com"),fn(1))},(r=vi.prototype).ta=function(){},r.sa=function(){},r.ra=function(){},r.qa=function(){},r.Ja=function(){},gi.prototype.a=function(t,n){return new yi(t,n)},m(yi,At),yi.prototype.g=function(){this.a.f=this.f,this.m&&(this.a.C=!0);var t=this.a,n=this.o,e=this.b||void 0;fn(0),t.fa=n,t.V=e||{},t.H=t.S,t.B=fi(t,null,t.fa),Ze(t)},yi.prototype.close=function(){Ve(this.a)},yi.prototype.h=function(t){if("string"==typeof t){var n={};n.__data__=t,ze(this.a,n)}else this.l?((n={}).__data__=Mt(t),ze(this.a,n)):ze(this.a,t)},yi.prototype.G=function(){this.a.f=null,delete this.f,Ve(this.a),delete this.a,yi.X.G.call(this)},m(di,En),m(bi,Sn),m(mi,vi),mi.prototype.ta=function(){Rt(this.a,"a")},mi.prototype.sa=function(t){Rt(this.a,new di(t))},mi.prototype.ra=function(t){Rt(this.a,new bi(t))},mi.prototype.qa=function(){Rt(this.a,"b")},gi.prototype.createWebChannel=gi.prototype.a,yi.prototype.send=yi.prototype.h,yi.prototype.open=yi.prototype.g,yi.prototype.close=yi.prototype.close,gn.NO_ERROR=0,gn.TIMEOUT=8,gn.HTTP_ERROR=6,yn.COMPLETE="complete",mn.EventType=Tn,Tn.OPEN="a",Tn.CLOSE="b",Tn.ERROR="c",Tn.MESSAGE="d",At.prototype.listen=At.prototype.va,Me.prototype.listenOnce=Me.prototype.wa,Me.prototype.getLastError=Me.prototype.Qa,Me.prototype.getLastErrorCode=Me.prototype.ua,Me.prototype.getStatus=Me.prototype.W,Me.prototype.getResponseJson=Me.prototype.Pa,Me.prototype.getResponseText=Me.prototype.$,Me.prototype.send=Me.prototype.ba;var wi=function(){return new gi};exports.createWebChannelTransport=wi;var Ti=function(){return hn()};exports.getStatEventTarget=Ti;var Ei=gn;exports.ErrorCode=Ei;var Si=yn;exports.EventType=Si;var Ci=on;exports.Event=Ci;var xi={gb:0,jb:1,kb:2,Db:3,Ib:4,Fb:5,Gb:6,Eb:7,Cb:8,Hb:9,PROXY:10,NOPROXY:11,Ab:12,wb:13,xb:14,vb:15,yb:16,zb:17,bb:18,ab:19,cb:20};exports.Stat=xi;var Ii=mn;exports.WebChannel=Ii;var Oi=Me;exports.XhrIo=Oi;var Pi={createWebChannelTransport:wi,getStatEventTarget:Ti,ErrorCode:Ei,EventType:Si,Event:Ci,Stat:xi,WebChannel:Ii,XhrIo:Oi},Ai=Pi;exports.default=Ai;
},{}],"pBGv":[function(require,module,exports) {

var t,e,n=module.exports={};function r(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function i(e){if(t===setTimeout)return setTimeout(e,0);if((t===r||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(n){try{return t.call(null,e,0)}catch(n){return t.call(this,e,0)}}}function u(t){if(e===clearTimeout)return clearTimeout(t);if((e===o||!e)&&clearTimeout)return e=clearTimeout,clearTimeout(t);try{return e(t)}catch(n){try{return e.call(null,t)}catch(n){return e.call(this,t)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:r}catch(n){t=r}try{e="function"==typeof clearTimeout?clearTimeout:o}catch(n){e=o}}();var c,s=[],l=!1,a=-1;function f(){l&&c&&(l=!1,c.length?s=c.concat(s):a=-1,s.length&&h())}function h(){if(!l){var t=i(f);l=!0;for(var e=s.length;e;){for(c=s,s=[];++a<e;)c&&c[a].run();a=-1,e=s.length}c=null,l=!1,u(t)}}function m(t,e){this.fun=t,this.array=e}function p(){}n.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];s.push(new m(t,e)),1!==s.length||l||i(h)},m.prototype.run=function(){this.fun.apply(null,this.array)},n.title="browser",n.env={},n.argv=[],n.version="",n.versions={},n.on=p,n.addListener=p,n.once=p,n.off=p,n.removeListener=p,n.removeAllListeners=p,n.emit=p,n.prependListener=p,n.prependOnceListener=p,n.listeners=function(t){return[]},n.binding=function(t){throw new Error("process.binding is not supported")},n.cwd=function(){return"/"},n.chdir=function(t){throw new Error("process.chdir is not supported")},n.umask=function(){return 0};
},{}],"ydGY":[function(require,module,exports) {
var process = require("process");
var t=require("process");Object.defineProperty(exports,"__esModule",{value:!0}),exports.K=fc,exports.e=Sc,exports.u=Dc,exports.z=exports.t=exports.s=exports.r=exports.q=exports.o=exports.n=exports.j=exports.d=exports.c=exports.b=exports.a=exports.Z=exports.X=exports.W=exports.U=exports.L=void 0;var e=require("@firebase/logger"),n=require("@firebase/util"),r=require("@firebase/webchannel-wrapper"),i=require("tslib"),o=new e.Logger("@firebase/firestore");function u(){return o.logLevel}function s(t){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];if(o.logLevel<=e.LogLevel.DEBUG){var u=n.map(f);o.debug.apply(o,(0,i.__spreadArrays)(["Firestore (8.2.5): "+t],u))}}function a(t){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];if(o.logLevel<=e.LogLevel.ERROR){var u=n.map(f);o.error.apply(o,(0,i.__spreadArrays)(["Firestore (8.2.5): "+t],u))}}function c(t){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];if(o.logLevel<=e.LogLevel.WARN){var u=n.map(f);o.warn.apply(o,(0,i.__spreadArrays)(["Firestore (8.2.5): "+t],u))}}function f(t){if("string"==typeof t)return t;try{return e=t,JSON.stringify(e)}catch(e){return t}var e}function h(t){void 0===t&&(t="Unexpected state");var e="FIRESTORE (8.2.5) INTERNAL ASSERTION FAILED: "+t;throw a(e),new Error(e)}function l(t,e){t||h()}function p(t,e){return t}function d(t){var e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(n);else for(var r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}var v=function(){function t(){}return t.t=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var r=d(40),i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length));return n},t}();function y(t,e){return t<e?-1:t>e?1:0}function g(t,e,n){return t.length===e.length&&t.every(function(t,r){return n(t,e[r])})}function m(t){return t+"\0"}var _=function(){function t(t){this.i=t}return t.fromBase64String=function(e){return new t(atob(e))},t.fromUint8Array=function(e){return new t(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(e))},t.prototype.toBase64=function(){return t=this.i,btoa(t);var t},t.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.i)},t.prototype.o=function(){return 2*this.i.length},t.prototype.u=function(t){return y(this.i,t.i)},t.prototype.isEqual=function(t){return this.i===t.i},t}();_.h=new _("");var w={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},b=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).code=e,r.message=n,r.name="FirebaseError",r.toString=function(){return r.name+": [code="+r.code+"]: "+r.message},r}return(0,i.__extends)(e,t),e}(Error),I=function(){function t(t){this.l=t}return t.fromBase64String=function(e){try{return new t(_.fromBase64String(e))}catch(e){throw new b(w.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}},t.fromUint8Array=function(e){return new t(_.fromUint8Array(e))},t.prototype.toBase64=function(){return this.l.toBase64()},t.prototype.toUint8Array=function(){return this.l.toUint8Array()},t.prototype.toString=function(){return"Bytes(base64: "+this.toBase64()+")"},t.prototype.isEqual=function(t){return this.l.isEqual(t.l)},t}(),E=function(t){this._=t};function T(){if("undefined"==typeof Uint8Array)throw new b(w.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function N(){if("undefined"==typeof atob)throw new b(w.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var x=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return(0,i.__extends)(e,t),e.fromBase64String=function(t){return N(),new e(I.fromBase64String(t))},e.fromUint8Array=function(t){return T(),new e(I.fromUint8Array(t))},e.prototype.toBase64=function(){return N(),this._.toBase64()},e.prototype.toUint8Array=function(){return T(),this._.toUint8Array()},e.prototype.isEqual=function(t){return this._.isEqual(t._)},e.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},e}(E),A=function(t,e,n,r,i,o){this.T=t,this.persistenceKey=e,this.host=n,this.ssl=r,this.forceLongPolling=i,this.I=o},S=function(){function t(t,e){this.projectId=t,this.database=e||"(default)"}return Object.defineProperty(t.prototype,"m",{get:function(){return"(default)"===this.database},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(e){return e instanceof t&&e.projectId===this.projectId&&e.database===this.database},t}(),D=function(){function t(t){this.uid=t}return t.prototype.A=function(){return null!=this.uid},t.prototype.R=function(){return this.A()?"uid:"+this.uid:"anonymous-user"},t.prototype.isEqual=function(t){return t.uid===this.uid},t}();exports.L=x,D.UNAUTHENTICATED=new D(null),D.P=new D("google-credentials-uid"),D.g=new D("first-party-uid");var k=function(t,e){this.user=e,this.type="OAuth",this.V={},this.V.Authorization="Bearer "+t},O=function(){function t(){this.p=null}return t.prototype.getToken=function(){return Promise.resolve(null)},t.prototype.v=function(){},t.prototype.S=function(t){this.p=t,t(D.UNAUTHENTICATED)},t.prototype.D=function(){this.p=null},t}(),L=function(){function t(t){var e=this;this.C=null,this.currentUser=D.UNAUTHENTICATED,this.N=!1,this.F=0,this.p=null,this.forceRefresh=!1,this.C=function(){e.F++,e.currentUser=e.O(),e.N=!0,e.p&&e.p(e.currentUser)},this.F=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.C):(this.C(null),t.get().then(function(t){e.auth=t,e.C&&e.auth.addAuthTokenListener(e.C)},function(){}))}return t.prototype.getToken=function(){var t=this,e=this.F,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(function(n){return t.F!==e?(s("FirebaseCredentialsProvider","getToken aborted due to token change."),t.getToken()):n?(l("string"==typeof n.accessToken),new k(n.accessToken,t.currentUser)):null}):Promise.resolve(null)},t.prototype.v=function(){this.forceRefresh=!0},t.prototype.S=function(t){this.p=t,this.N&&t(this.currentUser)},t.prototype.D=function(){this.auth&&this.auth.removeAuthTokenListener(this.C),this.C=null,this.p=null},t.prototype.O=function(){var t=this.auth&&this.auth.getUid();return l(null===t||"string"==typeof t),new D(t)},t}(),C=function(){function t(t,e){this.k=t,this.M=e,this.type="FirstParty",this.user=D.g}return Object.defineProperty(t.prototype,"V",{get:function(){var t={"X-Goog-AuthUser":this.M},e=this.k.auth.getAuthHeaderValueForFirstParty([]);return e&&(t.Authorization=e),t},enumerable:!1,configurable:!0}),t}(),P=function(){function t(t,e){this.k=t,this.M=e}return t.prototype.getToken=function(){return Promise.resolve(new C(this.k,this.M))},t.prototype.S=function(t){t(D.g)},t.prototype.D=function(){},t.prototype.v=function(){},t}(),V=function(){function t(t,e){var n=this;this.previousValue=t,e&&(e.L=function(t){return n.$(t)},this.B=function(t){return e.q(t)})}return t.prototype.$=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},t.prototype.next=function(){var t=++this.previousValue;return this.B&&this.B(t),t},t}();V.U=-1;var R=function(){function t(t,e){if(this.seconds=t,this.nanoseconds=e,e<0)throw new b(w.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(e>=1e9)throw new b(w.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new b(w.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new b(w.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}return t.now=function(){return t.fromMillis(Date.now())},t.fromDate=function(e){return t.fromMillis(e.getTime())},t.fromMillis=function(e){var n=Math.floor(e/1e3);return new t(n,1e6*(e-1e3*n))},t.prototype.toDate=function(){return new Date(this.toMillis())},t.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},t.prototype.K=function(t){return this.seconds===t.seconds?y(this.nanoseconds,t.nanoseconds):y(this.seconds,t.seconds)},t.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},t.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},t.prototype.toJSON=function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}},t.prototype.valueOf=function(){var t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},t}(),U=function(){function t(t){this.timestamp=t}return t.W=function(e){return new t(e)},t.min=function(){return new t(new R(0,0))},t.prototype.u=function(t){return this.timestamp.K(t.timestamp)},t.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},t.prototype.j=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},t.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},t.prototype.G=function(){return this.timestamp},t}(),M=function(){function t(t,e,n){void 0===e?e=0:e>t.length&&h(),void 0===n?n=t.length-e:n>t.length-e&&h(),this.segments=t,this.offset=e,this.H=n}return Object.defineProperty(t.prototype,"length",{get:function(){return this.H},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(e){return 0===t.J(this,e)},t.prototype.child=function(e){var n=this.segments.slice(this.offset,this.limit());return e instanceof t?e.forEach(function(t){n.push(t)}):n.push(e),this.Y(n)},t.prototype.limit=function(){return this.offset+this.length},t.prototype.X=function(t){return t=void 0===t?1:t,this.Y(this.segments,this.offset+t,this.length-t)},t.prototype.Z=function(){return this.Y(this.segments,this.offset,this.length-1)},t.prototype.tt=function(){return this.segments[this.offset]},t.prototype.et=function(){return this.get(this.length-1)},t.prototype.get=function(t){return this.segments[this.offset+t]},t.prototype.nt=function(){return 0===this.length},t.prototype.st=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.it=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},t.prototype.rt=function(){return this.segments.slice(this.offset,this.limit())},t.J=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(i>o)return 1}return t.length<e.length?-1:t.length>e.length?1:0},t}(),q=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return(0,i.__extends)(e,t),e.prototype.Y=function(t,n,r){return new e(t,n,r)},e.prototype.ot=function(){return this.rt().join("/")},e.prototype.toString=function(){return this.ot()},e.ct=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];for(var r=[],i=0,o=t;i<o.length;i++){var u=o[i];if(u.indexOf("//")>=0)throw new b(w.INVALID_ARGUMENT,"Invalid segment ("+u+"). Paths must not contain // in them.");r.push.apply(r,u.split("/").filter(function(t){return t.length>0}))}return new e(r)},e.at=function(){return new e([])},e}(M),F=/^[_a-zA-Z][_a-zA-Z0-9]*$/,j=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return(0,i.__extends)(e,t),e.prototype.Y=function(t,n,r){return new e(t,n,r)},e.ut=function(t){return F.test(t)},e.prototype.ot=function(){return this.rt().map(function(t){return t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),e.ut(t)||(t="`"+t+"`"),t}).join(".")},e.prototype.toString=function(){return this.ot()},e.prototype.ht=function(){return 1===this.length&&"__name__"===this.get(0)},e.lt=function(){return new e(["__name__"])},e._t=function(t){for(var n=[],r="",i=0,o=function(){if(0===r.length)throw new b(w.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");n.push(r),r=""},u=!1;i<t.length;){var s=t[i];if("\\"===s){if(i+1===t.length)throw new b(w.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var a=t[i+1];if("\\"!==a&&"."!==a&&"`"!==a)throw new b(w.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);r+=a,i+=2}else"`"===s?(u=!u,i++):"."!==s||u?(r+=s,i++):(o(),i++)}if(o(),u)throw new b(w.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new e(n)},e.at=function(){return new e([])},e}(M),z=function(){function t(t){this.path=t}return t.ft=function(e){return new t(q.ct(e))},t.dt=function(e){return new t(q.ct(e).X(5))},t.prototype.wt=function(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t},t.prototype.isEqual=function(t){return null!==t&&0===q.J(this.path,t.path)},t.prototype.toString=function(){return this.path.toString()},t.J=function(t,e){return q.J(t.path,e.path)},t.Et=function(t){return t.length%2==0},t.Tt=function(e){return new t(new q(e.slice()))},t}();function G(t){var e=0;for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function B(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function K(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}exports.z=R;var H=function(){function t(t){this.fields=t,t.sort(j.J)}return t.prototype.It=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].st(t))return!0;return!1},t.prototype.isEqual=function(t){return g(this.fields,t.fields,function(t,e){return t.isEqual(e)})},t}(),J=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function W(t){if(l(!!t),"string"==typeof t){var e=0,n=J.exec(t);if(l(!!n),n[1]){var r=n[1];r=(r+"000000000").substr(0,9),e=Number(r)}var i=new Date(t);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:Q(t.seconds),nanos:Q(t.nanos)}}function Q(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function Y(t){return"string"==typeof t?_.fromBase64String(t):_.fromUint8Array(t)}function X(t){var e,n;return"server_timestamp"===(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function $(t){var e=t.mapValue.fields.__previous_value__;return X(e)?$(e):e}function Z(t){var e=W(t.mapValue.fields.__local_write_time__.timestampValue);return new R(e.seconds,e.nanos)}function tt(t){return null==t}function et(t){return 0===t&&1/t==-1/0}function nt(t){return"number"==typeof t&&Number.isInteger(t)&&!et(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}function rt(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?X(t)?4:10:h()}function it(t,e){var n=rt(t);if(n!==rt(e))return!1;switch(n){case 0:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Z(t).isEqual(Z(e));case 3:return function(t,e){if("string"==typeof t.timestampValue&&"string"==typeof e.timestampValue&&t.timestampValue.length===e.timestampValue.length)return t.timestampValue===e.timestampValue;var n=W(t.timestampValue),r=W(e.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(t,e){return Y(t.bytesValue).isEqual(Y(e.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(t,e){return Q(t.geoPointValue.latitude)===Q(e.geoPointValue.latitude)&&Q(t.geoPointValue.longitude)===Q(e.geoPointValue.longitude)}(t,e);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return Q(t.integerValue)===Q(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){var n=Q(t.doubleValue),r=Q(e.doubleValue);return n===r?et(n)===et(r):isNaN(n)&&isNaN(r)}return!1}(t,e);case 9:return g(t.arrayValue.values||[],e.arrayValue.values||[],it);case 10:return function(t,e){var n=t.mapValue.fields||{},r=e.mapValue.fields||{};if(G(n)!==G(r))return!1;for(var i in n)if(n.hasOwnProperty(i)&&(void 0===r[i]||!it(n[i],r[i])))return!1;return!0}(t,e);default:return h()}}function ot(t,e){return void 0!==(t.values||[]).find(function(t){return it(t,e)})}function ut(t,e){var n=rt(t),r=rt(e);if(n!==r)return y(n,r);switch(n){case 0:return 0;case 1:return y(t.booleanValue,e.booleanValue);case 2:return function(t,e){var n=Q(t.integerValue||t.doubleValue),r=Q(e.integerValue||e.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(t,e);case 3:return st(t.timestampValue,e.timestampValue);case 4:return st(Z(t),Z(e));case 5:return y(t.stringValue,e.stringValue);case 6:return function(t,e){var n=Y(t),r=Y(e);return n.u(r)}(t.bytesValue,e.bytesValue);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var o=y(n[i],r[i]);if(0!==o)return o}return y(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return function(t,e){var n=y(Q(t.latitude),Q(e.latitude));return 0!==n?n:y(Q(t.longitude),Q(e.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var o=ut(n[i],r[i]);if(o)return o}return y(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var u=0;u<r.length&&u<o.length;++u){var s=y(r[u],o[u]);if(0!==s)return s;var a=ut(n[r[u]],i[o[u]]);if(0!==a)return a}return y(r.length,o.length)}(t.mapValue,e.mapValue);default:throw h()}}function st(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return y(t,e);var n=W(t),r=W(e),i=y(n.seconds,r.seconds);return 0!==i?i:y(n.nanos,r.nanos)}function at(t){return ct(t)}function ct(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(t){var e=W(t);return"time("+e.seconds+","+e.nanos+")"}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?Y(t.bytesValue).toBase64():"referenceValue"in t?(n=t.referenceValue,z.dt(n).toString()):"geoPointValue"in t?"geo("+(e=t.geoPointValue).latitude+","+e.longitude+")":"arrayValue"in t?function(t){for(var e="[",n=!0,r=0,i=t.values||[];r<i.length;r++)n?n=!1:e+=",",e+=ct(i[r]);return e+"]"}(t.arrayValue):"mapValue"in t?function(t){for(var e="{",n=!0,r=0,i=Object.keys(t.fields||{}).sort();r<i.length;r++){var o=i[r];n?n=!1:e+=",",e+=o+":"+ct(t.fields[o])}return e+"}"}(t.mapValue):h();var e,n}function ft(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.ot()}}function ht(t){return!!t&&"integerValue"in t}function lt(t){return!!t&&"arrayValue"in t}function pt(t){return!!t&&"nullValue"in t}function dt(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function vt(t){return!!t&&"mapValue"in t}var yt=function(){function t(t){this.proto=t}return t.empty=function(){return new t({mapValue:{}})},t.prototype.field=function(t){if(t.nt())return this.proto;for(var e=this.proto,n=0;n<t.length-1;++n){if(!e.mapValue.fields)return null;if(!vt(e=e.mapValue.fields[t.get(n)]))return null}return(e=(e.mapValue.fields||{})[t.et()])||null},t.prototype.isEqual=function(t){return it(this.proto,t.proto)},t}(),gt=function(){function t(t){void 0===t&&(t=yt.empty()),this.At=t,this.Rt=new Map}return t.prototype.set=function(t,e){return this.Pt(t,e),this},t.prototype.delete=function(t){return this.Pt(t,null),this},t.prototype.Pt=function(t,e){for(var n=this.Rt,r=0;r<t.length-1;++r){var i=t.get(r),o=n.get(i);o instanceof Map?n=o:o&&10===rt(o)?(o=new Map(Object.entries(o.mapValue.fields||{})),n.set(i,o),n=o):(o=new Map,n.set(i,o),n=o)}n.set(t.et(),e)},t.prototype.yt=function(){var t=this.gt(j.at(),this.Rt);return null!=t?new yt(t):this.At},t.prototype.gt=function(t,e){var n=this,r=!1,i=this.At.field(t),o=vt(i)?Object.assign({},i.mapValue.fields):{};return e.forEach(function(e,i){if(e instanceof Map){var u=n.gt(t.child(i),e);null!=u&&(o[i]=u,r=!0)}else null!==e?(o[i]=e,r=!0):o.hasOwnProperty(i)&&(delete o[i],r=!0)}),r?{mapValue:{fields:o}}:null},t}();function mt(t){var e=[];return B(t.fields||{},function(t,n){var r=new j([t]);if(vt(n)){var i=mt(n.mapValue).fields;if(0===i.length)e.push(r);else for(var o=0,u=i;o<u.length;o++){var s=u[o];e.push(r.child(s))}}else e.push(r)}),new H(e)}var _t=function(t,e){this.key=t,this.version=e},wt=function(t){function e(e,n,r,i){var o=this;return(o=t.call(this,e,n)||this).Vt=r,o.bt=!!i.bt,o.hasCommittedMutations=!!i.hasCommittedMutations,o}return(0,i.__extends)(e,t),e.prototype.field=function(t){return this.Vt.field(t)},e.prototype.data=function(){return this.Vt},e.prototype.vt=function(){return this.Vt.proto},e.prototype.isEqual=function(t){return t instanceof e&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.bt===t.bt&&this.hasCommittedMutations===t.hasCommittedMutations&&this.Vt.isEqual(t.Vt)},e.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.Vt.toString()+", {hasLocalMutations: "+this.bt+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(e.prototype,"hasPendingWrites",{get:function(){return this.bt||this.hasCommittedMutations},enumerable:!1,configurable:!0}),e}(_t),bt=function(t){function e(e,n,r){var i=this;return(i=t.call(this,e,n)||this).hasCommittedMutations=!(!r||!r.hasCommittedMutations),i}return(0,i.__extends)(e,t),e.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(e.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!1,configurable:!0}),e.prototype.isEqual=function(t){return t instanceof e&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},e}(_t),It=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return(0,i.__extends)(e,t),e.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(e.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!1,configurable:!0}),e.prototype.isEqual=function(t){return t instanceof e&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},e}(_t),Et=function(t,e,n,r,i,o,u){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===u&&(u=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=u,this.St=null};function Tt(t,e,n,r,i,o,u){return void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===u&&(u=null),new Et(t,e,n,r,i,o,u)}function Nt(t){var e=p(t);if(null===e.St){var n=e.path.ot();null!==e.collectionGroup&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(function(t){return function(t){return t.field.ot()+t.op.toString()+at(t.value)}(t)}).join(","),n+="|ob:",n+=e.orderBy.map(function(t){return function(t){return t.field.ot()+t.dir}(t)}).join(","),tt(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=Mt(e.startAt)),e.endAt&&(n+="|ub:",n+=Mt(e.endAt)),e.St=n}return e.St}function xt(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n=0;n<t.orderBy.length;n++)if(!Ft(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(var r=0;r<t.filters.length;r++)if(i=t.filters[r],o=e.filters[r],i.op!==o.op||!i.field.isEqual(o.field)||!it(i.value,o.value))return!1;var i,o;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!zt(t.startAt,e.startAt)&&zt(t.endAt,e.endAt)}function At(t){return z.Et(t.path)&&null===t.collectionGroup&&0===t.filters.length}var St=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).field=e,i.op=n,i.value=r,i}return(0,i.__extends)(e,t),e.create=function(t,n,r){return t.ht()?"in"===n||"not-in"===n?this.Dt(t,n,r):new Dt(t,n,r):"array-contains"===n?new Ct(t,r):"in"===n?new Pt(t,r):"not-in"===n?new Vt(t,r):"array-contains-any"===n?new Rt(t,r):new e(t,n,r)},e.Dt=function(t,e,n){return"in"===e?new kt(t,n):new Ot(t,n)},e.prototype.matches=function(t){var e=t.field(this.field);return"!="===this.op?null!==e&&this.Ct(ut(e,this.value)):null!==e&&rt(this.value)===rt(e)&&this.Ct(ut(e,this.value))},e.prototype.Ct=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return t>0;case">=":return t>=0;default:return h()}},e.prototype.xt=function(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0},e}(function(){}),Dt=function(t){function e(e,n,r){var i=this;return(i=t.call(this,e,n,r)||this).key=z.dt(r.referenceValue),i}return(0,i.__extends)(e,t),e.prototype.matches=function(t){var e=z.J(t.key,this.key);return this.Ct(e)},e}(St),kt=function(t){function e(e,n){var r=this;return(r=t.call(this,e,"in",n)||this).keys=Lt("in",n),r}return(0,i.__extends)(e,t),e.prototype.matches=function(t){return this.keys.some(function(e){return e.isEqual(t.key)})},e}(St),Ot=function(t){function e(e,n){var r=this;return(r=t.call(this,e,"not-in",n)||this).keys=Lt("not-in",n),r}return(0,i.__extends)(e,t),e.prototype.matches=function(t){return!this.keys.some(function(e){return e.isEqual(t.key)})},e}(St);function Lt(t,e){var n;return((null===(n=e.arrayValue)||void 0===n?void 0:n.values)||[]).map(function(t){return z.dt(t.referenceValue)})}var Ct=function(t){function e(e,n){return t.call(this,e,"array-contains",n)||this}return(0,i.__extends)(e,t),e.prototype.matches=function(t){var e=t.field(this.field);return lt(e)&&ot(e.arrayValue,this.value)},e}(St),Pt=function(t){function e(e,n){return t.call(this,e,"in",n)||this}return(0,i.__extends)(e,t),e.prototype.matches=function(t){var e=t.field(this.field);return null!==e&&ot(this.value.arrayValue,e)},e}(St),Vt=function(t){function e(e,n){return t.call(this,e,"not-in",n)||this}return(0,i.__extends)(e,t),e.prototype.matches=function(t){if(ot(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;var e=t.field(this.field);return null!==e&&!ot(this.value.arrayValue,e)},e}(St),Rt=function(t){function e(e,n){return t.call(this,e,"array-contains-any",n)||this}return(0,i.__extends)(e,t),e.prototype.matches=function(t){var e=this,n=t.field(this.field);return!(!lt(n)||!n.arrayValue.values)&&n.arrayValue.values.some(function(t){return ot(e.value.arrayValue,t)})},e}(St),Ut=function(t,e){this.position=t,this.before=e};function Mt(t){return(t.before?"b":"a")+":"+t.position.map(function(t){return at(t)}).join(",")}var qt=function(t,e){void 0===e&&(e="asc"),this.field=t,this.dir=e};function Ft(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}function jt(t,e,n){for(var r=0,i=0;i<t.position.length;i++){var o=e[i],u=t.position[i];if(r=o.field.ht()?z.J(z.dt(u.referenceValue),n.key):ut(u,n.field(o.field)),"desc"===o.dir&&(r*=-1),0!==r)break}return t.before?r<=0:r<0}function zt(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!it(t.position[n],e.position[n]))return!1;return!0}var Gt=function(t,e,n,r,i,o,u,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===u&&(u=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.Nt=n,this.filters=r,this.limit=i,this.limitType=o,this.startAt=u,this.endAt=s,this.Ft=null,this.Ot=null,this.startAt,this.endAt};function Bt(t,e,n,r,i,o,u,s){return new Gt(t,e,n,r,i,o,u,s)}function Kt(t){return new Gt(t)}function Ht(t){return!tt(t.limit)&&"F"===t.limitType}function Jt(t){return!tt(t.limit)&&"L"===t.limitType}function Wt(t){return t.Nt.length>0?t.Nt[0].field:null}function Qt(t){for(var e=0,n=t.filters;e<n.length;e++){var r=n[e];if(r.xt())return r.field}return null}function Yt(t){return null!==t.collectionGroup}function Xt(t){var e=p(t);if(null===e.Ft){e.Ft=[];var n=Qt(e),r=Wt(e);if(null!==n&&null===r)n.ht()||e.Ft.push(new qt(n)),e.Ft.push(new qt(j.lt(),"asc"));else{for(var i=!1,o=0,u=e.Nt;o<u.length;o++){var s=u[o];e.Ft.push(s),s.field.ht()&&(i=!0)}if(!i){var a=e.Nt.length>0?e.Nt[e.Nt.length-1].dir:"asc";e.Ft.push(new qt(j.lt(),a))}}}return e.Ft}function $t(t){var e=p(t);if(!e.Ot)if("F"===e.limitType)e.Ot=Tt(e.path,e.collectionGroup,Xt(e),e.filters,e.limit,e.startAt,e.endAt);else{for(var n=[],r=0,i=Xt(e);r<i.length;r++){var o=i[r],u="desc"===o.dir?"asc":"desc";n.push(new qt(o.field,u))}var s=e.endAt?new Ut(e.endAt.position,!e.endAt.before):null,a=e.startAt?new Ut(e.startAt.position,!e.startAt.before):null;e.Ot=Tt(e.path,e.collectionGroup,n,e.filters,e.limit,s,a)}return e.Ot}function Zt(t,e,n){return new Gt(t.path,t.collectionGroup,t.Nt.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function te(t,e){return xt($t(t),$t(e))&&t.limitType===e.limitType}function ee(t){return Nt($t(t))+"|lt:"+t.limitType}function ne(t){return"Query(target="+function(t){var e=t.path.ot();return null!==t.collectionGroup&&(e+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(e+=", filters: ["+t.filters.map(function(t){return(e=t).field.ot()+" "+e.op+" "+at(e.value);var e}).join(", ")+"]"),tt(t.limit)||(e+=", limit: "+t.limit),t.orderBy.length>0&&(e+=", orderBy: ["+t.orderBy.map(function(t){return function(t){return t.field.ot()+" ("+t.dir+")"}(t)}).join(", ")+"]"),t.startAt&&(e+=", startAt: "+Mt(t.startAt)),t.endAt&&(e+=", endAt: "+Mt(t.endAt)),"Target("+e+")"}($t(t))+"; limitType="+t.limitType+")"}function re(t,e){return function(t,e){var n=e.key.path;return null!==t.collectionGroup?e.key.wt(t.collectionGroup)&&t.path.st(n):z.Et(t.path)?t.path.isEqual(n):t.path.it(n)}(t,e)&&function(t,e){for(var n=0,r=t.Nt;n<r.length;n++){var i=r[n];if(!i.field.ht()&&null===e.field(i.field))return!1}return!0}(t,e)&&function(t,e){for(var n=0,r=t.filters;n<r.length;n++)if(!r[n].matches(e))return!1;return!0}(t,e)&&function(t,e){return!(t.startAt&&!jt(t.startAt,Xt(t),e)||t.endAt&&jt(t.endAt,Xt(t),e))}(t,e)}function ie(t){return function(e,n){for(var r=!1,i=0,o=Xt(t);i<o.length;i++){var u=o[i],s=oe(u,e,n);if(0!==s)return s;r=r||u.field.ht()}return 0}}function oe(t,e,n){var r=t.field.ht()?z.J(e.key,n.key):function(t,e,n){var r=e.field(t),i=n.field(t);return null!==r&&null!==i?ut(r,i):h()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return h()}}var ue=function(){function t(t,e,n,r,i,o,u){void 0===i&&(i=U.min()),void 0===o&&(o=U.min()),void 0===u&&(u=_.h),this.target=t,this.targetId=e,this.kt=n,this.sequenceNumber=r,this.Mt=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=u}return t.prototype.Lt=function(e){return new t(this.target,this.targetId,this.kt,e,this.Mt,this.lastLimboFreeSnapshotVersion,this.resumeToken)},t.prototype.$t=function(e,n){return new t(this.target,this.targetId,this.kt,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e)},t.prototype.Bt=function(e){return new t(this.target,this.targetId,this.kt,this.sequenceNumber,this.Mt,e,this.resumeToken)},t}();function se(t,e){if(t.qt){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:et(e)?"-0":e}}function ae(t){return{integerValue:""+t}}function ce(t,e){return nt(e)?ae(e):se(t,e)}var fe=function(){this.Ut=void 0};function he(t,e,n){return t instanceof de?function(t,e){var n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:t.seconds,nanos:t.nanoseconds}}}};return e&&(n.fields.__previous_value__=e),{mapValue:n}}(n,e):t instanceof ve?ye(t,e):t instanceof ge?me(t,e):function(t,e){var n=pe(t,e),r=we(n)+we(t.Qt);return ht(n)&&ht(t.Qt)?ae(r):se(t.Kt,r)}(t,e)}function le(t,e,n){return t instanceof ve?ye(t,e):t instanceof ge?me(t,e):n}function pe(t,e){return t instanceof _e?ht(n=e)||n&&"doubleValue"in n?e:{integerValue:0}:null;var n}var de=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return(0,i.__extends)(e,t),e}(fe),ve=function(t){function e(e){var n=this;return(n=t.call(this)||this).elements=e,n}return(0,i.__extends)(e,t),e}(fe);function ye(t,e){for(var n=be(e),r=function(t){n.some(function(e){return it(e,t)})||n.push(t)},i=0,o=t.elements;i<o.length;i++)r(o[i]);return{arrayValue:{values:n}}}var ge=function(t){function e(e){var n=this;return(n=t.call(this)||this).elements=e,n}return(0,i.__extends)(e,t),e}(fe);function me(t,e){for(var n=be(e),r=function(t){n=n.filter(function(e){return!it(e,t)})},i=0,o=t.elements;i<o.length;i++)r(o[i]);return{arrayValue:{values:n}}}var _e=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).Kt=e,r.Qt=n,r}return(0,i.__extends)(e,t),e}(fe);function we(t){return Q(t.integerValue||t.doubleValue)}function be(t){return lt(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}var Ie=function(t,e){this.field=t,this.transform=e},Ee=function(t,e){this.version=t,this.transformResults=e},Te=function(){function t(t,e){this.updateTime=t,this.exists=e}return t.Wt=function(){return new t},t.exists=function(e){return new t(void 0,e)},t.updateTime=function(e){return new t(e)},Object.defineProperty(t.prototype,"jt",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},t}();function Ne(t,e){return void 0!==t.updateTime?e instanceof wt&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e instanceof wt}var xe=function(){};function Ae(t,e,n){return t instanceof Le?function(t,e,n){var r=t.value;if(n.transformResults){var i=Ve(t.fieldTransforms,e,n.transformResults);r=Ue(t.fieldTransforms,r,i)}return new wt(t.key,n.version,r,{hasCommittedMutations:!0})}(t,e,n):t instanceof Ce?function(t,e,n){if(!Ne(t.Gt,e))return new It(t.key,n.version);var r=Pe(t,e,n.transformResults?Ve(t.fieldTransforms,e,n.transformResults):[]);return new wt(t.key,n.version,r,{hasCommittedMutations:!0})}(t,e,n):function(t,e,n){return new bt(t.key,n.version,{hasCommittedMutations:!0})}(t,0,n)}function Se(t,e,n,r){return t instanceof Le?function(t,e,n,r){if(!Ne(t.Gt,e))return e;var i=t.value,o=Re(t.fieldTransforms,n,e);i=Ue(t.fieldTransforms,i,o);var u=Oe(e);return new wt(t.key,u,i,{bt:!0})}(t,e,r):t instanceof Ce?function(t,e,n,r){if(!Ne(t.Gt,e))return e;var i=Oe(e),o=Pe(t,e,Re(t.fieldTransforms,n,e));return new wt(t.key,i,o,{bt:!0})}(t,e,r):function(t,e){return Ne(t.Gt,e)?new bt(t.key,U.min()):e}(t,e)}function De(t,e){return function(t,e){for(var n=null,r=0,i=t;r<i.length;r++){var o=i[r],u=e instanceof wt?e.field(o.field):void 0,s=pe(o.transform,u||null);null!=s&&(n=null==n?(new gt).set(o.field,s):n.set(o.field,s))}return n?n.yt():null}(t.fieldTransforms,e)}function ke(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.Gt.isEqual(e.Gt)&&!!function(t,e){return void 0===t&&void 0===e||!(!t||!e)&&g(t,e,function(t,e){return function(t,e){return t.field.isEqual(e.field)&&function(t,e){return t instanceof ve&&e instanceof ve||t instanceof ge&&e instanceof ge?g(t.elements,e.elements,it):t instanceof _e&&e instanceof _e?it(t.Qt,e.Qt):t instanceof de&&e instanceof de}(t.transform,e.transform)}(t,e)})}(t.fieldTransforms,e.fieldTransforms)&&(0===t.type?t.value.isEqual(e.value):1!==t.type||t.data.isEqual(e.data)&&t.zt.isEqual(e.zt))}function Oe(t){return t instanceof wt?t.version:U.min()}var Le=function(t){function e(e,n,r,i){void 0===i&&(i=[]);var o=this;return(o=t.call(this)||this).key=e,o.value=n,o.Gt=r,o.fieldTransforms=i,o.type=0,o}return(0,i.__extends)(e,t),e}(xe),Ce=function(t){function e(e,n,r,i,o){void 0===o&&(o=[]);var u=this;return(u=t.call(this)||this).key=e,u.data=n,u.zt=r,u.Gt=i,u.fieldTransforms=o,u.type=1,u}return(0,i.__extends)(e,t),e}(xe);function Pe(t,e,n){var r;return r=function(t,e){var n=new gt(e);return t.zt.fields.forEach(function(e){if(!e.nt()){var r=t.data.field(e);null!==r?n.set(e,r):n.delete(e)}}),n.yt()}(t,r=e instanceof wt?e.data():yt.empty()),Ue(t.fieldTransforms,r,n)}function Ve(t,e,n){var r=[];l(t.length===n.length);for(var i=0;i<n.length;i++){var o=t[i],u=o.transform,s=null;e instanceof wt&&(s=e.field(o.field)),r.push(le(u,s,n[i]))}return r}function Re(t,e,n,r){for(var i=[],o=0,u=t;o<u.length;o++){var s=u[o],a=s.transform,c=null;n instanceof wt&&(c=n.field(s.field)),i.push(he(a,c,e))}return i}function Ue(t,e,n){for(var r=new gt(e),i=0;i<t.length;i++){var o=t[i];r.set(o.field,n[i])}return r.yt()}var Me,qe,Fe=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).key=e,r.Gt=n,r.type=2,r.fieldTransforms=[],r}return(0,i.__extends)(e,t),e}(xe),je=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).key=e,r.Gt=n,r.type=3,r.fieldTransforms=[],r}return(0,i.__extends)(e,t),e}(xe),ze=function(t){this.count=t};function Ge(t){switch(t){case w.OK:return h();case w.CANCELLED:case w.UNKNOWN:case w.DEADLINE_EXCEEDED:case w.RESOURCE_EXHAUSTED:case w.INTERNAL:case w.UNAVAILABLE:case w.UNAUTHENTICATED:return!1;case w.INVALID_ARGUMENT:case w.NOT_FOUND:case w.ALREADY_EXISTS:case w.PERMISSION_DENIED:case w.FAILED_PRECONDITION:case w.ABORTED:case w.OUT_OF_RANGE:case w.UNIMPLEMENTED:case w.DATA_LOSS:return!0;default:return h()}}function Be(t){if(void 0===t)return a("GRPC error has no .code"),w.UNKNOWN;switch(t){case Me.OK:return w.OK;case Me.CANCELLED:return w.CANCELLED;case Me.UNKNOWN:return w.UNKNOWN;case Me.DEADLINE_EXCEEDED:return w.DEADLINE_EXCEEDED;case Me.RESOURCE_EXHAUSTED:return w.RESOURCE_EXHAUSTED;case Me.INTERNAL:return w.INTERNAL;case Me.UNAVAILABLE:return w.UNAVAILABLE;case Me.UNAUTHENTICATED:return w.UNAUTHENTICATED;case Me.INVALID_ARGUMENT:return w.INVALID_ARGUMENT;case Me.NOT_FOUND:return w.NOT_FOUND;case Me.ALREADY_EXISTS:return w.ALREADY_EXISTS;case Me.PERMISSION_DENIED:return w.PERMISSION_DENIED;case Me.FAILED_PRECONDITION:return w.FAILED_PRECONDITION;case Me.ABORTED:return w.ABORTED;case Me.OUT_OF_RANGE:return w.OUT_OF_RANGE;case Me.UNIMPLEMENTED:return w.UNIMPLEMENTED;case Me.DATA_LOSS:return w.DATA_LOSS;default:return h()}}(qe=Me||(Me={}))[qe.OK=0]="OK",qe[qe.CANCELLED=1]="CANCELLED",qe[qe.UNKNOWN=2]="UNKNOWN",qe[qe.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",qe[qe.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",qe[qe.NOT_FOUND=5]="NOT_FOUND",qe[qe.ALREADY_EXISTS=6]="ALREADY_EXISTS",qe[qe.PERMISSION_DENIED=7]="PERMISSION_DENIED",qe[qe.UNAUTHENTICATED=16]="UNAUTHENTICATED",qe[qe.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",qe[qe.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",qe[qe.ABORTED=10]="ABORTED",qe[qe.OUT_OF_RANGE=11]="OUT_OF_RANGE",qe[qe.UNIMPLEMENTED=12]="UNIMPLEMENTED",qe[qe.INTERNAL=13]="INTERNAL",qe[qe.UNAVAILABLE=14]="UNAVAILABLE",qe[qe.DATA_LOSS=15]="DATA_LOSS";var Ke=function(){function t(t,e){this.J=t,this.root=e||Je.EMPTY}return t.prototype.Ht=function(e,n){return new t(this.J,this.root.Ht(e,n,this.J).copy(null,null,Je.Jt,null,null))},t.prototype.remove=function(e){return new t(this.J,this.root.remove(e,this.J).copy(null,null,Je.Jt,null,null))},t.prototype.get=function(t){for(var e=this.root;!e.nt();){var n=this.J(t,e.key);if(0===n)return e.value;n<0?e=e.left:n>0&&(e=e.right)}return null},t.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.nt();){var r=this.J(t,n.key);if(0===r)return e+n.left.size;r<0?n=n.left:(e+=n.left.size+1,n=n.right)}return-1},t.prototype.nt=function(){return this.root.nt()},Object.defineProperty(t.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),t.prototype.Yt=function(){return this.root.Yt()},t.prototype.Xt=function(){return this.root.Xt()},t.prototype.Zt=function(t){return this.root.Zt(t)},t.prototype.forEach=function(t){this.Zt(function(e,n){return t(e,n),!1})},t.prototype.toString=function(){var t=[];return this.Zt(function(e,n){return t.push(e+":"+n),!1}),"{"+t.join(", ")+"}"},t.prototype.te=function(t){return this.root.te(t)},t.prototype.ee=function(){return new He(this.root,null,this.J,!1)},t.prototype.ne=function(t){return new He(this.root,t,this.J,!1)},t.prototype.se=function(){return new He(this.root,null,this.J,!0)},t.prototype.ie=function(t){return new He(this.root,t,this.J,!0)},t}(),He=function(){function t(t,e,n,r){this.re=r,this.oe=[];for(var i=1;!t.nt();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this.re?t.left:t.right;else{if(0===i){this.oe.push(t);break}this.oe.push(t),t=this.re?t.right:t.left}}return t.prototype.ce=function(){var t=this.oe.pop(),e={key:t.key,value:t.value};if(this.re)for(t=t.left;!t.nt();)this.oe.push(t),t=t.right;else for(t=t.right;!t.nt();)this.oe.push(t),t=t.left;return e},t.prototype.ae=function(){return this.oe.length>0},t.prototype.ue=function(){if(0===this.oe.length)return null;var t=this.oe[this.oe.length-1];return{key:t.key,value:t.value}},t}(),Je=function(){function t(e,n,r,i,o){this.key=e,this.value=n,this.color=null!=r?r:t.RED,this.left=null!=i?i:t.EMPTY,this.right=null!=o?o:t.EMPTY,this.size=this.left.size+1+this.right.size}return t.prototype.copy=function(e,n,r,i,o){return new t(null!=e?e:this.key,null!=n?n:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=o?o:this.right)},t.prototype.nt=function(){return!1},t.prototype.Zt=function(t){return this.left.Zt(t)||t(this.key,this.value)||this.right.Zt(t)},t.prototype.te=function(t){return this.right.te(t)||t(this.key,this.value)||this.left.te(t)},t.prototype.min=function(){return this.left.nt()?this:this.left.min()},t.prototype.Yt=function(){return this.min().key},t.prototype.Xt=function(){return this.right.nt()?this.key:this.right.Xt()},t.prototype.Ht=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.Ht(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.Ht(t,e,n))).he()},t.prototype.le=function(){if(this.left.nt())return t.EMPTY;var e=this;return e.left._e()||e.left.left._e()||(e=e.fe()),(e=e.copy(null,null,null,e.left.le(),null)).he()},t.prototype.remove=function(e,n){var r,i=this;if(n(e,i.key)<0)i.left.nt()||i.left._e()||i.left.left._e()||(i=i.fe()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left._e()&&(i=i.de()),i.right.nt()||i.right._e()||i.right.left._e()||(i=i.we()),0===n(e,i.key)){if(i.right.nt())return t.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.le())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.he()},t.prototype._e=function(){return this.color},t.prototype.he=function(){var t=this;return t.right._e()&&!t.left._e()&&(t=t.Ee()),t.left._e()&&t.left.left._e()&&(t=t.de()),t.left._e()&&t.right._e()&&(t=t.Te()),t},t.prototype.fe=function(){var t=this.Te();return t.right.left._e()&&(t=(t=(t=t.copy(null,null,null,null,t.right.de())).Ee()).Te()),t},t.prototype.we=function(){var t=this.Te();return t.left.left._e()&&(t=(t=t.de()).Te()),t},t.prototype.Ee=function(){var e=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)},t.prototype.de=function(){var e=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)},t.prototype.Te=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},t.prototype.Ie=function(){var t=this.me();return Math.pow(2,t)<=this.size+1},t.prototype.me=function(){if(this._e()&&this.left._e())throw h();if(this.right._e())throw h();var t=this.left.me();if(t!==this.right.me())throw h();return t+(this._e()?0:1)},t}();Je.EMPTY=null,Je.RED=!0,Je.Jt=!1,Je.EMPTY=new(function(){function t(){this.size=0}return Object.defineProperty(t.prototype,"key",{get:function(){throw h()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"value",{get:function(){throw h()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"color",{get:function(){throw h()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"left",{get:function(){throw h()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"right",{get:function(){throw h()},enumerable:!1,configurable:!0}),t.prototype.copy=function(t,e,n,r,i){return this},t.prototype.Ht=function(t,e,n){return new Je(t,e)},t.prototype.remove=function(t,e){return this},t.prototype.nt=function(){return!0},t.prototype.Zt=function(t){return!1},t.prototype.te=function(t){return!1},t.prototype.Yt=function(){return null},t.prototype.Xt=function(){return null},t.prototype._e=function(){return!1},t.prototype.Ie=function(){return!0},t.prototype.me=function(){return 0},t}());var We=function(){function t(t){this.J=t,this.data=new Ke(this.J)}return t.prototype.has=function(t){return null!==this.data.get(t)},t.prototype.first=function(){return this.data.Yt()},t.prototype.last=function(){return this.data.Xt()},Object.defineProperty(t.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),t.prototype.indexOf=function(t){return this.data.indexOf(t)},t.prototype.forEach=function(t){this.data.Zt(function(e,n){return t(e),!1})},t.prototype.Ae=function(t,e){for(var n=this.data.ne(t[0]);n.ae();){var r=n.ce();if(this.J(r.key,t[1])>=0)return;e(r.key)}},t.prototype.Re=function(t,e){var n;for(n=void 0!==e?this.data.ne(e):this.data.ee();n.ae();)if(!t(n.ce().key))return},t.prototype.Pe=function(t){var e=this.data.ne(t);return e.ae()?e.ce().key:null},t.prototype.ee=function(){return new Qe(this.data.ee())},t.prototype.ne=function(t){return new Qe(this.data.ne(t))},t.prototype.add=function(t){return this.copy(this.data.remove(t).Ht(t,!0))},t.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},t.prototype.nt=function(){return this.data.nt()},t.prototype.ye=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach(function(t){e=e.add(t)}),e},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.data.ee(),r=e.data.ee();n.ae();){var i=n.ce().key,o=r.ce().key;if(0!==this.J(i,o))return!1}return!0},t.prototype.rt=function(){var t=[];return this.forEach(function(e){t.push(e)}),t},t.prototype.toString=function(){var t=[];return this.forEach(function(e){return t.push(e)}),"SortedSet("+t.toString()+")"},t.prototype.copy=function(e){var n=new t(this.J);return n.data=e,n},t}(),Qe=function(){function t(t){this.ge=t}return t.prototype.ce=function(){return this.ge.ce().key},t.prototype.ae=function(){return this.ge.ae()},t}(),Ye=new Ke(z.J);function Xe(){return Ye}function $e(){return Xe()}var Ze=new Ke(z.J);function tn(){return Ze}var en=new Ke(z.J);function nn(){return en}var rn=new We(z.J);function on(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=rn,r=0,i=t;r<i.length;r++){var o=i[r];n=n.add(o)}return n}var un=new We(y);function sn(){return un}var an=function(){function t(t){this.J=t?function(e,n){return t(e,n)||z.J(e.key,n.key)}:function(t,e){return z.J(t.key,e.key)},this.Ve=tn(),this.pe=new Ke(this.J)}return t.be=function(e){return new t(e.J)},t.prototype.has=function(t){return null!=this.Ve.get(t)},t.prototype.get=function(t){return this.Ve.get(t)},t.prototype.first=function(){return this.pe.Yt()},t.prototype.last=function(){return this.pe.Xt()},t.prototype.nt=function(){return this.pe.nt()},t.prototype.indexOf=function(t){var e=this.Ve.get(t);return e?this.pe.indexOf(e):-1},Object.defineProperty(t.prototype,"size",{get:function(){return this.pe.size},enumerable:!1,configurable:!0}),t.prototype.forEach=function(t){this.pe.Zt(function(e,n){return t(e),!1})},t.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.Ve.Ht(t.key,t),e.pe.Ht(t,null))},t.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.Ve.remove(t),this.pe.remove(e)):this},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.pe.ee(),r=e.pe.ee();n.ae();){var i=n.ce().key,o=r.ce().key;if(!i.isEqual(o))return!1}return!0},t.prototype.toString=function(){var t=[];return this.forEach(function(e){t.push(e.toString())}),0===t.length?"DocumentSet ()":"DocumentSet (\n  "+t.join("  \n")+"\n)"},t.prototype.copy=function(e,n){var r=new t;return r.J=this.J,r.Ve=e,r.pe=n,r},t}(),cn=function(){function t(){this.ve=new Ke(z.J)}return t.prototype.track=function(t){var e=t.doc.key,n=this.ve.get(e);n?0!==t.type&&3===n.type?this.ve=this.ve.Ht(e,t):3===t.type&&1!==n.type?this.ve=this.ve.Ht(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.ve=this.ve.Ht(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.ve=this.ve.Ht(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.ve=this.ve.remove(e):1===t.type&&2===n.type?this.ve=this.ve.Ht(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.ve=this.ve.Ht(e,{type:2,doc:t.doc}):h():this.ve=this.ve.Ht(e,t)},t.prototype.Se=function(){var t=[];return this.ve.Zt(function(e,n){t.push(n)}),t},t}(),fn=function(){function t(t,e,n,r,i,o,u,s){this.query=t,this.docs=e,this.De=n,this.docChanges=r,this.Ce=i,this.fromCache=o,this.xe=u,this.Ne=s}return t.Fe=function(e,n,r,i){var o=[];return n.forEach(function(t){o.push({type:0,doc:t})}),new t(e,n,an.be(n),o,r,i,!0,!1)},Object.defineProperty(t.prototype,"hasPendingWrites",{get:function(){return!this.Ce.nt()},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.xe===t.xe&&this.Ce.isEqual(t.Ce)&&te(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.De.isEqual(t.De)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},t}(),hn=function(){function t(t,e,n,r,i){this.Mt=t,this.Oe=e,this.ke=n,this.Me=r,this.Le=i}return t.$e=function(e,n){var r=new Map;return r.set(e,ln.Be(e,n)),new t(U.min(),r,sn(),Xe(),on())},t}(),ln=function(){function t(t,e,n,r,i){this.resumeToken=t,this.qe=e,this.Ue=n,this.Qe=r,this.Ke=i}return t.Be=function(e,n){return new t(_.h,n,on(),on(),on())},t}(),pn=function(t,e,n,r){this.We=t,this.removedTargetIds=e,this.key=n,this.je=r},dn=function(t,e){this.targetId=t,this.Ge=e},vn=function(t,e,n,r){void 0===n&&(n=_.h),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r},yn=function(){function t(){this.ze=0,this.He=_n(),this.Je=_.h,this.Ye=!1,this.Xe=!0}return Object.defineProperty(t.prototype,"qe",{get:function(){return this.Ye},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"resumeToken",{get:function(){return this.Je},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Ze",{get:function(){return 0!==this.ze},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"tn",{get:function(){return this.Xe},enumerable:!1,configurable:!0}),t.prototype.en=function(t){t.o()>0&&(this.Xe=!0,this.Je=t)},t.prototype.nn=function(){var t=on(),e=on(),n=on();return this.He.forEach(function(r,i){switch(i){case 0:t=t.add(r);break;case 2:e=e.add(r);break;case 1:n=n.add(r);break;default:h()}}),new ln(this.Je,this.Ye,t,e,n)},t.prototype.sn=function(){this.Xe=!1,this.He=_n()},t.prototype.rn=function(t,e){this.Xe=!0,this.He=this.He.Ht(t,e)},t.prototype.on=function(t){this.Xe=!0,this.He=this.He.remove(t)},t.prototype.cn=function(){this.ze+=1},t.prototype.an=function(){this.ze-=1},t.prototype.un=function(){this.Xe=!0,this.Ye=!0},t}(),gn=function(){function t(t){this.hn=t,this.ln=new Map,this._n=Xe(),this.fn=mn(),this.dn=new We(y)}return t.prototype.wn=function(t){for(var e=0,n=t.We;e<n.length;e++){var r=n[e];t.je instanceof wt?this.En(r,t.je):t.je instanceof bt&&this.Tn(r,t.key,t.je)}for(var i=0,o=t.removedTargetIds;i<o.length;i++)r=o[i],this.Tn(r,t.key,t.je)},t.prototype.In=function(t){var e=this;this.mn(t,function(n){var r=e.An(n);switch(t.state){case 0:e.Rn(n)&&r.en(t.resumeToken);break;case 1:r.an(),r.Ze||r.sn(),r.en(t.resumeToken);break;case 2:r.an(),r.Ze||e.removeTarget(n);break;case 3:e.Rn(n)&&(r.un(),r.en(t.resumeToken));break;case 4:e.Rn(n)&&(e.Pn(n),r.en(t.resumeToken));break;default:h()}})},t.prototype.mn=function(t,e){var n=this;t.targetIds.length>0?t.targetIds.forEach(e):this.ln.forEach(function(t,r){n.Rn(r)&&e(r)})},t.prototype.yn=function(t){var e=t.targetId,n=t.Ge.count,r=this.gn(e);if(r){var i=r.target;if(At(i))if(0===n){var o=new z(i.path);this.Tn(e,o,new bt(o,U.min()))}else l(1===n);else this.Vn(e)!==n&&(this.Pn(e),this.dn=this.dn.add(e))}},t.prototype.pn=function(t){var e=this,n=new Map;this.ln.forEach(function(r,i){var o=e.gn(i);if(o){if(r.qe&&At(o.target)){var u=new z(o.target.path);null!==e._n.get(u)||e.bn(i,u)||e.Tn(i,u,new bt(u,t))}r.tn&&(n.set(i,r.nn()),r.sn())}});var r=on();this.fn.forEach(function(t,n){var i=!0;n.Re(function(t){var n=e.gn(t);return!n||2===n.kt||(i=!1,!1)}),i&&(r=r.add(t))});var i=new hn(t,n,this.dn,this._n,r);return this._n=Xe(),this.fn=mn(),this.dn=new We(y),i},t.prototype.En=function(t,e){if(this.Rn(t)){var n=this.bn(t,e.key)?2:0;this.An(t).rn(e.key,n),this._n=this._n.Ht(e.key,e),this.fn=this.fn.Ht(e.key,this.vn(e.key).add(t))}},t.prototype.Tn=function(t,e,n){if(this.Rn(t)){var r=this.An(t);this.bn(t,e)?r.rn(e,1):r.on(e),this.fn=this.fn.Ht(e,this.vn(e).delete(t)),n&&(this._n=this._n.Ht(e,n))}},t.prototype.removeTarget=function(t){this.ln.delete(t)},t.prototype.Vn=function(t){var e=this.An(t).nn();return this.hn.Sn(t).size+e.Ue.size-e.Ke.size},t.prototype.cn=function(t){this.An(t).cn()},t.prototype.An=function(t){var e=this.ln.get(t);return e||(e=new yn,this.ln.set(t,e)),e},t.prototype.vn=function(t){var e=this.fn.get(t);return e||(e=new We(y),this.fn=this.fn.Ht(t,e)),e},t.prototype.Rn=function(t){var e=null!==this.gn(t);return e||s("WatchChangeAggregator","Detected inactive target",t),e},t.prototype.gn=function(t){var e=this.ln.get(t);return e&&e.Ze?null:this.hn.Dn(t)},t.prototype.Pn=function(t){var e=this;this.ln.set(t,new yn),this.hn.Sn(t).forEach(function(n){e.Tn(t,n,null)})},t.prototype.bn=function(t,e){return this.hn.Sn(t).has(e)},t}();function mn(){return new Ke(z.J)}function _n(){return new Ke(z.J)}var wn={asc:"ASCENDING",desc:"DESCENDING"},bn={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},In=function(t,e){this.T=t,this.qt=e};function En(t,e){return t.qt?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}}function Tn(t,e){return t.qt?e.toBase64():e.toUint8Array()}function Nn(t,e){return En(t,e.G())}function xn(t){return l(!!t),U.W(function(t){var e=W(t);return new R(e.seconds,e.nanos)}(t))}function An(t,e){return function(t){return new q(["projects",t.projectId,"databases",t.database])}(t).child("documents").child(e).ot()}function Sn(t){var e=q.ct(t);return l($n(e)),e}function Dn(t,e){return An(t.T,e.path)}function kn(t,e){var n=Sn(e);if(n.get(1)!==t.T.projectId)throw new b(w.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.T.projectId);if(n.get(3)!==t.T.database)throw new b(w.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.T.database);return new z(Pn(n))}function On(t,e){return An(t.T,e)}function Ln(t){var e=Sn(t);return 4===e.length?q.at():Pn(e)}function Cn(t){return new q(["projects",t.T.projectId,"databases",t.T.database]).ot()}function Pn(t){return l(t.length>4&&"documents"===t.get(4)),t.X(5)}function Vn(t,e,n){return{name:Dn(t,e),fields:n.proto.mapValue.fields}}function Rn(t,e,n){var r=kn(t,e.name),i=xn(e.updateTime),o=new yt({mapValue:{fields:e.fields}});return new wt(r,i,o,{hasCommittedMutations:!!n})}function Un(t,e){var n;if(e instanceof Le)n={update:Vn(t,e.key,e.value)};else if(e instanceof Fe)n={delete:Dn(t,e.key)};else if(e instanceof Ce)n={update:Vn(t,e.key,e.data),updateMask:Xn(e.zt)};else{if(!(e instanceof je))return h();n={verify:Dn(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(function(t){return function(t,e){var n=e.transform;if(n instanceof de)return{fieldPath:e.field.ot(),setToServerValue:"REQUEST_TIME"};if(n instanceof ve)return{fieldPath:e.field.ot(),appendMissingElements:{values:n.elements}};if(n instanceof ge)return{fieldPath:e.field.ot(),removeAllFromArray:{values:n.elements}};if(n instanceof _e)return{fieldPath:e.field.ot(),increment:n.Qt};throw h()}(0,t)})),e.Gt.jt||(n.currentDocument=function(t,e){return void 0!==e.updateTime?{updateTime:Nn(t,e.updateTime)}:void 0!==e.exists?{exists:e.exists}:h()}(t,e.Gt)),n}function Mn(t,e){var n=e.currentDocument?function(t){return void 0!==t.updateTime?Te.updateTime(xn(t.updateTime)):void 0!==t.exists?Te.exists(t.exists):Te.Wt()}(e.currentDocument):Te.Wt(),r=e.updateTransforms?e.updateTransforms.map(function(e){return function(t,e){var n=null;if("setToServerValue"in e)l("REQUEST_TIME"===e.setToServerValue),n=new de;else if("appendMissingElements"in e){var r=e.appendMissingElements.values||[];n=new ve(r)}else if("removeAllFromArray"in e){var i=e.removeAllFromArray.values||[];n=new ge(i)}else"increment"in e?n=new _e(t,e.increment):h();var o=j._t(e.fieldPath);return new Ie(o,n)}(t,e)}):[];if(e.update){e.update.name;var i=kn(t,e.update.name),o=new yt({mapValue:{fields:e.update.fields}});if(e.updateMask){var u=function(t){var e=t.fieldPaths||[];return new H(e.map(function(t){return j._t(t)}))}(e.updateMask);return new Ce(i,o,u,n,r)}return new Le(i,o,n,r)}if(e.delete){var s=kn(t,e.delete);return new Fe(s,n)}if(e.verify){var a=kn(t,e.verify);return new je(a,n)}return h()}function qn(t,e){return{documents:[On(t,e.path)]}}function Fn(t,e){var n={structuredQuery:{}},r=e.path;null!==e.collectionGroup?(n.parent=On(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=On(t,r.Z()),n.structuredQuery.from=[{collectionId:r.et()}]);var i=function(t){if(0!==t.length){var e=t.map(function(t){return function(t){if("=="===t.op){if(dt(t.value))return{unaryFilter:{field:Jn(t.field),op:"IS_NAN"}};if(pt(t.value))return{unaryFilter:{field:Jn(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(dt(t.value))return{unaryFilter:{field:Jn(t.field),op:"IS_NOT_NAN"}};if(pt(t.value))return{unaryFilter:{field:Jn(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Jn(t.field),op:Hn(t.op),value:t.value}}}(t)});return 1===e.length?e[0]:{compositeFilter:{op:"AND",filters:e}}}}(e.filters);i&&(n.structuredQuery.where=i);var o=function(t){if(0!==t.length)return t.map(function(t){return function(t){return{field:Jn(t.field),direction:Kn(t.dir)}}(t)})}(e.orderBy);o&&(n.structuredQuery.orderBy=o);var u=function(t,e){return t.qt||tt(e)?e:{value:e}}(t,e.limit);return null!==u&&(n.structuredQuery.limit=u),e.startAt&&(n.structuredQuery.startAt=Gn(e.startAt)),e.endAt&&(n.structuredQuery.endAt=Gn(e.endAt)),n}function jn(t){var e=Ln(t.parent),n=t.structuredQuery,r=n.from?n.from.length:0,i=null;if(r>0){l(1===r);var o=n.from[0];o.allDescendants?i=o.collectionId:e=e.child(o.collectionId)}var u=[];n.where&&(u=zn(n.where));var s=[];n.orderBy&&(s=n.orderBy.map(function(t){return function(t){return new qt(Wn(t.field),function(t){switch(t){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(t.direction))}(t)}));var a=null;n.limit&&(a=function(t){var e;return tt(e="object"==typeof t?t.value:t)?null:e}(n.limit));var c=null;n.startAt&&(c=Bn(n.startAt));var f=null;return n.endAt&&(f=Bn(n.endAt)),Bt(e,i,s,u,a,"F",c,f)}function zn(t){return t?void 0!==t.unaryFilter?[Yn(t)]:void 0!==t.fieldFilter?[Qn(t)]:void 0!==t.compositeFilter?t.compositeFilter.filters.map(function(t){return zn(t)}).reduce(function(t,e){return t.concat(e)}):h():[]}function Gn(t){return{before:t.before,values:t.position}}function Bn(t){var e=!!t.before,n=t.values||[];return new Ut(n,e)}function Kn(t){return wn[t]}function Hn(t){return bn[t]}function Jn(t){return{fieldPath:t.ot()}}function Wn(t){return j._t(t.fieldPath)}function Qn(t){return St.create(Wn(t.fieldFilter.field),function(t){switch(t){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":default:return h()}}(t.fieldFilter.op),t.fieldFilter.value)}function Yn(t){switch(t.unaryFilter.op){case"IS_NAN":var e=Wn(t.unaryFilter.field);return St.create(e,"==",{doubleValue:NaN});case"IS_NULL":var n=Wn(t.unaryFilter.field);return St.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":var r=Wn(t.unaryFilter.field);return St.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":var i=Wn(t.unaryFilter.field);return St.create(i,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":default:return h()}}function Xn(t){var e=[];return t.fields.forEach(function(t){return e.push(t.ot())}),{fieldPaths:e}}function $n(t){return t.length>=4&&"projects"===t.get(0)&&"databases"===t.get(2)}var Zn=function(){var t=this;this.promise=new Promise(function(e,n){t.resolve=e,t.reject=n})},tr=function(){function t(t){var e=this;this.Cn=null,this.xn=null,this.result=void 0,this.error=void 0,this.Nn=!1,this.Fn=!1,t(function(t){e.Nn=!0,e.result=t,e.Cn&&e.Cn(t)},function(t){e.Nn=!0,e.error=t,e.xn&&e.xn(t)})}return t.prototype.catch=function(t){return this.next(void 0,t)},t.prototype.next=function(e,n){var r=this;return this.Fn&&h(),this.Fn=!0,this.Nn?this.error?this.On(n,this.error):this.kn(e,this.result):new t(function(t,i){r.Cn=function(n){r.kn(e,n).next(t,i)},r.xn=function(e){r.On(n,e).next(t,i)}})},t.prototype.Mn=function(){var t=this;return new Promise(function(e,n){t.next(e,n)})},t.prototype.Ln=function(e){try{var n=e();return n instanceof t?n:t.resolve(n)}catch(e){return t.reject(e)}},t.prototype.kn=function(e,n){return e?this.Ln(function(){return e(n)}):t.resolve(n)},t.prototype.On=function(e,n){return e?this.Ln(function(){return e(n)}):t.reject(n)},t.resolve=function(e){return new t(function(t,n){t(e)})},t.reject=function(e){return new t(function(t,n){n(e)})},t.$n=function(e){return new t(function(t,n){var r=0,i=0,o=!1;e.forEach(function(e){++r,e.next(function(){++i,o&&i===r&&t()},function(t){return n(t)})}),o=!0,i===r&&t()})},t.Bn=function(e){for(var n=t.resolve(!1),r=function(e){n=n.next(function(n){return n?t.resolve(n):e()})},i=0,o=e;i<o.length;i++)r(o[i]);return n},t.forEach=function(t,e){var n=this,r=[];return t.forEach(function(t,i){r.push(e.call(n,t,i))}),this.$n(r)},t}(),er=function(){function t(t,e){var n=this;this.action=t,this.transaction=e,this.aborted=!1,this.qn=new Zn,this.transaction.oncomplete=function(){n.qn.resolve()},this.transaction.onabort=function(){e.error?n.qn.reject(new ir(t,e.error)):n.qn.resolve()},this.transaction.onerror=function(e){var r=cr(e.target.error);n.qn.reject(new ir(t,r))}}return t.open=function(e,n,r,i){try{return new t(n,e.transaction(i,r))}catch(e){throw new ir(n,e)}},Object.defineProperty(t.prototype,"Un",{get:function(){return this.qn.promise},enumerable:!1,configurable:!0}),t.prototype.abort=function(t){t&&this.qn.reject(t),this.aborted||(s("SimpleDb","Aborting transaction:",t?t.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())},t.prototype.store=function(t){var e=this.transaction.objectStore(t);return new ur(e)},t}(),nr=function(){function e(t,r,i){this.name=t,this.version=r,this.Qn=i,12.2===e.Kn((0,n.getUA)())&&a("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}return e.delete=function(t){return s("SimpleDb","Removing database:",t),sr(window.indexedDB.deleteDatabase(t)).Mn()},e.Wn=function(){if("undefined"==typeof indexedDB)return!1;if(e.jn())return!0;var t=(0,n.getUA)(),r=e.Kn(t),i=0<r&&r<10,o=e.Gn(t),u=0<o&&o<4.5;return!(t.indexOf("MSIE ")>0||t.indexOf("Trident/")>0||t.indexOf("Edge/")>0||i||u)},e.jn=function(){var e;return void 0!==t&&"YES"===(null===(e=t.env)||void 0===e?void 0:e.zn)},e.Hn=function(t,e){return t.store(e)},e.Kn=function(t){var e=t.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=e?e[1].split("_").slice(0,2).join("."):"-1";return Number(n)},e.Gn=function(t){var e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)},e.prototype.Jn=function(t){return(0,i.__awaiter)(this,void 0,void 0,function(){var e,n=this;return(0,i.__generator)(this,function(r){switch(r.label){case 0:return this.db?[3,2]:(s("SimpleDb","Opening database:",this.name),e=this,[4,new Promise(function(e,r){var i=indexedDB.open(n.name,n.version);i.onsuccess=function(t){var n=t.target.result;e(n)},i.onblocked=function(){r(new ir(t,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=function(e){var n=e.target.error;"VersionError"===n.name?r(new b(w.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):r(new ir(t,n))},i.onupgradeneeded=function(t){s("SimpleDb",'Database "'+n.name+'" requires upgrade from version:',t.oldVersion);var e=t.target.result;n.Qn.Yn(e,i.transaction,t.oldVersion,n.version).next(function(){s("SimpleDb","Database upgrade to version "+n.version+" complete")})}})]);case 1:e.db=r.sent(),r.label=2;case 2:return[2,(this.Xn&&(this.db.onversionchange=function(t){return n.Xn(t)}),this.db)]}})})},e.prototype.Zn=function(t){this.Xn=t,this.db&&(this.db.onversionchange=function(e){return t(e)})},e.prototype.runTransaction=function(t,e,n,r){return(0,i.__awaiter)(this,void 0,void 0,function(){var o,u,a,c,f;return(0,i.__generator)(this,function(h){switch(h.label){case 0:o="readonly"===e,u=0,a=function(){var e,a,f,h,l;return(0,i.__generator)(this,function(i){switch(i.label){case 0:++u,i.label=1;case 1:return i.trys.push([1,4,,5]),[4,c.Jn(t)];case 2:return c.db=i.sent(),e=er.open(c.db,t,o?"readonly":"readwrite",n),a=r(e).catch(function(t){return e.abort(t),tr.reject(t)}).Mn(),f={},a.catch(function(){}),[4,e.Un];case 3:return[2,(f.value=(i.sent(),a),f)];case 4:return h=i.sent(),l="FirebaseError"!==h.name&&u<3,s("SimpleDb","Transaction failed with error:",h.message,"Retrying:",l),c.close(),l?[3,5]:[2,{value:Promise.reject(h)}];case 5:return[2]}})},c=this,h.label=1;case 1:return[5,a()];case 2:if("object"==typeof(f=h.sent()))return[2,f.value];h.label=3;case 3:return[3,1];case 4:return[2]}})})},e.prototype.close=function(){this.db&&this.db.close(),this.db=void 0},e}(),rr=function(){function t(t){this.ts=t,this.es=!1,this.ns=null}return Object.defineProperty(t.prototype,"Nn",{get:function(){return this.es},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ss",{get:function(){return this.ns},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"cursor",{set:function(t){this.ts=t},enumerable:!1,configurable:!0}),t.prototype.done=function(){this.es=!0},t.prototype.rs=function(t){this.ns=t},t.prototype.delete=function(){return sr(this.ts.delete())},t}(),ir=function(t){function e(e,n){var r=this;return(r=t.call(this,w.UNAVAILABLE,"IndexedDB transaction '"+e+"' failed: "+n)||this).name="IndexedDbTransactionError",r}return(0,i.__extends)(e,t),e}(b);function or(t){return"IndexedDbTransactionError"===t.name}var ur=function(){function t(t){this.store=t}return t.prototype.put=function(t,e){var n;return void 0!==e?(s("SimpleDb","PUT",this.store.name,t,e),n=this.store.put(e,t)):(s("SimpleDb","PUT",this.store.name,"<auto-key>",t),n=this.store.put(t)),sr(n)},t.prototype.add=function(t){return s("SimpleDb","ADD",this.store.name,t,t),sr(this.store.add(t))},t.prototype.get=function(t){var e=this;return sr(this.store.get(t)).next(function(n){return void 0===n&&(n=null),s("SimpleDb","GET",e.store.name,t,n),n})},t.prototype.delete=function(t){return s("SimpleDb","DELETE",this.store.name,t),sr(this.store.delete(t))},t.prototype.count=function(){return s("SimpleDb","COUNT",this.store.name),sr(this.store.count())},t.prototype.os=function(t,e){var n=this.cursor(this.options(t,e)),r=[];return this.cs(n,function(t,e){r.push(e)}).next(function(){return r})},t.prototype.us=function(t,e){s("SimpleDb","DELETE ALL",this.store.name);var n=this.options(t,e);n.hs=!1;var r=this.cursor(n);return this.cs(r,function(t,e,n){return n.delete()})},t.prototype.ls=function(t,e){var n;e?n=t:(n={},e=t);var r=this.cursor(n);return this.cs(r,e)},t.prototype._s=function(t){var e=this.cursor({});return new tr(function(n,r){e.onerror=function(t){var e=cr(t.target.error);r(e)},e.onsuccess=function(e){var r=e.target.result;r?t(r.primaryKey,r.value).next(function(t){t?r.continue():n()}):n()}})},t.prototype.cs=function(t,e){var n=[];return new tr(function(r,i){t.onerror=function(t){i(t.target.error)},t.onsuccess=function(t){var i=t.target.result;if(i){var o=new rr(i),u=e(i.primaryKey,i.value,o);if(u instanceof tr){var s=u.catch(function(t){return o.done(),tr.reject(t)});n.push(s)}o.Nn?r():null===o.ss?i.continue():i.continue(o.ss)}else r()}}).next(function(){return tr.$n(n)})},t.prototype.options=function(t,e){var n=void 0;return void 0!==t&&("string"==typeof t?n=t:e=t),{index:n,range:e}},t.prototype.cursor=function(t){var e="next";if(t.reverse&&(e="prev"),t.index){var n=this.store.index(t.index);return t.hs?n.openKeyCursor(t.range,e):n.openCursor(t.range,e)}return this.store.openCursor(t.range,e)},t}();function sr(t){return new tr(function(e,n){t.onsuccess=function(t){var n=t.target.result;e(n)},t.onerror=function(t){var e=cr(t.target.error);n(e)}})}var ar=!1;function cr(t){var e=nr.Kn((0,n.getUA)());if(e>=12.2&&e<13){var r="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(r)>=0){var i=new b("internal","IOS_INDEXEDDB_BUG1: IndexedDb has thrown '"+r+"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.");return ar||(ar=!0,setTimeout(function(){throw i},0)),i}}return t}var fr=function(){function t(t,e,n,r,i){this.fs=t,this.ds=e,this.ws=n,this.op=r,this.Es=i,this.Ts=new Zn,this.then=this.Ts.promise.then.bind(this.Ts.promise),this.Ts.promise.catch(function(t){})}return t.Is=function(e,n,r,i,o){var u=new t(e,n,Date.now()+r,i,o);return u.start(r),u},t.prototype.start=function(t){var e=this;this.As=setTimeout(function(){return e.Rs()},t)},t.prototype.Ps=function(){return this.Rs()},t.prototype.cancel=function(t){null!==this.As&&(this.clearTimeout(),this.Ts.reject(new b(w.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},t.prototype.Rs=function(){var t=this;this.fs.ys(function(){return null!==t.As?(t.clearTimeout(),t.op().then(function(e){return t.Ts.resolve(e)})):Promise.resolve()})},t.prototype.clearTimeout=function(){null!==this.As&&(this.Es(this),clearTimeout(this.As),this.As=null)},t}();function hr(t,e){if(a("AsyncQueue",e+": "+t),or(t))return new b(w.UNAVAILABLE,e+": "+t);throw t}var lr="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",pr=function(){function t(){this.gs=[]}return t.prototype.Vs=function(t){this.gs.push(t)},t.prototype.ps=function(){this.gs.forEach(function(t){return t()})},t}();function dr(t){for(var e="",n=0;n<t.length;n++)e.length>0&&(e=yr(e)),e=vr(t.get(n),e);return yr(e)}function vr(t,e){for(var n=e,r=t.length,i=0;i<r;i++){var o=t.charAt(i);switch(o){case"\0":n+="";break;case"":n+="";break;default:n+=o}}return n}function yr(t){return t+""}function gr(t){var e=t.length;if(l(e>=2),2===e)return l(""===t.charAt(0)&&""===t.charAt(1)),q.at();for(var n=e-2,r=[],i="",o=0;o<e;){var u=t.indexOf("",o);switch((u<0||u>n)&&h(),t.charAt(u+1)){case"":var s=t.substring(o,u),a=void 0;0===i.length?a=s:(a=i+=s,i=""),r.push(a);break;case"":i+=t.substring(o,u),i+="\0";break;case"":i+=t.substring(o,u+1);break;default:h()}o=u+2}return new q(r)}var mr=function(t,e){this.seconds=t,this.nanoseconds=e},_r=function(t,e,n){this.ownerId=t,this.allowTabSynchronization=e,this.leaseTimestampMs=n};_r.store="owner",_r.key="owner";var wr=function(t,e,n){this.userId=t,this.lastAcknowledgedBatchId=e,this.lastStreamToken=n};wr.store="mutationQueues",wr.keyPath="userId";var br=function(t,e,n,r,i){this.userId=t,this.batchId=e,this.localWriteTimeMs=n,this.baseMutations=r,this.mutations=i};br.store="mutations",br.keyPath="batchId",br.userMutationsIndex="userMutationsIndex",br.userMutationsKeyPath=["userId","batchId"];var Ir=function(){function t(){}return t.prefixForUser=function(t){return[t]},t.prefixForPath=function(t,e){return[t,dr(e)]},t.key=function(t,e,n){return[t,dr(e),n]},t}();Ir.store="documentMutations",Ir.PLACEHOLDER=new Ir;var Er=function(t,e){this.path=t,this.readTime=e},Tr=function(t,e){this.path=t,this.version=e},Nr=function(t,e,n,r,i,o){this.unknownDocument=t,this.noDocument=e,this.document=n,this.hasCommittedMutations=r,this.readTime=i,this.parentPath=o};Nr.store="remoteDocuments",Nr.readTimeIndex="readTimeIndex",Nr.readTimeIndexPath="readTime",Nr.collectionReadTimeIndex="collectionReadTimeIndex",Nr.collectionReadTimeIndexPath=["parentPath","readTime"];var xr=function(t){this.byteSize=t};xr.store="remoteDocumentGlobal",xr.key="remoteDocumentGlobalKey";var Ar=function(t,e,n,r,i,o,u){this.targetId=t,this.canonicalId=e,this.readTime=n,this.resumeToken=r,this.lastListenSequenceNumber=i,this.lastLimboFreeSnapshotVersion=o,this.query=u};Ar.store="targets",Ar.keyPath="targetId",Ar.queryTargetsIndexName="queryTargetsIndex",Ar.queryTargetsKeyPath=["canonicalId","targetId"];var Sr=function(t,e,n){this.targetId=t,this.path=e,this.sequenceNumber=n};Sr.store="targetDocuments",Sr.keyPath=["targetId","path"],Sr.documentTargetsIndex="documentTargetsIndex",Sr.documentTargetsKeyPath=["path","targetId"];var Dr=function(t,e,n,r){this.highestTargetId=t,this.highestListenSequenceNumber=e,this.lastRemoteSnapshotVersion=n,this.targetCount=r};Dr.key="targetGlobalKey",Dr.store="targetGlobal";var kr=function(t,e){this.collectionId=t,this.parent=e};kr.store="collectionParents",kr.keyPath=["collectionId","parent"];var Or=function(t,e,n,r){this.clientId=t,this.updateTimeMs=e,this.networkEnabled=n,this.inForeground=r};Or.store="clientMetadata",Or.keyPath="clientId";var Lr=function(t,e,n){this.bundleId=t,this.createTime=e,this.version=n};Lr.store="bundles",Lr.keyPath="bundleId";var Cr=function(t,e,n){this.name=t,this.readTime=e,this.bundledQuery=n};Cr.store="namedQueries",Cr.keyPath="name";var Pr=(0,i.__spreadArrays)((0,i.__spreadArrays)((0,i.__spreadArrays)((0,i.__spreadArrays)([wr.store,br.store,Ir.store,Nr.store,Ar.store,_r.store,Dr.store,Sr.store],[Or.store]),[xr.store]),[kr.store]),[Lr.store,Cr.store]),Vr=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).bs=e,r.vs=n,r}return(0,i.__extends)(e,t),e}(pr);function Rr(t,e){var n=p(t);return nr.Hn(n.bs,e)}var Ur=function(){function t(t,e,n,r){this.batchId=t,this.Ss=e,this.baseMutations=n,this.mutations=r}return t.prototype.Ds=function(t,e,n){for(var r=n.Cs,i=0;i<this.mutations.length;i++){var o=this.mutations[i];o.key.isEqual(t)&&(e=Ae(o,e,r[i]))}return e},t.prototype.xs=function(t,e){for(var n=0,r=this.baseMutations;n<r.length;n++)(u=r[n]).key.isEqual(t)&&(e=Se(u,e,0,this.Ss));for(var i=0,o=this.mutations;i<o.length;i++){var u;(u=o[i]).key.isEqual(t)&&(e=Se(u,e,0,this.Ss))}return e},t.prototype.Ns=function(t){var e=this,n=t;return this.mutations.forEach(function(r){var i=e.xs(r.key,t.get(r.key));i&&(n=n.Ht(r.key,i))}),n},t.prototype.keys=function(){return this.mutations.reduce(function(t,e){return t.add(e.key)},on())},t.prototype.isEqual=function(t){return this.batchId===t.batchId&&g(this.mutations,t.mutations,function(t,e){return ke(t,e)})&&g(this.baseMutations,t.baseMutations,function(t,e){return ke(t,e)})},t}(),Mr=function(){function t(t,e,n,r){this.batch=t,this.Fs=e,this.Cs=n,this.Os=r}return t.from=function(e,n,r){l(e.mutations.length===r.length);for(var i=nn(),o=e.mutations,u=0;u<o.length;u++)i=i.Ht(o[u].key,r[u].version);return new t(e,n,r,i)},t}(),qr=function(t){this.ks=t};function Fr(t,e){if(e.document)return Rn(t.ks,e.document,!!e.hasCommittedMutations);if(e.noDocument){var n=z.Tt(e.noDocument.path),r=Kr(e.noDocument.readTime);return new bt(n,r,{hasCommittedMutations:!!e.hasCommittedMutations})}if(e.unknownDocument){var i=z.Tt(e.unknownDocument.path);return r=Kr(e.unknownDocument.version),new It(i,r)}return h()}function jr(t,e,n){var r=zr(n),i=e.key.path.Z().rt();if(e instanceof wt){var o=function(t,e){return{name:Dn(t,e.key),fields:e.vt().mapValue.fields,updateTime:En(t,e.version.G())}}(t.ks,e),u=e.hasCommittedMutations;return new Nr(null,null,o,u,r,i)}if(e instanceof bt){var s=e.key.path.rt(),a=Br(e.version);return u=e.hasCommittedMutations,new Nr(null,new Er(s,a),null,u,r,i)}if(e instanceof It){var c=e.key.path.rt(),f=Br(e.version);return new Nr(new Tr(c,f),null,null,!0,r,i)}return h()}function zr(t){var e=t.G();return[e.seconds,e.nanoseconds]}function Gr(t){var e=new R(t[0],t[1]);return U.W(e)}function Br(t){var e=t.G();return new mr(e.seconds,e.nanoseconds)}function Kr(t){var e=new R(t.seconds,t.nanoseconds);return U.W(e)}function Hr(t,e){for(var n=(e.baseMutations||[]).map(function(e){return Mn(t.ks,e)}),r=e.mutations.length-1;r>=0;--r){var i=e.mutations[r];void 0!==(null==i?void 0:i.transform)&&(e.mutations[r-1].updateTransforms=i.transform.fieldTransforms,e.mutations.splice(r,1),--r)}var o=e.mutations.map(function(e){return Mn(t.ks,e)}),u=R.fromMillis(e.localWriteTimeMs);return new Ur(e.batchId,u,n,o)}function Jr(t){var e,n,r=Kr(t.readTime),i=void 0!==t.lastLimboFreeSnapshotVersion?Kr(t.lastLimboFreeSnapshotVersion):U.min();return void 0!==t.query.documents?(l(1===(n=t.query).documents.length),e=$t(Kt(Ln(n.documents[0])))):e=function(t){return $t(jn(t))}(t.query),new ue(e,t.targetId,0,t.lastListenSequenceNumber,r,i,_.fromBase64String(t.resumeToken))}function Wr(t,e){var n,r=Br(e.Mt),i=Br(e.lastLimboFreeSnapshotVersion);n=At(e.target)?qn(t.ks,e.target):Fn(t.ks,e.target);var o=e.resumeToken.toBase64();return new Ar(e.targetId,Nt(e.target),r,o,e.sequenceNumber,i,n)}function Qr(t){var e=jn({parent:t.parent,structuredQuery:t.structuredQuery});return"LAST"===t.limitType?Zt(e,e.limit,"L"):e}var Yr=function(){function t(){}return t.prototype.Ms=function(t,e){return Xr(t).get(e).next(function(t){if(t)return{id:(e=t).bundleId,createTime:Kr(e.createTime),version:e.version};var e})},t.prototype.Ls=function(t,e){return Xr(t).put({bundleId:(n=e).id,createTime:Br(xn(n.createTime)),version:n.version});var n},t.prototype.$s=function(t,e){return $r(t).get(e).next(function(t){if(t)return{name:(e=t).name,query:Qr(e.bundledQuery),readTime:Kr(e.readTime)};var e})},t.prototype.Bs=function(t,e){return $r(t).put(function(t){return{name:t.name,readTime:Br(xn(t.readTime)),bundledQuery:t.bundledQuery}}(e))},t}();function Xr(t){return Rr(t,Lr.store)}function $r(t){return Rr(t,Cr.store)}var Zr=function(){function t(){this.qs=new ti}return t.prototype.Us=function(t,e){return this.qs.add(e),tr.resolve()},t.prototype.Qs=function(t,e){return tr.resolve(this.qs.getEntries(e))},t}(),ti=function(){function t(){this.index={}}return t.prototype.add=function(t){var e=t.et(),n=t.Z(),r=this.index[e]||new We(q.J),i=!r.has(n);return this.index[e]=r.add(n),i},t.prototype.has=function(t){var e=t.et(),n=t.Z(),r=this.index[e];return r&&r.has(n)},t.prototype.getEntries=function(t){return(this.index[t]||new We(q.J)).rt()},t}(),ei=function(){function t(){this.Ks=new ti}return t.prototype.Us=function(t,e){var n=this;if(!this.Ks.has(e)){var r=e.et(),i=e.Z();t.Vs(function(){n.Ks.add(e)});var o={collectionId:r,parent:dr(i)};return ni(t).put(o)}return tr.resolve()},t.prototype.Qs=function(t,e){var n=[],r=IDBKeyRange.bound([e,""],[m(e),""],!1,!0);return ni(t).os(r).next(function(t){for(var r=0,i=t;r<i.length;r++){var o=i[r];if(o.collectionId!==e)break;n.push(gr(o.parent))}return n})},t}();function ni(t){return Rr(t,kr.store)}var ri={Ws:!1,js:0,Gs:0,zs:0},ii=function(){function t(t,e,n){this.Hs=t,this.Js=e,this.Ys=n}return t.Xs=function(e){return new t(e,t.Zs,t.ti)},t}();function oi(t){return(0,i.__awaiter)(this,void 0,void 0,function(){return(0,i.__generator)(this,function(e){if(t.code!==w.FAILED_PRECONDITION||t.message!==lr)throw t;return s("LocalStore","Unexpectedly lost primary lease"),[2]})})}ii.Zs=10,ii.ti=1e3,ii.ei=new ii(41943040,ii.Zs,ii.ti),ii.ni=new ii(-1,0,0);var ui=function(){function t(t,e){this.si=t,this.ii=e,this.ri={}}return t.prototype.get=function(t){var e=this.si(t),n=this.ri[e];if(void 0!==n)for(var r=0,i=n;r<i.length;r++){var o=i[r],u=o[0],s=o[1];if(this.ii(u,t))return s}},t.prototype.has=function(t){return void 0!==this.get(t)},t.prototype.set=function(t,e){var n=this.si(t),r=this.ri[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.ii(r[i][0],t))return void(r[i]=[t,e]);r.push([t,e])}else this.ri[n]=[[t,e]]},t.prototype.delete=function(t){var e=this.si(t),n=this.ri[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.ii(n[r][0],t))return 1===n.length?delete this.ri[e]:n.splice(r,1),!0;return!1},t.prototype.forEach=function(t){B(this.ri,function(e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r],u=o[0],s=o[1];t(u,s)}})},t.prototype.nt=function(){return K(this.ri)},t}(),si=function(){function t(){this.oi=new ui(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),this.ci=!1}return t.prototype.ai=function(t){var e=this.oi.get(t);return e?e.readTime:U.min()},t.prototype.ui=function(t,e){this.hi(),this.oi.set(t.key,{li:t,readTime:e})},t.prototype._i=function(t,e){void 0===e&&(e=null),this.hi(),this.oi.set(t,{li:null,readTime:e})},t.prototype.fi=function(t,e){this.hi();var n=this.oi.get(e);return void 0!==n?tr.resolve(n.li):this.di(t,e)},t.prototype.getEntries=function(t,e){return this.wi(t,e)},t.prototype.apply=function(t){return this.hi(),this.ci=!0,this.Ei(t)},t.prototype.hi=function(){},t}();function ai(t,e,n){var r=t.store(br.store),i=t.store(Ir.store),o=[],u=IDBKeyRange.only(n.batchId),s=0,a=r.ls({range:u},function(t,e,n){return s++,n.delete()});o.push(a.next(function(){l(1===s)}));for(var c=[],f=0,h=n.mutations;f<h.length;f++){var p=h[f],d=Ir.key(e,p.key.path,n.batchId);o.push(i.delete(d)),c.push(p.key)}return tr.$n(o).next(function(){return c})}function ci(t){var e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw h();e=t.noDocument}return JSON.stringify(e).length}var fi=function(){function t(t,e,n,r){this.userId=t,this.Kt=e,this.Ti=n,this.Ii=r,this.mi={}}return t.Ai=function(e,n,r,i){return l(""!==e.uid),new t(e.A()?e.uid:"",n,r,i)},t.prototype.Ri=function(t){var e=!0,n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return li(t).ls({index:br.userMutationsIndex,range:n},function(t,n,r){e=!1,r.done()}).next(function(){return e})},t.prototype.Pi=function(t,e,n,r){var i=this,o=pi(t),u=li(t);return u.add({}).next(function(s){l("number"==typeof s);for(var a=new Ur(s,e,n,r),c=function(t,e,n){var r=n.baseMutations.map(function(e){return Un(t.ks,e)}),i=n.mutations.map(function(e){return Un(t.ks,e)});return new br(e,n.batchId,n.Ss.toMillis(),r,i)}(i.Kt,i.userId,a),f=[],h=new We(function(t,e){return y(t.ot(),e.ot())}),p=0,d=r;p<d.length;p++){var v=d[p],g=Ir.key(i.userId,v.key.path,s);h=h.add(v.key.path.Z()),f.push(u.put(c)),f.push(o.put(g,Ir.PLACEHOLDER))}return h.forEach(function(e){f.push(i.Ti.Us(t,e))}),t.Vs(function(){i.mi[s]=a.keys()}),tr.$n(f).next(function(){return a})})},t.prototype.yi=function(t,e){var n=this;return li(t).get(e).next(function(t){return t?(l(t.userId===n.userId),Hr(n.Kt,t)):null})},t.prototype.gi=function(t,e){var n=this;return this.mi[e]?tr.resolve(this.mi[e]):this.yi(t,e).next(function(t){if(t){var r=t.keys();return n.mi[e]=r,r}return null})},t.prototype.Vi=function(t,e){var n=this,r=e+1,i=IDBKeyRange.lowerBound([this.userId,r]),o=null;return li(t).ls({index:br.userMutationsIndex,range:i},function(t,e,i){e.userId===n.userId&&(l(e.batchId>=r),o=Hr(n.Kt,e)),i.done()}).next(function(){return o})},t.prototype.pi=function(t){var e=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),n=-1;return li(t).ls({index:br.userMutationsIndex,range:e,reverse:!0},function(t,e,r){n=e.batchId,r.done()}).next(function(){return n})},t.prototype.bi=function(t){var e=this,n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return li(t).os(br.userMutationsIndex,n).next(function(t){return t.map(function(t){return Hr(e.Kt,t)})})},t.prototype.vi=function(t,e){var n=this,r=Ir.prefixForPath(this.userId,e.path),i=IDBKeyRange.lowerBound(r),o=[];return pi(t).ls({range:i},function(r,i,u){var s=r[0],a=r[1],c=r[2],f=gr(a);if(s===n.userId&&e.path.isEqual(f))return li(t).get(c).next(function(t){if(!t)throw h();l(t.userId===n.userId),o.push(Hr(n.Kt,t))});u.done()}).next(function(){return o})},t.prototype.Si=function(t,e){var n=this,r=new We(y),i=[];return e.forEach(function(e){var o=Ir.prefixForPath(n.userId,e.path),u=IDBKeyRange.lowerBound(o),s=pi(t).ls({range:u},function(t,i,o){var u=t[0],s=t[1],a=t[2],c=gr(s);u===n.userId&&e.path.isEqual(c)?r=r.add(a):o.done()});i.push(s)}),tr.$n(i).next(function(){return n.Di(t,r)})},t.prototype.Ci=function(t,e){var n=this,r=e.path,i=r.length+1,o=Ir.prefixForPath(this.userId,r),u=IDBKeyRange.lowerBound(o),s=new We(y);return pi(t).ls({range:u},function(t,e,o){var u=t[0],a=t[1],c=t[2],f=gr(a);u===n.userId&&r.st(f)?f.length===i&&(s=s.add(c)):o.done()}).next(function(){return n.Di(t,s)})},t.prototype.Di=function(t,e){var n=this,r=[],i=[];return e.forEach(function(e){i.push(li(t).get(e).next(function(t){if(null===t)throw h();l(t.userId===n.userId),r.push(Hr(n.Kt,t))}))}),tr.$n(i).next(function(){return r})},t.prototype.xi=function(t,e){var n=this;return ai(t.bs,this.userId,e).next(function(r){return t.Vs(function(){n.Ni(e.batchId)}),tr.forEach(r,function(e){return n.Ii.Fi(t,e)})})},t.prototype.Ni=function(t){delete this.mi[t]},t.prototype.Oi=function(t){var e=this;return this.Ri(t).next(function(n){if(!n)return tr.resolve();var r=IDBKeyRange.lowerBound(Ir.prefixForUser(e.userId)),i=[];return pi(t).ls({range:r},function(t,n,r){if(t[0]===e.userId){var o=gr(t[1]);i.push(o)}else r.done()}).next(function(){l(0===i.length)})})},t.prototype.ki=function(t,e){return hi(t,this.userId,e)},t.prototype.Mi=function(t){var e=this;return di(t).get(this.userId).next(function(t){return t||new wr(e.userId,-1,"")})},t}();function hi(t,e,n){var r=Ir.prefixForPath(e,n.path),i=r[1],o=IDBKeyRange.lowerBound(r),u=!1;return pi(t).ls({range:o,hs:!0},function(t,n,r){var o=t[0],s=t[1];t[2],o===e&&s===i&&(u=!0),r.done()}).next(function(){return u})}function li(t){return Rr(t,br.store)}function pi(t){return Rr(t,Ir.store)}function di(t){return Rr(t,wr.store)}var vi=function(){function t(t){this.Li=t}return t.prototype.next=function(){return this.Li+=2,this.Li},t.$i=function(){return new t(0)},t.Bi=function(){return new t(-1)},t}(),yi=function(){function t(t,e){this.Ii=t,this.Kt=e}return t.prototype.qi=function(t){var e=this;return this.Ui(t).next(function(n){var r=new vi(n.highestTargetId);return n.highestTargetId=r.next(),e.Qi(t,n).next(function(){return n.highestTargetId})})},t.prototype.Ki=function(t){return this.Ui(t).next(function(t){return U.W(new R(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))})},t.prototype.Wi=function(t){return this.Ui(t).next(function(t){return t.highestListenSequenceNumber})},t.prototype.ji=function(t,e,n){var r=this;return this.Ui(t).next(function(i){return i.highestListenSequenceNumber=e,n&&(i.lastRemoteSnapshotVersion=n.G()),e>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=e),r.Qi(t,i)})},t.prototype.Gi=function(t,e){var n=this;return this.zi(t,e).next(function(){return n.Ui(t).next(function(r){return r.targetCount+=1,n.Hi(e,r),n.Qi(t,r)})})},t.prototype.Ji=function(t,e){return this.zi(t,e)},t.prototype.Yi=function(t,e){var n=this;return this.Xi(t,e.targetId).next(function(){return gi(t).delete(e.targetId)}).next(function(){return n.Ui(t)}).next(function(e){return l(e.targetCount>0),e.targetCount-=1,n.Qi(t,e)})},t.prototype.Zi=function(t,e,n){var r=this,i=0,o=[];return gi(t).ls(function(u,s){var a=Jr(s);a.sequenceNumber<=e&&null===n.get(a.targetId)&&(i++,o.push(r.Yi(t,a)))}).next(function(){return tr.$n(o)}).next(function(){return i})},t.prototype.mn=function(t,e){return gi(t).ls(function(t,n){var r=Jr(n);e(r)})},t.prototype.Ui=function(t){return mi(t).get(Dr.key).next(function(t){return l(null!==t),t})},t.prototype.Qi=function(t,e){return mi(t).put(Dr.key,e)},t.prototype.zi=function(t,e){return gi(t).put(Wr(this.Kt,e))},t.prototype.Hi=function(t,e){var n=!1;return t.targetId>e.highestTargetId&&(e.highestTargetId=t.targetId,n=!0),t.sequenceNumber>e.highestListenSequenceNumber&&(e.highestListenSequenceNumber=t.sequenceNumber,n=!0),n},t.prototype.tr=function(t){return this.Ui(t).next(function(t){return t.targetCount})},t.prototype.er=function(t,e){var n=Nt(e),r=IDBKeyRange.bound([n,Number.NEGATIVE_INFINITY],[n,Number.POSITIVE_INFINITY]),i=null;return gi(t).ls({range:r,index:Ar.queryTargetsIndexName},function(t,n,r){var o=Jr(n);xt(e,o.target)&&(i=o,r.done())}).next(function(){return i})},t.prototype.nr=function(t,e,n){var r=this,i=[],o=_i(t);return e.forEach(function(e){var u=dr(e.path);i.push(o.put(new Sr(n,u))),i.push(r.Ii.sr(t,n,e))}),tr.$n(i)},t.prototype.ir=function(t,e,n){var r=this,i=_i(t);return tr.forEach(e,function(e){var o=dr(e.path);return tr.$n([i.delete([n,o]),r.Ii.rr(t,n,e)])})},t.prototype.Xi=function(t,e){var n=_i(t),r=IDBKeyRange.bound([e],[e+1],!1,!0);return n.delete(r)},t.prototype.cr=function(t,e){var n=IDBKeyRange.bound([e],[e+1],!1,!0),r=_i(t),i=on();return r.ls({range:n,hs:!0},function(t,e,n){var r=gr(t[1]),o=new z(r);i=i.add(o)}).next(function(){return i})},t.prototype.ki=function(t,e){var n=dr(e.path),r=IDBKeyRange.bound([n],[m(n)],!1,!0),i=0;return _i(t).ls({index:Sr.documentTargetsIndex,hs:!0,range:r},function(t,e,n){var r=t[0];t[1],0!==r&&(i++,n.done())}).next(function(){return i>0})},t.prototype.Dn=function(t,e){return gi(t).get(e).next(function(t){return t?Jr(t):null})},t}();function gi(t){return Rr(t,Ar.store)}function mi(t){return Rr(t,Dr.store)}function _i(t){return Rr(t,Sr.store)}function wi(t,e){var n=t[0],r=t[1],i=e[0],o=e[1],u=y(n,i);return 0===u?y(r,o):u}var bi=function(){function t(t){this.ar=t,this.buffer=new We(wi),this.ur=0}return t.prototype.hr=function(){return++this.ur},t.prototype.lr=function(t){var e=[t,this.hr()];if(this.buffer.size<this.ar)this.buffer=this.buffer.add(e);else{var n=this.buffer.last();wi(e,n)<0&&(this.buffer=this.buffer.delete(n).add(e))}},Object.defineProperty(t.prototype,"maxValue",{get:function(){return this.buffer.last()[0]},enumerable:!1,configurable:!0}),t}(),Ii=function(){function t(t,e){this._r=t,this.fs=e,this.dr=!1,this.wr=null}return t.prototype.start=function(t){-1!==this._r.params.Hs&&this.Er(t)},t.prototype.stop=function(){this.wr&&(this.wr.cancel(),this.wr=null)},Object.defineProperty(t.prototype,"Tr",{get:function(){return null!==this.wr},enumerable:!1,configurable:!0}),t.prototype.Er=function(t){var e=this,n=this.dr?3e5:6e4;s("LruGarbageCollector","Garbage collection scheduled in "+n+"ms"),this.wr=this.fs.Ir("lru_garbage_collection",n,function(){return(0,i.__awaiter)(e,void 0,void 0,function(){var e;return(0,i.__generator)(this,function(n){switch(n.label){case 0:this.wr=null,this.dr=!0,n.label=1;case 1:return n.trys.push([1,3,,7]),[4,t.mr(this._r)];case 2:return n.sent(),[3,7];case 3:return or(e=n.sent())?(s("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",e),[3,6]):[3,4];case 4:return[4,oi(e)];case 5:n.sent(),n.label=6;case 6:return[3,7];case 7:return[4,this.Er(t)];case 8:return n.sent(),[2]}})})})},t}(),Ei=function(){function t(t,e){this.Ar=t,this.params=e}return t.prototype.Rr=function(t,e){return this.Ar.Pr(t).next(function(t){return Math.floor(e/100*t)})},t.prototype.yr=function(t,e){var n=this;if(0===e)return tr.resolve(V.U);var r=new bi(e);return this.Ar.mn(t,function(t){return r.lr(t.sequenceNumber)}).next(function(){return n.Ar.gr(t,function(t){return r.lr(t)})}).next(function(){return r.maxValue})},t.prototype.Zi=function(t,e,n){return this.Ar.Zi(t,e,n)},t.prototype.Vr=function(t,e){return this.Ar.Vr(t,e)},t.prototype.pr=function(t,e){var n=this;return-1===this.params.Hs?(s("LruGarbageCollector","Garbage collection skipped; disabled"),tr.resolve(ri)):this.br(t).next(function(r){return r<n.params.Hs?(s("LruGarbageCollector","Garbage collection skipped; Cache size "+r+" is lower than threshold "+n.params.Hs),ri):n.vr(t,e)})},t.prototype.br=function(t){return this.Ar.br(t)},t.prototype.vr=function(t,n){var r,i,o,a,c,f,h,l=this,p=Date.now();return this.Rr(t,this.params.Js).next(function(e){return e>l.params.Ys?(s("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of "+l.params.Ys+" from "+e),i=l.params.Ys):i=e,a=Date.now(),l.yr(t,i)}).next(function(e){return r=e,c=Date.now(),l.Zi(t,r,n)}).next(function(e){return o=e,f=Date.now(),l.Vr(t,r)}).next(function(t){return h=Date.now(),u()<=e.LogLevel.DEBUG&&s("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in "+(a-p)+"ms\n\tDetermined least recently used "+i+" in "+(c-a)+"ms\n\tRemoved "+o+" targets in "+(f-c)+"ms\n\tRemoved "+t+" documents in "+(h-f)+"ms\nTotal Duration: "+(h-p)+"ms"),tr.resolve({Ws:!0,js:i,Gs:o,zs:t})})},t}(),Ti=function(){function t(t,e){this.db=t,this._r=function(t,e){return new Ei(t,e)}(this,e)}return t.prototype.Pr=function(t){var e=this.Sr(t);return this.db.Dr().tr(t).next(function(t){return e.next(function(e){return t+e})})},t.prototype.Sr=function(t){var e=0;return this.gr(t,function(t){e++}).next(function(){return e})},t.prototype.mn=function(t,e){return this.db.Dr().mn(t,e)},t.prototype.gr=function(t,e){return this.Cr(t,function(t,n){return e(n)})},t.prototype.sr=function(t,e,n){return Ni(t,n)},t.prototype.rr=function(t,e,n){return Ni(t,n)},t.prototype.Zi=function(t,e,n){return this.db.Dr().Zi(t,e,n)},t.prototype.Fi=function(t,e){return Ni(t,e)},t.prototype.Nr=function(t,e){return function(t,e){var n=!1;return di(t)._s(function(r){return hi(t,r,e).next(function(t){return t&&(n=!0),tr.resolve(!t)})}).next(function(){return n})}(t,e)},t.prototype.Vr=function(t,e){var n=this,r=this.db.Or().Fr(),i=[],o=0;return this.Cr(t,function(u,s){if(s<=e){var a=n.Nr(t,u).next(function(e){if(!e)return o++,r.fi(t,u).next(function(){return r._i(u),_i(t).delete([0,dr(u.path)])})});i.push(a)}}).next(function(){return tr.$n(i)}).next(function(){return r.apply(t)}).next(function(){return o})},t.prototype.removeTarget=function(t,e){var n=e.Lt(t.vs);return this.db.Dr().Ji(t,n)},t.prototype.kr=function(t,e){return Ni(t,e)},t.prototype.Cr=function(t,e){var n,r=_i(t),i=V.U;return r.ls({index:Sr.documentTargetsIndex},function(t,r){var o=t[0],u=(t[1],r.path),s=r.sequenceNumber;0===o?(i!==V.U&&e(new z(gr(n)),i),i=s,n=u):i=V.U}).next(function(){i!==V.U&&e(new z(gr(n)),i)})},t.prototype.br=function(t){return this.db.Or().Mr(t)},t}();function Ni(t,e){return _i(t).put(function(t,e){return new Sr(0,dr(t.path),e)}(e,t.vs))}var xi=function(){function t(t,e){this.Kt=t,this.Ti=e}return t.prototype.ui=function(t,e,n){return Di(t).put(ki(e),n)},t.prototype._i=function(t,e){var n=Di(t),r=ki(e);return n.delete(r)},t.prototype.updateMetadata=function(t,e){var n=this;return this.getMetadata(t).next(function(r){return r.byteSize+=e,n.Lr(t,r)})},t.prototype.fi=function(t,e){var n=this;return Di(t).get(ki(e)).next(function(t){return n.$r(t)})},t.prototype.Br=function(t,e){var n=this;return Di(t).get(ki(e)).next(function(t){var e=n.$r(t);return e?{li:e,size:ci(t)}:null})},t.prototype.getEntries=function(t,e){var n=this,r=$e();return this.qr(t,e,function(t,e){var i=n.$r(e);r=r.Ht(t,i)}).next(function(){return r})},t.prototype.Ur=function(t,e){var n=this,r=$e(),i=new Ke(z.J);return this.qr(t,e,function(t,e){var o=n.$r(e);o?(r=r.Ht(t,o),i=i.Ht(t,ci(e))):(r=r.Ht(t,null),i=i.Ht(t,0))}).next(function(){return{Qr:r,Kr:i}})},t.prototype.qr=function(t,e,n){if(e.nt())return tr.resolve();var r=IDBKeyRange.bound(e.first().path.rt(),e.last().path.rt()),i=e.ee(),o=i.ce();return Di(t).ls({range:r},function(t,e,r){for(var u=z.Tt(t);o&&z.J(o,u)<0;)n(o,null),o=i.ce();o&&o.isEqual(u)&&(n(o,e),o=i.ae()?i.ce():null),o?r.rs(o.path.rt()):r.done()}).next(function(){for(;o;)n(o,null),o=i.ae()?i.ce():null})},t.prototype.Wr=function(t,e,n){var r=this,i=tn(),o=e.path.length+1,u={};if(n.isEqual(U.min())){var s=e.path.rt();u.range=IDBKeyRange.lowerBound(s)}else{var a=e.path.rt(),c=zr(n);u.range=IDBKeyRange.lowerBound([a,c],!0),u.index=Nr.collectionReadTimeIndex}return Di(t).ls(u,function(t,n,u){if(t.length===o){var s=Fr(r.Kt,n);e.path.st(s.key.path)?s instanceof wt&&re(e,s)&&(i=i.Ht(s.key,s)):u.done()}}).next(function(){return i})},t.prototype.Fr=function(t){return new Ai(this,!!t&&t.jr)},t.prototype.Mr=function(t){return this.getMetadata(t).next(function(t){return t.byteSize})},t.prototype.getMetadata=function(t){return Si(t).get(xr.key).next(function(t){return l(!!t),t})},t.prototype.Lr=function(t,e){return Si(t).put(xr.key,e)},t.prototype.$r=function(t){if(t){var e=Fr(this.Kt,t);return e instanceof bt&&e.version.isEqual(U.min())?null:e}return null},t}(),Ai=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).Gr=e,r.jr=n,r.zr=new ui(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),r}return(0,i.__extends)(e,t),e.prototype.Ei=function(t){var e=this,n=[],r=0,i=new We(function(t,e){return y(t.ot(),e.ot())});return this.oi.forEach(function(o,u){var s=e.zr.get(o);if(u.li){var a=jr(e.Gr.Kt,u.li,e.ai(o));i=i.add(o.path.Z());var c=ci(a);r+=c-s,n.push(e.Gr.ui(t,o,a))}else if(r-=s,e.jr){var f=jr(e.Gr.Kt,new bt(o,U.min()),e.ai(o));n.push(e.Gr.ui(t,o,f))}else n.push(e.Gr._i(t,o))}),i.forEach(function(r){n.push(e.Gr.Ti.Us(t,r))}),n.push(this.Gr.updateMetadata(t,r)),tr.$n(n)},e.prototype.di=function(t,e){var n=this;return this.Gr.Br(t,e).next(function(t){return null===t?(n.zr.set(e,0),null):(n.zr.set(e,t.size),t.li)})},e.prototype.wi=function(t,e){var n=this;return this.Gr.Ur(t,e).next(function(t){var e=t.Qr;return t.Kr.forEach(function(t,e){n.zr.set(t,e)}),e})},e}(si);function Si(t){return Rr(t,xr.store)}function Di(t){return Rr(t,Nr.store)}function ki(t){return t.path.rt()}var Oi=function(){function t(t){this.Kt=t}return t.prototype.Yn=function(t,e,n,r){var i=this;l(n<r&&n>=0&&r<=11);var o=new er("createOrUpgrade",e);n<1&&r>=1&&(function(t){t.createObjectStore(_r.store)}(t),function(t){t.createObjectStore(wr.store,{keyPath:wr.keyPath}),t.createObjectStore(br.store,{keyPath:br.keyPath,autoIncrement:!0}).createIndex(br.userMutationsIndex,br.userMutationsKeyPath,{unique:!0}),t.createObjectStore(Ir.store)}(t),Li(t),function(t){t.createObjectStore(Nr.store)}(t));var u=tr.resolve();return n<3&&r>=3&&(0!==n&&(function(t){t.deleteObjectStore(Sr.store),t.deleteObjectStore(Ar.store),t.deleteObjectStore(Dr.store)}(t),Li(t)),u=u.next(function(){return t=o.store(Dr.store),e=new Dr(0,0,U.min().G(),0),t.put(Dr.key,e);var t,e})),n<4&&r>=4&&(0!==n&&(u=u.next(function(){return function(t,e){return e.store(br.store).os().next(function(n){t.deleteObjectStore(br.store),t.createObjectStore(br.store,{keyPath:br.keyPath,autoIncrement:!0}).createIndex(br.userMutationsIndex,br.userMutationsKeyPath,{unique:!0});var r=e.store(br.store),i=n.map(function(t){return r.put(t)});return tr.$n(i)})}(t,o)})),u=u.next(function(){!function(t){t.createObjectStore(Or.store,{keyPath:Or.keyPath})}(t)})),n<5&&r>=5&&(u=u.next(function(){return i.Hr(o)})),n<6&&r>=6&&(u=u.next(function(){return function(t){t.createObjectStore(xr.store)}(t),i.Jr(o)})),n<7&&r>=7&&(u=u.next(function(){return i.Yr(o)})),n<8&&r>=8&&(u=u.next(function(){return i.Xr(t,o)})),n<9&&r>=9&&(u=u.next(function(){!function(t){t.objectStoreNames.contains("remoteDocumentChanges")&&t.deleteObjectStore("remoteDocumentChanges")}(t),function(t){var e=t.objectStore(Nr.store);e.createIndex(Nr.readTimeIndex,Nr.readTimeIndexPath,{unique:!1}),e.createIndex(Nr.collectionReadTimeIndex,Nr.collectionReadTimeIndexPath,{unique:!1})}(e)})),n<10&&r>=10&&(u=u.next(function(){return i.Zr(o)})),n<11&&r>=11&&(u=u.next(function(){!function(t){t.createObjectStore(Lr.store,{keyPath:Lr.keyPath})}(t),function(t){t.createObjectStore(Cr.store,{keyPath:Cr.keyPath})}(t)})),u},t.prototype.Jr=function(t){var e=0;return t.store(Nr.store).ls(function(t,n){e+=ci(n)}).next(function(){var n=new xr(e);return t.store(xr.store).put(xr.key,n)})},t.prototype.Hr=function(t){var e=this,n=t.store(wr.store),r=t.store(br.store);return n.os().next(function(n){return tr.forEach(n,function(n){var i=IDBKeyRange.bound([n.userId,-1],[n.userId,n.lastAcknowledgedBatchId]);return r.os(br.userMutationsIndex,i).next(function(r){return tr.forEach(r,function(r){l(r.userId===n.userId);var i=Hr(e.Kt,r);return ai(t,n.userId,i).next(function(){})})})})})},t.prototype.Yr=function(t){var e=t.store(Sr.store),n=t.store(Nr.store);return t.store(Dr.store).get(Dr.key).next(function(t){var r=[];return n.ls(function(n,i){var o=new q(n),u=[0,dr(o)];r.push(e.get(u).next(function(n){return n?tr.resolve():function(n){return e.put(new Sr(0,dr(n),t.highestListenSequenceNumber))}(o)}))}).next(function(){return tr.$n(r)})})},t.prototype.Xr=function(t,e){t.createObjectStore(kr.store,{keyPath:kr.keyPath});var n=e.store(kr.store),r=new ti,i=function(t){if(r.add(t)){var e=t.et(),i=t.Z();return n.put({collectionId:e,parent:dr(i)})}};return e.store(Nr.store).ls({hs:!0},function(t,e){var n=new q(t);return i(n.Z())}).next(function(){return e.store(Ir.store).ls({hs:!0},function(t,e){t[0];var n=t[1],r=(t[2],gr(n));return i(r.Z())})})},t.prototype.Zr=function(t){var e=this,n=t.store(Ar.store);return n.ls(function(t,r){var i=Jr(r),o=Wr(e.Kt,i);return n.put(o)})},t}();function Li(t){t.createObjectStore(Sr.store,{keyPath:Sr.keyPath}).createIndex(Sr.documentTargetsIndex,Sr.documentTargetsKeyPath,{unique:!0}),t.createObjectStore(Ar.store,{keyPath:Ar.keyPath}).createIndex(Ar.queryTargetsIndexName,Ar.queryTargetsKeyPath,{unique:!0}),t.createObjectStore(Dr.store)}var Ci="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",Pi=function(){function t(e,n,r,i,o,u,s,c,f,h){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this.eo=o,this.window=u,this.document=s,this.no=f,this.so=h,this.io=null,this.ro=!1,this.isPrimary=!1,this.networkEnabled=!0,this.oo=null,this.inForeground=!1,this.co=null,this.ao=null,this.uo=Number.NEGATIVE_INFINITY,this.ho=function(t){return Promise.resolve()},!t.Wn())throw new b(w.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.Ii=new Ti(this,i),this.lo=n+"main",this.Kt=new qr(c),this._o=new nr(this.lo,11,new Oi(this.Kt)),this.fo=new yi(this.Ii,this.Kt),this.Ti=new ei,this.wo=function(t,e){return new xi(t,e)}(this.Kt,this.Ti),this.Eo=new Yr,this.window&&this.window.localStorage?this.To=this.window.localStorage:(this.To=null,!1===h&&a("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}return t.prototype.start=function(){var t=this;return this.Io().then(function(){if(!t.isPrimary&&!t.allowTabSynchronization)throw new b(w.FAILED_PRECONDITION,Ci);return t.mo(),t.Ao(),t.Ro(),t.runTransaction("getHighestListenSequenceNumber","readonly",function(e){return t.fo.Wi(e)})}).then(function(e){t.io=new V(e,t.no)}).then(function(){t.ro=!0}).catch(function(e){return t._o&&t._o.close(),Promise.reject(e)})},t.prototype.Po=function(t){var e=this;return this.ho=function(n){return(0,i.__awaiter)(e,void 0,void 0,function(){return(0,i.__generator)(this,function(e){return this.Tr?[2,t(n)]:[2]})})},t(this.isPrimary)},t.prototype.yo=function(t){var e=this;this._o.Zn(function(n){return(0,i.__awaiter)(e,void 0,void 0,function(){return(0,i.__generator)(this,function(e){switch(e.label){case 0:return null===n.newVersion?[4,t()]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}})})})},t.prototype.Vo=function(t){var e=this;this.networkEnabled!==t&&(this.networkEnabled=t,this.eo.ys(function(){return(0,i.__awaiter)(e,void 0,void 0,function(){return(0,i.__generator)(this,function(t){switch(t.label){case 0:return this.Tr?[4,this.Io()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})}))},t.prototype.Io=function(){var t=this;return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",function(e){return Ri(e).put(new Or(t.clientId,Date.now(),t.networkEnabled,t.inForeground)).next(function(){if(t.isPrimary)return t.po(e).next(function(e){e||(t.isPrimary=!1,t.eo.bo(function(){return t.ho(!1)}))})}).next(function(){return t.vo(e)}).next(function(n){return t.isPrimary&&!n?t.So(e).next(function(){return!1}):!!n&&t.Do(e).next(function(){return!0})})}).catch(function(e){if(or(e))return s("IndexedDbPersistence","Failed to extend owner lease: ",e),t.isPrimary;if(!t.allowTabSynchronization)throw e;return s("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(function(e){t.isPrimary!==e&&t.eo.bo(function(){return t.ho(e)}),t.isPrimary=e})},t.prototype.po=function(t){var e=this;return Vi(t).get(_r.key).next(function(t){return tr.resolve(e.Co(t))})},t.prototype.xo=function(t){return Ri(t).delete(this.clientId)},t.prototype.No=function(){return(0,i.__awaiter)(this,void 0,void 0,function(){var t,e,n,r,o=this;return(0,i.__generator)(this,function(i){switch(i.label){case 0:return!this.isPrimary||this.Fo(this.uo,18e5)?[3,2]:(this.uo=Date.now(),[4,this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",function(t){var e=Rr(t,Or.store);return e.os().next(function(t){var n=o.Oo(t,18e5),r=t.filter(function(t){return-1===n.indexOf(t)});return tr.forEach(r,function(t){return e.delete(t.clientId)}).next(function(){return r})})}).catch(function(){return[]})]);case 1:if(t=i.sent(),this.To)for(e=0,n=t;e<n.length;e++)r=n[e],this.To.removeItem(this.ko(r.clientId));i.label=2;case 2:return[2]}})})},t.prototype.Ro=function(){var t=this;this.ao=this.eo.Ir("client_metadata_refresh",4e3,function(){return t.Io().then(function(){return t.No()}).then(function(){return t.Ro()})})},t.prototype.Co=function(t){return!!t&&t.ownerId===this.clientId},t.prototype.vo=function(t){var e=this;return this.so?tr.resolve(!0):Vi(t).get(_r.key).next(function(n){if(null!==n&&e.Fo(n.leaseTimestampMs,5e3)&&!e.Mo(n.ownerId)){if(e.Co(n)&&e.networkEnabled)return!0;if(!e.Co(n)){if(!n.allowTabSynchronization)throw new b(w.FAILED_PRECONDITION,Ci);return!1}}return!(!e.networkEnabled||!e.inForeground)||Ri(t).os().next(function(t){return void 0===e.Oo(t,5e3).find(function(t){if(e.clientId!==t.clientId){var n=!e.networkEnabled&&t.networkEnabled,r=!e.inForeground&&t.inForeground,i=e.networkEnabled===t.networkEnabled;if(n||r&&i)return!0}return!1})})}).next(function(t){return e.isPrimary!==t&&s("IndexedDbPersistence","Client "+(t?"is":"is not")+" eligible for a primary lease."),t})},t.prototype.Lo=function(){return(0,i.__awaiter)(this,void 0,void 0,function(){var t=this;return(0,i.__generator)(this,function(e){switch(e.label){case 0:return this.ro=!1,this.$o(),this.ao&&(this.ao.cancel(),this.ao=null),this.Bo(),this.qo(),[4,this._o.runTransaction("shutdown","readwrite",[_r.store,Or.store],function(e){var n=new Vr(e,V.U);return t.So(n).next(function(){return t.xo(n)})})];case 1:return e.sent(),this._o.close(),this.Uo(),[2]}})})},t.prototype.Oo=function(t,e){var n=this;return t.filter(function(t){return n.Fo(t.updateTimeMs,e)&&!n.Mo(t.clientId)})},t.prototype.Qo=function(){var t=this;return this.runTransaction("getActiveClients","readonly",function(e){return Ri(e).os().next(function(e){return t.Oo(e,18e5).map(function(t){return t.clientId})})})},Object.defineProperty(t.prototype,"Tr",{get:function(){return this.ro},enumerable:!1,configurable:!0}),t.prototype.Ko=function(t){return fi.Ai(t,this.Kt,this.Ti,this.Ii)},t.prototype.Dr=function(){return this.fo},t.prototype.Or=function(){return this.wo},t.prototype.Wo=function(){return this.Ti},t.prototype.jo=function(){return this.Eo},t.prototype.runTransaction=function(t,e,n){var r=this;s("IndexedDbPersistence","Starting transaction:",t);var i,o="readonly"===e?"readonly":"readwrite";return this._o.runTransaction(t,o,Pr,function(o){return i=new Vr(o,r.io?r.io.next():V.U),"readwrite-primary"===e?r.po(i).next(function(t){return!!t||r.vo(i)}).next(function(e){if(!e)throw a("Failed to obtain primary lease for action '"+t+"'."),r.isPrimary=!1,r.eo.bo(function(){return r.ho(!1)}),new b(w.FAILED_PRECONDITION,lr);return n(i)}).next(function(t){return r.Do(i).next(function(){return t})}):r.Go(i).next(function(){return n(i)})}).then(function(t){return i.ps(),t})},t.prototype.Go=function(t){var e=this;return Vi(t).get(_r.key).next(function(t){if(null!==t&&e.Fo(t.leaseTimestampMs,5e3)&&!e.Mo(t.ownerId)&&!e.Co(t)&&!(e.so||e.allowTabSynchronization&&t.allowTabSynchronization))throw new b(w.FAILED_PRECONDITION,Ci)})},t.prototype.Do=function(t){var e=new _r(this.clientId,this.allowTabSynchronization,Date.now());return Vi(t).put(_r.key,e)},t.Wn=function(){return nr.Wn()},t.prototype.So=function(t){var e=this,n=Vi(t);return n.get(_r.key).next(function(t){return e.Co(t)?(s("IndexedDbPersistence","Releasing primary lease."),n.delete(_r.key)):tr.resolve()})},t.prototype.Fo=function(t,e){var n=Date.now();return!(t<n-e||t>n&&(a("Detected an update time that is in the future: "+t+" > "+n),1))},t.prototype.mo=function(){var t=this;null!==this.document&&"function"==typeof this.document.addEventListener&&(this.co=function(){t.eo.ys(function(){return t.inForeground="visible"===t.document.visibilityState,t.Io()})},this.document.addEventListener("visibilitychange",this.co),this.inForeground="visible"===this.document.visibilityState)},t.prototype.Bo=function(){this.co&&(this.document.removeEventListener("visibilitychange",this.co),this.co=null)},t.prototype.Ao=function(){var t,e=this;"function"==typeof(null===(t=this.window)||void 0===t?void 0:t.addEventListener)&&(this.oo=function(){e.$o(),e.eo.ys(function(){return e.Lo()})},this.window.addEventListener("unload",this.oo))},t.prototype.qo=function(){this.oo&&(this.window.removeEventListener("unload",this.oo),this.oo=null)},t.prototype.Mo=function(t){var e;try{var n=null!==(null===(e=this.To)||void 0===e?void 0:e.getItem(this.ko(t)));return s("IndexedDbPersistence","Client '"+t+"' "+(n?"is":"is not")+" zombied in LocalStorage"),n}catch(t){return a("IndexedDbPersistence","Failed to get zombied client id.",t),!1}},t.prototype.$o=function(){if(this.To)try{this.To.setItem(this.ko(this.clientId),String(Date.now()))}catch(t){a("Failed to set zombie client id.",t)}},t.prototype.Uo=function(){if(this.To)try{this.To.removeItem(this.ko(this.clientId))}catch(t){}},t.prototype.ko=function(t){return"firestore_zombie_"+this.persistenceKey+"_"+t},t}();function Vi(t){return Rr(t,_r.store)}function Ri(t){return Rr(t,Or.store)}function Ui(t,e){var n=t.projectId;return t.m||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}var Mi=function(t,e){this.progress=t,this.zo=e},qi=function(){function t(t,e,n){this.wo=t,this.Ho=e,this.Ti=n}return t.prototype.Jo=function(t,e){var n=this;return this.Ho.vi(t,e).next(function(r){return n.Yo(t,e,r)})},t.prototype.Yo=function(t,e,n){return this.wo.fi(t,e).next(function(t){for(var r=0,i=n;r<i.length;r++)t=i[r].xs(e,t);return t})},t.prototype.Xo=function(t,e,n){var r=$e();return e.forEach(function(t,e){for(var i=0,o=n;i<o.length;i++)e=o[i].xs(t,e);r=r.Ht(t,e)}),r},t.prototype.Zo=function(t,e){var n=this;return this.wo.getEntries(t,e).next(function(e){return n.tc(t,e)})},t.prototype.tc=function(t,e){var n=this;return this.Ho.Si(t,e).next(function(r){var i=n.Xo(t,e,r),o=Xe();return i.forEach(function(t,e){e||(e=new bt(t,U.min())),o=o.Ht(t,e)}),o})},t.prototype.Wr=function(t,e,n){return function(t){return z.Et(t.path)&&null===t.collectionGroup&&0===t.filters.length}(e)?this.ec(t,e.path):Yt(e)?this.nc(t,e,n):this.sc(t,e,n)},t.prototype.ec=function(t,e){return this.Jo(t,new z(e)).next(function(t){var e=tn();return t instanceof wt&&(e=e.Ht(t.key,t)),e})},t.prototype.nc=function(t,e,n){var r=this,i=e.collectionGroup,o=tn();return this.Ti.Qs(t,i).next(function(u){return tr.forEach(u,function(u){var s=function(t,e){return new Gt(e,null,t.Nt.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)}(e,u.child(i));return r.sc(t,s,n).next(function(t){t.forEach(function(t,e){o=o.Ht(t,e)})})}).next(function(){return o})})},t.prototype.sc=function(t,e,n){var r,i,o=this;return this.wo.Wr(t,e,n).next(function(n){return r=n,o.Ho.Ci(t,e)}).next(function(e){return i=e,o.ic(t,i,r).next(function(t){r=t;for(var e=0,n=i;e<n.length;e++)for(var o=n[e],u=0,s=o.mutations;u<s.length;u++){var a=s[u],c=a.key,f=Se(a,r.get(c),0,o.Ss);r=f instanceof wt?r.Ht(c,f):r.remove(c)}})}).next(function(){return r.forEach(function(t,n){re(e,n)||(r=r.remove(t))}),r})},t.prototype.ic=function(t,e,n){for(var r=on(),i=0,o=e;i<o.length;i++)for(var u=0,s=o[i].mutations;u<s.length;u++){var a=s[u];a instanceof Ce&&null===n.get(a.key)&&(r=r.add(a.key))}var c=n;return this.wo.getEntries(t,r).next(function(t){return t.forEach(function(t,e){null!==e&&e instanceof wt&&(c=c.Ht(t,e))}),c})},t}(),Fi=function(){function t(t,e,n,r){this.targetId=t,this.fromCache=e,this.rc=n,this.oc=r}return t.cc=function(e,n){for(var r=on(),i=on(),o=0,u=n.docChanges;o<u.length;o++){var s=u[o];switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}}return new t(e,n.fromCache,r,i)},t}(),ji=function(){function t(){}return t.prototype.ac=function(t){this.uc=t},t.prototype.Wr=function(t,n,r,i){var o=this;return function(t){return 0===t.filters.length&&null===t.limit&&null==t.startAt&&null==t.endAt&&(0===t.Nt.length||1===t.Nt.length&&t.Nt[0].field.ht())}(n)||r.isEqual(U.min())?this.hc(t,n):this.uc.Zo(t,i).next(function(a){var c=o.lc(n,a);return(Ht(n)||Jt(n))&&o._c(n.limitType,c,i,r)?o.hc(t,n):(u()<=e.LogLevel.DEBUG&&s("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),ne(n)),o.uc.Wr(t,n,r).next(function(t){return c.forEach(function(e){t=t.Ht(e.key,e)}),t}))})},t.prototype.lc=function(t,e){var n=new We(ie(t));return e.forEach(function(e,r){r instanceof wt&&re(t,r)&&(n=n.add(r))}),n},t.prototype._c=function(t,e,n,r){if(n.size!==e.size)return!0;var i="F"===t?e.last():e.first();return!!i&&(i.hasPendingWrites||i.version.u(r)>0)},t.prototype.hc=function(t,n){return u()<=e.LogLevel.DEBUG&&s("QueryEngine","Using full collection scan to execute query:",ne(n)),this.uc.Wr(t,n,U.min())},t}(),zi=function(){function t(t,e,n,r){this.persistence=t,this.fc=e,this.Kt=r,this.dc=new Ke(y),this.wc=new ui(function(t){return Nt(t)},xt),this.Ec=U.min(),this.Ho=t.Ko(n),this.Tc=t.Or(),this.fo=t.Dr(),this.Ic=new qi(this.Tc,this.Ho,this.persistence.Wo()),this.Eo=t.jo(),this.fc.ac(this.Ic)}return t.prototype.mr=function(t){var e=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",function(n){return t.pr(n,e.dc)})},t}();function Gi(t,e,n,r){return new zi(t,e,n,r)}function Bi(t,e){return(0,i.__awaiter)(this,void 0,void 0,function(){var n,r,o,u;return(0,i.__generator)(this,function(i){switch(i.label){case 0:return n=p(t),r=n.Ho,o=n.Ic,[4,n.persistence.runTransaction("Handle user change","readonly",function(t){var i;return n.Ho.bi(t).next(function(u){return i=u,r=n.persistence.Ko(e),o=new qi(n.Tc,r,n.persistence.Wo()),r.bi(t)}).next(function(e){for(var n=[],r=[],u=on(),s=0,a=i;s<a.length;s++){var c=a[s];n.push(c.batchId);for(var f=0,h=c.mutations;f<h.length;f++){var l=h[f];u=u.add(l.key)}}for(var p=0,d=e;p<d.length;p++){var v=d[p];r.push(v.batchId);for(var y=0,g=v.mutations;y<g.length;y++){var m=g[y];u=u.add(m.key)}}return o.Zo(t,u).next(function(t){return{mc:t,Ac:n,Rc:r}})})})];case 1:return u=i.sent(),[2,(n.Ho=r,n.Ic=o,n.fc.ac(n.Ic),u)]}})})}function Ki(t,e){var n=p(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",function(t){var r=e.batch.keys(),i=n.Tc.Fr({jr:!0});return function(t,e,n,r){var i=n.batch,o=i.keys(),u=tr.resolve();return o.forEach(function(t){u=u.next(function(){return r.fi(e,t)}).next(function(e){var o=e,u=n.Os.get(t);l(null!==u),(!o||o.version.u(u)<0)&&(o=i.Ds(t,o,n))&&r.ui(o,n.Fs)})}),u.next(function(){return t.Ho.xi(e,i)})}(n,t,e,i).next(function(){return i.apply(t)}).next(function(){return n.Ho.Oi(t)}).next(function(){return n.Ic.Zo(t,r)})})}function Hi(t){var e=p(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",function(t){return e.fo.Ki(t)})}function Ji(t,e){var n=p(t),r=e.Mt,i=n.dc;return n.persistence.runTransaction("Apply remote event","readwrite-primary",function(t){var o=n.Tc.Fr({jr:!0});i=n.dc;var u=[];e.Oe.forEach(function(e,o){var s=i.get(o);if(s){u.push(n.fo.ir(t,e.Ke,o).next(function(){return n.fo.nr(t,e.Ue,o)}));var a=e.resumeToken;if(a.o()>0){var c=s.$t(a,r).Lt(t.vs);i=i.Ht(o,c),function(t,e,n){return l(e.resumeToken.o()>0),0===t.resumeToken.o()||e.Mt.j()-t.Mt.j()>=3e8||n.Ue.size+n.Qe.size+n.Ke.size>0}(s,c,e)&&u.push(n.fo.Ji(t,c))}}});var s=Xe();if(e.Me.forEach(function(r,i){e.Le.has(r)&&u.push(n.persistence.Ii.kr(t,r))}),u.push(Wi(t,o,e.Me,r,void 0).next(function(t){s=t})),!r.isEqual(U.min())){var a=n.fo.Ki(t).next(function(e){return n.fo.ji(t,t.vs,r)});u.push(a)}return tr.$n(u).next(function(){return o.apply(t)}).next(function(){return n.Ic.tc(t,s)})}).then(function(t){return n.dc=i,t})}function Wi(t,e,n,r,i){var o=on();return n.forEach(function(t){return o=o.add(t)}),e.getEntries(t,o).next(function(t){var o=Xe();return n.forEach(function(n,u){var a=t.get(n),c=(null==i?void 0:i.get(n))||r;u instanceof bt&&u.version.isEqual(U.min())?(e._i(n,c),o=o.Ht(n,u)):null==a||u.version.u(a.version)>0||0===u.version.u(a.version)&&a.hasPendingWrites?(e.ui(u,c),o=o.Ht(n,u)):s("LocalStore","Ignoring outdated watch update for ",n,". Current version:",a.version," Watch version:",u.version)}),o})}function Qi(t,e){var n=p(t);return n.persistence.runTransaction("Get next mutation batch","readonly",function(t){return void 0===e&&(e=-1),n.Ho.Vi(t,e)})}function Yi(t,e){var n=p(t);return n.persistence.runTransaction("Allocate target","readwrite",function(t){var r;return n.fo.er(t,e).next(function(i){return i?(r=i,tr.resolve(r)):n.fo.qi(t).next(function(i){return r=new ue(e,i,0,t.vs),n.fo.Gi(t,r).next(function(){return r})})})}).then(function(t){var r=n.dc.get(t.targetId);return(null===r||t.Mt.u(r.Mt)>0)&&(n.dc=n.dc.Ht(t.targetId,t),n.wc.set(e,t.targetId)),t})}function Xi(t,e,n){return(0,i.__awaiter)(this,void 0,void 0,function(){var r,o,u,a;return(0,i.__generator)(this,function(i){switch(i.label){case 0:r=p(t),o=r.dc.get(e),u=n?"readwrite":"readwrite-primary",i.label=1;case 1:return i.trys.push([1,4,,5]),n?[3,3]:[4,r.persistence.runTransaction("Release target",u,function(t){return r.persistence.Ii.removeTarget(t,o)})];case 2:i.sent(),i.label=3;case 3:return[3,5];case 4:if(!or(a=i.sent()))throw a;return s("LocalStore","Failed to update sequence numbers for target "+e+": "+a),[3,5];case 5:return r.dc=r.dc.remove(e),r.wc.delete(o.target),[2]}})})}function $i(t,e,n){var r=p(t),i=U.min(),o=on();return r.persistence.runTransaction("Execute query","readonly",function(t){return function(t,e,n){var r=p(t),i=r.wc.get(n);return void 0!==i?tr.resolve(r.dc.get(i)):r.fo.er(e,n)}(r,t,$t(e)).next(function(e){if(e)return i=e.lastLimboFreeSnapshotVersion,r.fo.cr(t,e.targetId).next(function(t){o=t})}).next(function(){return r.fc.Wr(t,e,n?i:U.min(),n?o:on())}).next(function(t){return{documents:t,Pc:o}})})}function Zi(t,e){var n=p(t),r=p(n.fo),i=n.dc.get(e);return i?Promise.resolve(i.target):n.persistence.runTransaction("Get target data","readonly",function(t){return r.Dn(t,e).next(function(t){return t?t.target:null})})}function to(t){var e=p(t);return e.persistence.runTransaction("Get new document changes","readonly",function(t){return function(t,e,n){var r=p(t),i=Xe(),o=zr(n),u=Di(e),s=IDBKeyRange.lowerBound(o,!0);return u.ls({index:Nr.readTimeIndex,range:s},function(t,e){var n=Fr(r.Kt,e);i=i.Ht(n.key,n),o=e.readTime}).next(function(){return{zo:i,readTime:Gr(o)}})}(e.Tc,t,e.Ec)}).then(function(t){var n=t.zo,r=t.readTime;return e.Ec=r,n})}function eo(t){return(0,i.__awaiter)(this,void 0,void 0,function(){var e;return(0,i.__generator)(this,function(n){return[2,(e=p(t)).persistence.runTransaction("Synchronize last document change read time","readonly",function(t){return function(t){var e=Di(t),n=U.min();return e.ls({index:Nr.readTimeIndex,reverse:!0},function(t,e,r){e.readTime&&(n=Gr(e.readTime)),r.done()}).next(function(){return n})}(t)}).then(function(t){e.Ec=t})]})})}function no(t,e,n,r){return(0,i.__awaiter)(this,void 0,void 0,function(){var o,u,s,a,c,f,h,l,d,v;return(0,i.__generator)(this,function(i){switch(i.label){case 0:for(o=p(t),u=on(),s=Xe(),a=nn(),c=0,f=n;c<f.length;c++)h=f[c],l=e.yc(h.metadata.name),h.document&&(u=u.add(l)),s=s.Ht(l,e.gc(h)),a=a.Ht(l,e.Vc(h.metadata.readTime));return d=o.Tc.Fr({jr:!0}),[4,Yi(o,function(t){return $t(Kt(q.ct("__bundle__/docs/"+t)))}(r))];case 1:return v=i.sent(),[2,o.persistence.runTransaction("Apply bundle documents","readwrite",function(t){return Wi(t,d,s,U.min(),a).next(function(e){return d.apply(t),e}).next(function(e){return o.fo.Xi(t,v.targetId).next(function(){return o.fo.nr(t,u,v.targetId)}).next(function(){return o.Ic.tc(t,e)})})})]}})})}function ro(t,e,n){return void 0===n&&(n=on()),(0,i.__awaiter)(this,void 0,void 0,function(){var r,o;return(0,i.__generator)(this,function(i){switch(i.label){case 0:return[4,Yi(t,$t(Qr(e.bundledQuery)))];case 1:return r=i.sent(),[2,(o=p(t)).persistence.runTransaction("Save named query","readwrite",function(t){var i=xn(e.readTime);if(r.Mt.u(i)>=0)return o.Eo.Bs(t,e);var u=r.$t(_.h,i);return o.dc=o.dc.Ht(u.targetId,u),o.fo.Ji(t,u).next(function(){return o.fo.Xi(t,r.targetId)}).next(function(){return o.fo.nr(t,n,r.targetId)}).next(function(){return o.Eo.Bs(t,e)})})]}})})}var io=function(){function t(t){this.Kt=t,this.bc=new Map,this.vc=new Map}return t.prototype.Ms=function(t,e){return tr.resolve(this.bc.get(e))},t.prototype.Ls=function(t,e){var n;return this.bc.set(e.id,{id:(n=e).id,version:n.version,createTime:xn(n.createTime)}),tr.resolve()},t.prototype.$s=function(t,e){return tr.resolve(this.vc.get(e))},t.prototype.Bs=function(t,e){return this.vc.set(e.name,function(t){return{name:t.name,query:Qr(t.bundledQuery),readTime:xn(t.readTime)}}(e)),tr.resolve()},t}(),oo=function(){function t(){this.Sc=new We(uo.Dc),this.Cc=new We(uo.xc)}return t.prototype.nt=function(){return this.Sc.nt()},t.prototype.sr=function(t,e){var n=new uo(t,e);this.Sc=this.Sc.add(n),this.Cc=this.Cc.add(n)},t.prototype.Nc=function(t,e){var n=this;t.forEach(function(t){return n.sr(t,e)})},t.prototype.rr=function(t,e){this.Fc(new uo(t,e))},t.prototype.Oc=function(t,e){var n=this;t.forEach(function(t){return n.rr(t,e)})},t.prototype.kc=function(t){var e=this,n=new z(new q([])),r=new uo(n,t),i=new uo(n,t+1),o=[];return this.Cc.Ae([r,i],function(t){e.Fc(t),o.push(t.key)}),o},t.prototype.Mc=function(){var t=this;this.Sc.forEach(function(e){return t.Fc(e)})},t.prototype.Fc=function(t){this.Sc=this.Sc.delete(t),this.Cc=this.Cc.delete(t)},t.prototype.Lc=function(t){var e=new z(new q([])),n=new uo(e,t),r=new uo(e,t+1),i=on();return this.Cc.Ae([n,r],function(t){i=i.add(t.key)}),i},t.prototype.ki=function(t){var e=new uo(t,0),n=this.Sc.Pe(e);return null!==n&&t.isEqual(n.key)},t}(),uo=function(){function t(t,e){this.key=t,this.$c=e}return t.Dc=function(t,e){return z.J(t.key,e.key)||y(t.$c,e.$c)},t.xc=function(t,e){return y(t.$c,e.$c)||z.J(t.key,e.key)},t}(),so=function(){function t(t,e){this.Ti=t,this.Ii=e,this.Ho=[],this.Bc=1,this.qc=new We(uo.Dc)}return t.prototype.Ri=function(t){return tr.resolve(0===this.Ho.length)},t.prototype.Pi=function(t,e,n,r){var i=this.Bc;this.Bc++,this.Ho.length>0&&this.Ho[this.Ho.length-1];var o=new Ur(i,e,n,r);this.Ho.push(o);for(var u=0,s=r;u<s.length;u++){var a=s[u];this.qc=this.qc.add(new uo(a.key,i)),this.Ti.Us(t,a.key.path.Z())}return tr.resolve(o)},t.prototype.yi=function(t,e){return tr.resolve(this.Uc(e))},t.prototype.Vi=function(t,e){var n=e+1,r=this.Qc(n),i=r<0?0:r;return tr.resolve(this.Ho.length>i?this.Ho[i]:null)},t.prototype.pi=function(){return tr.resolve(0===this.Ho.length?-1:this.Bc-1)},t.prototype.bi=function(t){return tr.resolve(this.Ho.slice())},t.prototype.vi=function(t,e){var n=this,r=new uo(e,0),i=new uo(e,Number.POSITIVE_INFINITY),o=[];return this.qc.Ae([r,i],function(t){var e=n.Uc(t.$c);o.push(e)}),tr.resolve(o)},t.prototype.Si=function(t,e){var n=this,r=new We(y);return e.forEach(function(t){var e=new uo(t,0),i=new uo(t,Number.POSITIVE_INFINITY);n.qc.Ae([e,i],function(t){r=r.add(t.$c)})}),tr.resolve(this.Kc(r))},t.prototype.Ci=function(t,e){var n=e.path,r=n.length+1,i=n;z.Et(i)||(i=i.child(""));var o=new uo(new z(i),0),u=new We(y);return this.qc.Re(function(t){var e=t.key.path;return!!n.st(e)&&(e.length===r&&(u=u.add(t.$c)),!0)},o),tr.resolve(this.Kc(u))},t.prototype.Kc=function(t){var e=this,n=[];return t.forEach(function(t){var r=e.Uc(t);null!==r&&n.push(r)}),n},t.prototype.xi=function(t,e){var n=this;l(0===this.Wc(e.batchId,"removed")),this.Ho.shift();var r=this.qc;return tr.forEach(e.mutations,function(i){var o=new uo(i.key,e.batchId);return r=r.delete(o),n.Ii.Fi(t,i.key)}).next(function(){n.qc=r})},t.prototype.Ni=function(t){},t.prototype.ki=function(t,e){var n=new uo(e,0),r=this.qc.Pe(n);return tr.resolve(e.isEqual(r&&r.key))},t.prototype.Oi=function(t){return this.Ho.length,tr.resolve()},t.prototype.Wc=function(t,e){return this.Qc(t)},t.prototype.Qc=function(t){return 0===this.Ho.length?0:t-this.Ho[0].batchId},t.prototype.Uc=function(t){var e=this.Qc(t);return e<0||e>=this.Ho.length?null:this.Ho[e]},t}(),ao=function(){function t(t,e){this.Ti=t,this.jc=e,this.docs=new Ke(z.J),this.size=0}return t.prototype.ui=function(t,e,n){var r=e.key,i=this.docs.get(r),o=i?i.size:0,u=this.jc(e);return this.docs=this.docs.Ht(r,{li:e,size:u,readTime:n}),this.size+=u-o,this.Ti.Us(t,r.path.Z())},t.prototype._i=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},t.prototype.fi=function(t,e){var n=this.docs.get(e);return tr.resolve(n?n.li:null)},t.prototype.getEntries=function(t,e){var n=this,r=$e();return e.forEach(function(t){var e=n.docs.get(t);r=r.Ht(t,e?e.li:null)}),tr.resolve(r)},t.prototype.Wr=function(t,e,n){for(var r=tn(),i=new z(e.path.child("")),o=this.docs.ne(i);o.ae();){var u=o.ce(),s=u.key,a=u.value,c=a.li,f=a.readTime;if(!e.path.st(s.path))break;f.u(n)<=0||c instanceof wt&&re(e,c)&&(r=r.Ht(c.key,c))}return tr.resolve(r)},t.prototype.Gc=function(t,e){return tr.forEach(this.docs,function(t){return e(t)})},t.prototype.Fr=function(t){return new co(this)},t.prototype.Mr=function(t){return tr.resolve(this.size)},t}(),co=function(t){function e(e){var n=this;return(n=t.call(this)||this).Gr=e,n}return(0,i.__extends)(e,t),e.prototype.Ei=function(t){var e=this,n=[];return this.oi.forEach(function(r,i){i&&i.li?n.push(e.Gr.ui(t,i.li,e.ai(r))):e.Gr._i(r)}),tr.$n(n)},e.prototype.di=function(t,e){return this.Gr.fi(t,e)},e.prototype.wi=function(t,e){return this.Gr.getEntries(t,e)},e}(si),fo=function(){function t(t){this.persistence=t,this.zc=new ui(function(t){return Nt(t)},xt),this.lastRemoteSnapshotVersion=U.min(),this.highestTargetId=0,this.Hc=0,this.Jc=new oo,this.targetCount=0,this.Yc=vi.$i()}return t.prototype.mn=function(t,e){return this.zc.forEach(function(t,n){return e(n)}),tr.resolve()},t.prototype.Ki=function(t){return tr.resolve(this.lastRemoteSnapshotVersion)},t.prototype.Wi=function(t){return tr.resolve(this.Hc)},t.prototype.qi=function(t){return this.highestTargetId=this.Yc.next(),tr.resolve(this.highestTargetId)},t.prototype.ji=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.Hc&&(this.Hc=e),tr.resolve()},t.prototype.zi=function(t){this.zc.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.Yc=new vi(e),this.highestTargetId=e),t.sequenceNumber>this.Hc&&(this.Hc=t.sequenceNumber)},t.prototype.Gi=function(t,e){return this.zi(e),this.targetCount+=1,tr.resolve()},t.prototype.Ji=function(t,e){return this.zi(e),tr.resolve()},t.prototype.Yi=function(t,e){return this.zc.delete(e.target),this.Jc.kc(e.targetId),this.targetCount-=1,tr.resolve()},t.prototype.Zi=function(t,e,n){var r=this,i=0,o=[];return this.zc.forEach(function(u,s){s.sequenceNumber<=e&&null===n.get(s.targetId)&&(r.zc.delete(u),o.push(r.Xi(t,s.targetId)),i++)}),tr.$n(o).next(function(){return i})},t.prototype.tr=function(t){return tr.resolve(this.targetCount)},t.prototype.er=function(t,e){var n=this.zc.get(e)||null;return tr.resolve(n)},t.prototype.nr=function(t,e,n){return this.Jc.Nc(e,n),tr.resolve()},t.prototype.ir=function(t,e,n){this.Jc.Oc(e,n);var r=this.persistence.Ii,i=[];return r&&e.forEach(function(e){i.push(r.Fi(t,e))}),tr.$n(i)},t.prototype.Xi=function(t,e){return this.Jc.kc(e),tr.resolve()},t.prototype.cr=function(t,e){var n=this.Jc.Lc(e);return tr.resolve(n)},t.prototype.ki=function(t,e){return tr.resolve(this.Jc.ki(e))},t}(),ho=function(){function t(t,e){var n=this;this.Xc={},this.io=new V(0),this.ro=!1,this.ro=!0,this.Ii=t(this),this.fo=new fo(this),this.Ti=new Zr,this.wo=function(t,e){return new ao(t,function(t){return n.Ii.Zc(t)})}(this.Ti),this.Kt=new qr(e),this.Eo=new io(this.Kt)}return t.prototype.start=function(){return Promise.resolve()},t.prototype.Lo=function(){return this.ro=!1,Promise.resolve()},Object.defineProperty(t.prototype,"Tr",{get:function(){return this.ro},enumerable:!1,configurable:!0}),t.prototype.yo=function(){},t.prototype.Vo=function(){},t.prototype.Wo=function(){return this.Ti},t.prototype.Ko=function(t){var e=this.Xc[t.R()];return e||(e=new so(this.Ti,this.Ii),this.Xc[t.R()]=e),e},t.prototype.Dr=function(){return this.fo},t.prototype.Or=function(){return this.wo},t.prototype.jo=function(){return this.Eo},t.prototype.runTransaction=function(t,e,n){var r=this;s("MemoryPersistence","Starting transaction:",t);var i=new lo(this.io.next());return this.Ii.ta(),n(i).next(function(t){return r.Ii.ea(i).next(function(){return t})}).Mn().then(function(t){return i.ps(),t})},t.prototype.na=function(t,e){return tr.Bn(Object.values(this.Xc).map(function(n){return function(){return n.ki(t,e)}}))},t}(),lo=function(t){function e(e){var n=this;return(n=t.call(this)||this).vs=e,n}return(0,i.__extends)(e,t),e}(pr),po=function(){function t(t){this.persistence=t,this.sa=new oo,this.ia=null}return t.ra=function(e){return new t(e)},Object.defineProperty(t.prototype,"oa",{get:function(){if(this.ia)return this.ia;throw h()},enumerable:!1,configurable:!0}),t.prototype.sr=function(t,e,n){return this.sa.sr(n,e),this.oa.delete(n.toString()),tr.resolve()},t.prototype.rr=function(t,e,n){return this.sa.rr(n,e),this.oa.add(n.toString()),tr.resolve()},t.prototype.Fi=function(t,e){return this.oa.add(e.toString()),tr.resolve()},t.prototype.removeTarget=function(t,e){var n=this;this.sa.kc(e.targetId).forEach(function(t){return n.oa.add(t.toString())});var r=this.persistence.Dr();return r.cr(t,e.targetId).next(function(t){t.forEach(function(t){return n.oa.add(t.toString())})}).next(function(){return r.Yi(t,e)})},t.prototype.ta=function(){this.ia=new Set},t.prototype.ea=function(t){var e=this,n=this.persistence.Or().Fr();return tr.forEach(this.oa,function(r){var i=z.ft(r);return e.ca(t,i).next(function(t){t||n._i(i)})}).next(function(){return e.ia=null,n.apply(t)})},t.prototype.kr=function(t,e){var n=this;return this.ca(t,e).next(function(t){t?n.oa.delete(e.toString()):n.oa.add(e.toString())})},t.prototype.Zc=function(t){return 0},t.prototype.ca=function(t,e){var n=this;return tr.Bn([function(){return tr.resolve(n.sa.ki(e))},function(){return n.persistence.Dr().ki(t,e)},function(){return n.persistence.na(t,e)}])},t}();function vo(t,e){return"firestore_clients_"+t+"_"+e}function yo(t,e,n){var r="firestore_mutations_"+t+"_"+n;return e.A()&&(r+="_"+e.uid),r}function go(t,e){return"firestore_targets_"+t+"_"+e}var mo=function(){function t(t,e,n,r){this.user=t,this.batchId=e,this.state=n,this.error=r}return t.aa=function(e,n,r){var i=JSON.parse(r),o="object"==typeof i&&-1!==["pending","acknowledged","rejected"].indexOf(i.state)&&(void 0===i.error||"object"==typeof i.error),u=void 0;return o&&i.error&&(o="string"==typeof i.error.message&&"string"==typeof i.error.code)&&(u=new b(i.error.code,i.error.message)),o?new t(e,n,i.state,u):(a("SharedClientState","Failed to parse mutation state for ID '"+n+"': "+r),null)},t.prototype.ua=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},t}(),_o=function(){function t(t,e,n){this.targetId=t,this.state=e,this.error=n}return t.aa=function(e,n){var r=JSON.parse(n),i="object"==typeof r&&-1!==["not-current","current","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error),o=void 0;return i&&r.error&&(i="string"==typeof r.error.message&&"string"==typeof r.error.code)&&(o=new b(r.error.code,r.error.message)),i?new t(e,r.state,o):(a("SharedClientState","Failed to parse target state for ID '"+e+"': "+n),null)},t.prototype.ua=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},t}(),wo=function(){function t(t,e){this.clientId=t,this.activeTargetIds=e}return t.aa=function(e,n){for(var r=JSON.parse(n),i="object"==typeof r&&r.activeTargetIds instanceof Array,o=sn(),u=0;i&&u<r.activeTargetIds.length;++u)i=nt(r.activeTargetIds[u]),o=o.add(r.activeTargetIds[u]);return i?new t(e,o):(a("SharedClientState","Failed to parse client data for instance '"+e+"': "+n),null)},t}(),bo=function(){function t(t,e){this.clientId=t,this.onlineState=e}return t.aa=function(e){var n=JSON.parse(e);return"object"==typeof n&&-1!==["Unknown","Online","Offline"].indexOf(n.onlineState)&&"string"==typeof n.clientId?new t(n.clientId,n.onlineState):(a("SharedClientState","Failed to parse online state: "+e),null)},t}(),Io=function(){function t(){this.activeTargetIds=sn()}return t.prototype.ha=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},t.prototype.la=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},t.prototype.ua=function(){var t={activeTargetIds:this.activeTargetIds.rt(),updateTimeMs:Date.now()};return JSON.stringify(t)},t}(),Eo=function(){function t(t,e,n,r,i){this.window=t,this.eo=e,this.persistenceKey=n,this._a=r,this.fa=null,this.da=null,this.L=null,this.wa=this.Ea.bind(this),this.Ta=new Ke(y),this.Tr=!1,this.Ia=[];var o=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=i,this.ma=vo(this.persistenceKey,this._a),this.Aa=function(t){return"firestore_sequence_number_"+t}(this.persistenceKey),this.Ta=this.Ta.Ht(this._a,new Io),this.Ra=new RegExp("^firestore_clients_"+o+"_([^_]*)$"),this.Pa=new RegExp("^firestore_mutations_"+o+"_(\\d+)(?:_(.*))?$"),this.ya=new RegExp("^firestore_targets_"+o+"_(\\d+)$"),this.ga=function(t){return"firestore_online_state_"+t}(this.persistenceKey),this.Va=function(t){return"firestore_bundle_loaded_"+t}(this.persistenceKey),this.window.addEventListener("storage",this.wa)}return t.Wn=function(t){return!(!t||!t.localStorage)},t.prototype.start=function(){return(0,i.__awaiter)(this,void 0,void 0,function(){var t,e,n,r,o,u,s,a,c,f,h,l=this;return(0,i.__generator)(this,function(i){switch(i.label){case 0:return[4,this.fa.Qo()];case 1:for(t=i.sent(),e=0,n=t;e<n.length;e++)(r=n[e])!==this._a&&(o=this.getItem(vo(this.persistenceKey,r)))&&(u=wo.aa(r,o))&&(this.Ta=this.Ta.Ht(u.clientId,u));for(this.pa(),(s=this.storage.getItem(this.ga))&&(a=this.ba(s))&&this.va(a),c=0,f=this.Ia;c<f.length;c++)h=f[c],this.Ea(h);return this.Ia=[],this.window.addEventListener("unload",function(){return l.Lo()}),this.Tr=!0,[2]}})})},t.prototype.q=function(t){this.setItem(this.Aa,JSON.stringify(t))},t.prototype.Sa=function(){return this.Da(this.Ta)},t.prototype.Ca=function(t){var e=!1;return this.Ta.forEach(function(n,r){r.activeTargetIds.has(t)&&(e=!0)}),e},t.prototype.xa=function(t){this.Na(t,"pending")},t.prototype.Fa=function(t,e,n){this.Na(t,e,n),this.Oa(t)},t.prototype.ka=function(t){var e="not-current";if(this.Ca(t)){var n=this.storage.getItem(go(this.persistenceKey,t));if(n){var r=_o.aa(t,n);r&&(e=r.state)}}return this.Ma.ha(t),this.pa(),e},t.prototype.La=function(t){this.Ma.la(t),this.pa()},t.prototype.$a=function(t){return this.Ma.activeTargetIds.has(t)},t.prototype.Ba=function(t){this.removeItem(go(this.persistenceKey,t))},t.prototype.qa=function(t,e,n){this.Ua(t,e,n)},t.prototype.Qa=function(t,e,n){var r=this;e.forEach(function(t){r.Oa(t)}),this.currentUser=t,n.forEach(function(t){r.xa(t)})},t.prototype.Ka=function(t){this.Wa(t)},t.prototype.ja=function(){this.Ga()},t.prototype.Lo=function(){this.Tr&&(this.window.removeEventListener("storage",this.wa),this.removeItem(this.ma),this.Tr=!1)},t.prototype.getItem=function(t){var e=this.storage.getItem(t);return s("SharedClientState","READ",t,e),e},t.prototype.setItem=function(t,e){s("SharedClientState","SET",t,e),this.storage.setItem(t,e)},t.prototype.removeItem=function(t){s("SharedClientState","REMOVE",t),this.storage.removeItem(t)},t.prototype.Ea=function(t){var e=this,n=t;if(n.storageArea===this.storage){if(s("SharedClientState","EVENT",n.key,n.newValue),n.key===this.ma)return void a("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.eo.bo(function(){return(0,i.__awaiter)(e,void 0,void 0,function(){var t,e,r,o,u,s;return(0,i.__generator)(this,function(i){if(this.Tr){if(null!==n.key)if(this.Ra.test(n.key)){if(null==n.newValue)return t=this.za(n.key),[2,this.Ha(t,null)];if(e=this.Ja(n.key,n.newValue))return[2,this.Ha(e.clientId,e)]}else if(this.Pa.test(n.key)){if(null!==n.newValue&&(r=this.Ya(n.key,n.newValue)))return[2,this.Xa(r)]}else if(this.ya.test(n.key)){if(null!==n.newValue&&(o=this.Za(n.key,n.newValue)))return[2,this.tu(o)]}else if(n.key===this.ga){if(null!==n.newValue&&(u=this.ba(n.newValue)))return[2,this.va(u)]}else if(n.key===this.Aa)(s=function(t){var e=V.U;if(null!=t)try{var n=JSON.parse(t);l("number"==typeof n),e=n}catch(t){a("SharedClientState","Failed to read sequence number from WebStorage",t)}return e}(n.newValue))!==V.U&&this.L(s);else if(n.key===this.Va)return[2,this.fa.eu()]}else this.Ia.push(n);return[2]})})})}},Object.defineProperty(t.prototype,"Ma",{get:function(){return this.Ta.get(this._a)},enumerable:!1,configurable:!0}),t.prototype.pa=function(){this.setItem(this.ma,this.Ma.ua())},t.prototype.Na=function(t,e,n){var r=new mo(this.currentUser,t,e,n),i=yo(this.persistenceKey,this.currentUser,t);this.setItem(i,r.ua())},t.prototype.Oa=function(t){var e=yo(this.persistenceKey,this.currentUser,t);this.removeItem(e)},t.prototype.Wa=function(t){var e={clientId:this._a,onlineState:t};this.storage.setItem(this.ga,JSON.stringify(e))},t.prototype.Ua=function(t,e,n){var r=go(this.persistenceKey,t),i=new _o(t,e,n);this.setItem(r,i.ua())},t.prototype.Ga=function(){this.setItem(this.Va,"value-not-used")},t.prototype.za=function(t){var e=this.Ra.exec(t);return e?e[1]:null},t.prototype.Ja=function(t,e){var n=this.za(t);return wo.aa(n,e)},t.prototype.Ya=function(t,e){var n=this.Pa.exec(t),r=Number(n[1]),i=void 0!==n[2]?n[2]:null;return mo.aa(new D(i),r,e)},t.prototype.Za=function(t,e){var n=this.ya.exec(t),r=Number(n[1]);return _o.aa(r,e)},t.prototype.ba=function(t){return bo.aa(t)},t.prototype.Xa=function(t){return(0,i.__awaiter)(this,void 0,void 0,function(){return(0,i.__generator)(this,function(e){return t.user.uid===this.currentUser.uid?[2,this.fa.nu(t.batchId,t.state,t.error)]:(s("SharedClientState","Ignoring mutation for non-active user "+t.user.uid),[2])})})},t.prototype.tu=function(t){return this.fa.su(t.targetId,t.state,t.error)},t.prototype.Ha=function(t,e){var n=this,r=e?this.Ta.Ht(t,e):this.Ta.remove(t),i=this.Da(this.Ta),o=this.Da(r),u=[],s=[];return o.forEach(function(t){i.has(t)||u.push(t)}),i.forEach(function(t){o.has(t)||s.push(t)}),this.fa.iu(u,s).then(function(){n.Ta=r})},t.prototype.va=function(t){this.Ta.get(t.clientId)&&this.da(t.onlineState)},t.prototype.Da=function(t){var e=sn();return t.forEach(function(t,n){e=e.ye(n.activeTargetIds)}),e},t}(),To=function(){function t(){this.ru=new Io,this.ou={},this.da=null,this.L=null}return t.prototype.xa=function(t){},t.prototype.Fa=function(t,e,n){},t.prototype.ka=function(t){return this.ru.ha(t),this.ou[t]||"not-current"},t.prototype.qa=function(t,e,n){this.ou[t]=e},t.prototype.La=function(t){this.ru.la(t)},t.prototype.$a=function(t){return this.ru.activeTargetIds.has(t)},t.prototype.Ba=function(t){delete this.ou[t]},t.prototype.Sa=function(){return this.ru.activeTargetIds},t.prototype.Ca=function(t){return this.ru.activeTargetIds.has(t)},t.prototype.start=function(){return this.ru=new Io,Promise.resolve()},t.prototype.Qa=function(t,e,n){},t.prototype.Ka=function(t){},t.prototype.Lo=function(){},t.prototype.q=function(t){},t.prototype.ja=function(){},t}(),No=function(){function t(){}return t.prototype.cu=function(t){},t.prototype.Lo=function(){},t}(),xo=function(){function t(){var t=this;this.au=function(){return t.uu()},this.hu=function(){return t.lu()},this._u=[],this.fu()}return t.prototype.cu=function(t){this._u.push(t)},t.prototype.Lo=function(){window.removeEventListener("online",this.au),window.removeEventListener("offline",this.hu)},t.prototype.fu=function(){window.addEventListener("online",this.au),window.addEventListener("offline",this.hu)},t.prototype.uu=function(){s("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this._u;t<e.length;t++)(0,e[t])(0)},t.prototype.lu=function(){s("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this._u;t<e.length;t++)(0,e[t])(1)},t.Wn=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},t}(),Ao={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},So=function(){function t(t){this.du=t.du,this.wu=t.wu}return t.prototype.Eu=function(t){this.Tu=t},t.prototype.Iu=function(t){this.mu=t},t.prototype.onMessage=function(t){this.Au=t},t.prototype.close=function(){this.wu()},t.prototype.send=function(t){this.du(t)},t.prototype.Ru=function(){this.Tu()},t.prototype.Pu=function(t){this.mu(t)},t.prototype.yu=function(t){this.Au(t)},t}(),Do=function(t){function e(e){var n=this;return(n=t.call(this,e)||this).forceLongPolling=e.forceLongPolling,n.I=e.I,n}return(0,i.__extends)(e,t),e.prototype.Du=function(t,e,n,i){return new Promise(function(o,u){var a=new r.XhrIo;a.listenOnce(r.EventType.COMPLETE,function(){try{switch(a.getLastErrorCode()){case r.ErrorCode.NO_ERROR:var e=a.getResponseJson();s("Connection","XHR received:",JSON.stringify(e)),o(e);break;case r.ErrorCode.TIMEOUT:s("Connection",'RPC "'+t+'" timed out'),u(new b(w.DEADLINE_EXCEEDED,"Request time out"));break;case r.ErrorCode.HTTP_ERROR:var n=a.getStatus();if(s("Connection",'RPC "'+t+'" failed with status:',n,"response text:",a.getResponseText()),n>0){var i=a.getResponseJson().error;if(i&&i.status&&i.message){var c=function(t){var e=i.status.toLowerCase().replace(/_/g,"-");return Object.values(w).indexOf(e)>=0?e:w.UNKNOWN}();u(new b(c,i.message))}else u(new b(w.UNKNOWN,"Server responded with status "+a.getStatus()))}else u(new b(w.UNAVAILABLE,"Connection failed."));break;default:h()}}finally{s("Connection",'RPC "'+t+'" completed.')}});var c=JSON.stringify(i);a.send(e,"POST",c,n,15)})},e.prototype.xu=function(t,e){var i=[this.Vu,"/","google.firestore.v1.Firestore","/",t,"/channel"],o=(0,r.createWebChannelTransport)(),u=(0,r.getStatEventTarget)(),a={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.T.projectId+"/databases/"+this.T.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.I};this.Su(a.initMessageHeaders,e),(0,n.isMobileCordova)()||(0,n.isReactNative)()||(0,n.isElectron)()||(0,n.isIE)()||(0,n.isUWP)()||(0,n.isBrowserExtension)()||(a.httpHeadersOverwriteParam="$httpHeaders");var f=i.join("");s("Connection","Creating WebChannel: "+f,a);var h=o.createWebChannel(f,a),p=!1,d=!1,v=new So({du:function(t){d?s("Connection","Not sending because WebChannel is closed:",t):(p||(s("Connection","Opening WebChannel transport."),h.open(),p=!0),s("Connection","WebChannel sending:",t),h.send(t))},wu:function(){return h.close()}}),y=function(t,e,n){t.listen(e,function(t){try{n(t)}catch(t){setTimeout(function(){throw t},0)}})};return y(h,r.WebChannel.EventType.OPEN,function(){d||s("Connection","WebChannel transport opened.")}),y(h,r.WebChannel.EventType.CLOSE,function(){d||(d=!0,s("Connection","WebChannel transport closed"),v.Pu())}),y(h,r.WebChannel.EventType.ERROR,function(t){d||(d=!0,c("Connection","WebChannel transport errored:",t),v.Pu(new b(w.UNAVAILABLE,"The operation could not be completed")))}),y(h,r.WebChannel.EventType.MESSAGE,function(t){var e;if(!d){var n=t.data[0];l(!!n);var r=n,i=r.error||(null===(e=r[0])||void 0===e?void 0:e.error);if(i){s("Connection","WebChannel received error:",i);var o=i.status,u=function(t){var e=Me[o];if(void 0!==e)return Be(e)}(),a=i.message;void 0===u&&(u=w.INTERNAL,a="Unknown error status: "+o+" with message "+i.message),d=!0,v.Pu(new b(u,a)),h.close()}else s("Connection","WebChannel received:",n),v.yu(n)}}),y(u,r.Event.STAT_EVENT,function(t){t.stat===r.Stat.PROXY?s("Connection","Detected buffering proxy"):t.stat===r.Stat.NOPROXY&&s("Connection","Detected no buffering proxy")}),setTimeout(function(){v.Ru()},0),v},e}(function(){function t(t){this.gu=t,this.T=t.T;var e=t.ssl?"https":"http";this.Vu=e+"://"+t.host,this.pu="projects/"+this.T.projectId+"/databases/"+this.T.database+"/documents"}return t.prototype.bu=function(t,e,n,r){var i=this.vu(t,e);s("RestConnection","Sending: ",i,n);var o={};return this.Su(o,r),this.Du(t,i,o,n).then(function(t){return s("RestConnection","Received: ",t),t},function(e){throw c("RestConnection",t+" failed with error: ",e,"url: ",i,"request:",n),e})},t.prototype.Cu=function(t,e,n,r){return this.bu(t,e,n,r)},t.prototype.Su=function(t,e){if(t["X-Goog-Api-Client"]="gl-js/ fire/8.2.5",t["Content-Type"]="text/plain",e)for(var n in e.V)e.V.hasOwnProperty(n)&&(t[n]=e.V[n])},t.prototype.vu=function(t,e){var n=Ao[t];return this.Vu+"/v1/"+e+":"+n},t}());function ko(){return"undefined"!=typeof window?window:null}function Oo(){return"undefined"!=typeof document?document:null}function Lo(t){return new In(t,!0)}var Co=function(){function t(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this.eo=t,this.ds=e,this.Nu=n,this.Fu=r,this.Ou=i,this.ku=0,this.Mu=null,this.Lu=Date.now(),this.reset()}return t.prototype.reset=function(){this.ku=0},t.prototype.$u=function(){this.ku=this.Ou},t.prototype.Bu=function(t){var e=this;this.cancel();var n=Math.floor(this.ku+this.qu()),r=Math.max(0,Date.now()-this.Lu),i=Math.max(0,n-r);i>0&&s("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.ku+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.Mu=this.eo.Ir(this.ds,i,function(){return e.Lu=Date.now(),t()}),this.ku*=this.Fu,this.ku<this.Nu&&(this.ku=this.Nu),this.ku>this.Ou&&(this.ku=this.Ou)},t.prototype.Uu=function(){null!==this.Mu&&(this.Mu.Ps(),this.Mu=null)},t.prototype.cancel=function(){null!==this.Mu&&(this.Mu.cancel(),this.Mu=null)},t.prototype.qu=function(){return(Math.random()-.5)*this.ku},t}(),Po=function(){function t(t,e,n,r,i,o){this.eo=t,this.Qu=n,this.Ku=r,this.Wu=i,this.listener=o,this.state=0,this.ju=0,this.Gu=null,this.stream=null,this.zu=new Co(t,e)}return t.prototype.Hu=function(){return 1===this.state||2===this.state||4===this.state},t.prototype.Ju=function(){return 2===this.state},t.prototype.start=function(){3!==this.state?this.auth():this.Yu()},t.prototype.stop=function(){return(0,i.__awaiter)(this,void 0,void 0,function(){return(0,i.__generator)(this,function(t){switch(t.label){case 0:return this.Hu()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},t.prototype.Xu=function(){this.state=0,this.zu.reset()},t.prototype.Zu=function(){var t=this;this.Ju()&&null===this.Gu&&(this.Gu=this.eo.Ir(this.Qu,6e4,function(){return t.th()}))},t.prototype.eh=function(t){this.nh(),this.stream.send(t)},t.prototype.th=function(){return(0,i.__awaiter)(this,void 0,void 0,function(){return(0,i.__generator)(this,function(t){return this.Ju()?[2,this.close(0)]:[2]})})},t.prototype.nh=function(){this.Gu&&(this.Gu.cancel(),this.Gu=null)},t.prototype.close=function(t,e){return(0,i.__awaiter)(this,void 0,void 0,function(){return(0,i.__generator)(this,function(n){switch(n.label){case 0:return this.nh(),this.zu.cancel(),this.ju++,3!==t?this.zu.reset():e&&e.code===w.RESOURCE_EXHAUSTED?(a(e.toString()),a("Using maximum backoff delay to prevent overloading the backend."),this.zu.$u()):e&&e.code===w.UNAUTHENTICATED&&this.Wu.v(),null!==this.stream&&(this.sh(),this.stream.close(),this.stream=null),this.state=t,[4,this.listener.Iu(e)];case 1:return n.sent(),[2]}})})},t.prototype.sh=function(){},t.prototype.auth=function(){var t=this;this.state=1;var e=this.ih(this.ju),n=this.ju;this.Wu.getToken().then(function(e){t.ju===n&&t.rh(e)},function(n){e(function(){var e=new b(w.UNKNOWN,"Fetching auth token failed: "+n.message);return t.oh(e)})})},t.prototype.rh=function(t){var e=this,n=this.ih(this.ju);this.stream=this.ah(t),this.stream.Eu(function(){n(function(){return e.state=2,e.listener.Eu()})}),this.stream.Iu(function(t){n(function(){return e.oh(t)})}),this.stream.onMessage(function(t){n(function(){return e.onMessage(t)})})},t.prototype.Yu=function(){var t=this;this.state=4,this.zu.Bu(function(){return(0,i.__awaiter)(t,void 0,void 0,function(){return(0,i.__generator)(this,function(t){return this.state=0,this.start(),[2]})})})},t.prototype.oh=function(t){return s("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},t.prototype.ih=function(t){var e=this;return function(n){e.eo.ys(function(){return e.ju===t?n():(s("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}},t}(),Vo=function(t){function e(e,n,r,i,o){var u=this;return(u=t.call(this,e,"listen_stream_connection_backoff","listen_stream_idle",n,r,o)||this).Kt=i,u}return(0,i.__extends)(e,t),e.prototype.ah=function(t){return this.Ku.xu("Listen",t)},e.prototype.onMessage=function(t){this.zu.reset();var e=function(t,e){var n;if("targetChange"in e){e.targetChange;var r=function(t){return"NO_CHANGE"===t?0:"ADD"===t?1:"REMOVE"===t?2:"CURRENT"===t?3:"RESET"===t?4:h()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],o=function(t,e){return t.qt?(l(void 0===e||"string"==typeof e),_.fromBase64String(e||"")):(l(void 0===e||e instanceof Uint8Array),_.fromUint8Array(e||new Uint8Array))}(t,e.targetChange.resumeToken),u=(s=e.targetChange.cause)&&function(t){var e=void 0===t.code?w.UNKNOWN:Be(t.code);return new b(e,t.message||"")}(s);n=new vn(r,i,o,u||null)}else if("documentChange"in e){e.documentChange,(r=e.documentChange).document,r.document.name,r.document.updateTime,i=kn(t,r.document.name),o=xn(r.document.updateTime);var s=new yt({mapValue:{fields:r.document.fields}}),a=(u=new wt(i,o,s,{}),r.targetIds||[]),c=r.removedTargetIds||[];n=new pn(a,c,u.key,u)}else if("documentDelete"in e)e.documentDelete,(r=e.documentDelete).document,i=kn(t,r.document),o=r.readTime?xn(r.readTime):U.min(),s=new bt(i,o),u=r.removedTargetIds||[],n=new pn([],u,s.key,s);else if("documentRemove"in e)e.documentRemove,(r=e.documentRemove).document,i=kn(t,r.document),o=r.removedTargetIds||[],n=new pn([],o,i,null);else{if(!("filter"in e))return h();e.filter;var f=e.filter;f.targetId,r=f.count||0,i=new ze(r),o=f.targetId,n=new dn(o,i)}return n}(this.Kt,t),n=function(t){if(!("targetChange"in t))return U.min();var e=t.targetChange;return e.targetIds&&e.targetIds.length?U.min():e.readTime?xn(e.readTime):U.min()}(t);return this.listener.uh(e,n)},e.prototype.hh=function(t){var e={};e.database=Cn(this.Kt),e.addTarget=function(t,e){var n,r=e.target;return(n=At(r)?{documents:qn(t,r)}:{query:Fn(t,r)}).targetId=e.targetId,e.resumeToken.o()>0?n.resumeToken=Tn(t,e.resumeToken):e.Mt.u(U.min())>0&&(n.readTime=En(t,e.Mt.G())),n}(this.Kt,t);var n=function(t,e){var n=function(t,e){switch(e){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return h()}}(0,e.kt);return null==n?null:{"goog-listen-tags":n}}(this.Kt,t);n&&(e.labels=n),this.eh(e)},e.prototype.lh=function(t){var e={};e.database=Cn(this.Kt),e.removeTarget=t,this.eh(e)},e}(Po),Ro=function(t){function e(e,n,r,i,o){var u=this;return(u=t.call(this,e,"write_stream_connection_backoff","write_stream_idle",n,r,o)||this).Kt=i,u._h=!1,u}return(0,i.__extends)(e,t),Object.defineProperty(e.prototype,"fh",{get:function(){return this._h},enumerable:!1,configurable:!0}),e.prototype.start=function(){this._h=!1,this.lastStreamToken=void 0,t.prototype.start.call(this)},e.prototype.sh=function(){this._h&&this.dh([])},e.prototype.ah=function(t){return this.Ku.xu("Write",t)},e.prototype.onMessage=function(t){if(l(!!t.streamToken),this.lastStreamToken=t.streamToken,this._h){this.zu.reset();var e=function(t,e){return t&&t.length>0?(l(void 0!==e),t.map(function(t){return function(t,e){var n=t.updateTime?xn(t.updateTime):xn(e);n.isEqual(U.min())&&(n=xn(e));var r=null;return t.transformResults&&t.transformResults.length>0&&(r=t.transformResults),new Ee(n,r)}(t,e)})):[]}(t.writeResults,t.commitTime),n=xn(t.commitTime);return this.listener.wh(n,e)}return l(!t.writeResults||0===t.writeResults.length),this._h=!0,this.listener.Eh()},e.prototype.Th=function(){var t={};t.database=Cn(this.Kt),this.eh(t)},e.prototype.dh=function(t){var e=this,n={streamToken:this.lastStreamToken,writes:t.map(function(t){return Un(e.Kt,t)})};this.eh(n)},e}(Po),Uo=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).credentials=e,i.Ku=n,i.Kt=r,i.Ih=!1,i}return(0,i.__extends)(e,t),e.prototype.mh=function(){if(this.Ih)throw new b(w.FAILED_PRECONDITION,"The client has already been terminated.")},e.prototype.bu=function(t,e,n){var r=this;return this.mh(),this.credentials.getToken().then(function(i){return r.Ku.bu(t,e,n,i)}).catch(function(t){throw t.code===w.UNAUTHENTICATED&&r.credentials.v(),t})},e.prototype.Cu=function(t,e,n){var r=this;return this.mh(),this.credentials.getToken().then(function(i){return r.Ku.Cu(t,e,n,i)}).catch(function(t){throw t.code===w.UNAUTHENTICATED&&r.credentials.v(),t})},e.prototype.terminate=function(){this.Ih=!1},e}(function(){}),Mo=function(){function t(t,e){this.fs=t,this.da=e,this.state="Unknown",this.Ah=0,this.Rh=null,this.Ph=!0}return t.prototype.yh=function(){var t=this;0===this.Ah&&(this.gh("Unknown"),this.Rh=this.fs.Ir("online_state_timeout",1e4,function(){return t.Rh=null,t.Vh("Backend didn't respond within 10 seconds."),t.gh("Offline"),Promise.resolve()}))},t.prototype.ph=function(t){"Online"===this.state?this.gh("Unknown"):(this.Ah++,this.Ah>=1&&(this.bh(),this.Vh("Connection failed 1 times. Most recent error: "+t.toString()),this.gh("Offline")))},t.prototype.set=function(t){this.bh(),this.Ah=0,"Online"===t&&(this.Ph=!1),this.gh(t)},t.prototype.gh=function(t){t!==this.state&&(this.state=t,this.da(t))},t.prototype.Vh=function(t){var e="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.Ph?(a(e),this.Ph=!1):s("OnlineStateTracker",e)},t.prototype.bh=function(){null!==this.Rh&&(this.Rh.cancel(),this.Rh=null)},t}(),qo=function(t,e,n,r,o){var u=this;this.Sh=t,this.Dh=e,this.fs=n,this.Ch={},this.xh=[],this.Nh=new Map,this.Fh=new Set,this.Oh=[],this.kh=o,this.kh.cu(function(t){n.ys(function(){return(0,i.__awaiter)(u,void 0,void 0,function(){return(0,i.__generator)(this,function(t){switch(t.label){case 0:return Wo(this)?(s("RemoteStore","Restarting streams for network reachability change."),[4,function(t){return(0,i.__awaiter)(this,void 0,void 0,function(){var e;return(0,i.__generator)(this,function(n){switch(n.label){case 0:return(e=p(t)).Fh.add(4),[4,jo(e)];case 1:return n.sent(),e.Mh.set("Unknown"),e.Fh.delete(4),[4,Fo(e)];case 2:return n.sent(),[2]}})})}(this)]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})}),this.Mh=new Mo(n,r)};function Fo(t){return(0,i.__awaiter)(this,void 0,void 0,function(){var e,n;return(0,i.__generator)(this,function(r){switch(r.label){case 0:if(!Wo(t))return[3,4];e=0,n=t.Oh,r.label=1;case 1:return e<n.length?[4,(0,n[e])(!0)]:[3,4];case 2:r.sent(),r.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function jo(t){return(0,i.__awaiter)(this,void 0,void 0,function(){var e,n;return(0,i.__generator)(this,function(r){switch(r.label){case 0:e=0,n=t.Oh,r.label=1;case 1:return e<n.length?[4,(0,n[e])(!1)]:[3,4];case 2:r.sent(),r.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function zo(t,e){var n=p(t);n.Nh.has(e.targetId)||(n.Nh.set(e.targetId,e),Jo(n)?Ho(n):cu(n).Ju()&&Bo(n,e))}function Go(t,e){var n=p(t),r=cu(n);n.Nh.delete(e),r.Ju()&&Ko(n,e),0===n.Nh.size&&(r.Ju()?r.Zu():Wo(n)&&n.Mh.set("Unknown"))}function Bo(t,e){t.Lh.cn(e.targetId),cu(t).hh(e)}function Ko(t,e){t.Lh.cn(e),cu(t).lh(e)}function Ho(t){t.Lh=new gn({Sn:function(e){return t.Ch.Sn(e)},Dn:function(e){return t.Nh.get(e)||null}}),cu(t).start(),t.Mh.yh()}function Jo(t){return Wo(t)&&!cu(t).Hu()&&t.Nh.size>0}function Wo(t){return 0===p(t).Fh.size}function Qo(t){t.Lh=void 0}function Yo(t){return(0,i.__awaiter)(this,void 0,void 0,function(){return(0,i.__generator)(this,function(e){return t.Nh.forEach(function(e,n){Bo(t,e)}),[2]})})}function Xo(t,e){return(0,i.__awaiter)(this,void 0,void 0,function(){return(0,i.__generator)(this,function(n){return Qo(t),Jo(t)?(t.Mh.ph(e),Ho(t)):t.Mh.set("Unknown"),[2]})})}function $o(t,e,n){return(0,i.__awaiter)(this,void 0,void 0,function(){var r,o,u;return(0,i.__generator)(this,function(a){switch(a.label){case 0:if(t.Mh.set("Online"),!(e instanceof vn&&2===e.state&&e.cause))return[3,6];a.label=1;case 1:return a.trys.push([1,3,,5]),[4,function(t,e){return(0,i.__awaiter)(this,void 0,void 0,function(){var n,r,o,u;return(0,i.__generator)(this,function(i){switch(i.label){case 0:n=e.cause,r=0,o=e.targetIds,i.label=1;case 1:return r<o.length?(u=o[r],t.Nh.has(u)?[4,t.Ch.$h(u,n)]:[3,3]):[3,5];case 2:i.sent(),t.Nh.delete(u),t.Lh.removeTarget(u),i.label=3;case 3:i.label=4;case 4:return r++,[3,1];case 5:return[2]}})})}(t,e)];case 2:return a.sent(),[3,5];case 3:return r=a.sent(),s("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),[4,Zo(t,r)];case 4:return a.sent(),[3,5];case 5:return[3,13];case 6:if(e instanceof pn?t.Lh.wn(e):e instanceof dn?t.Lh.yn(e):t.Lh.In(e),n.isEqual(U.min()))return[3,13];a.label=7;case 7:return a.trys.push([7,11,,13]),[4,Hi(t.Sh)];case 8:return o=a.sent(),n.u(o)>=0?[4,function(t,e){var n=t.Lh.pn(e);return n.Oe.forEach(function(n,r){if(n.resumeToken.o()>0){var i=t.Nh.get(r);i&&t.Nh.set(r,i.$t(n.resumeToken,e))}}),n.ke.forEach(function(e){var n=t.Nh.get(e);if(n){t.Nh.set(e,n.$t(_.h,n.Mt)),Ko(t,e);var r=new ue(n.target,e,1,n.sequenceNumber);Bo(t,r)}}),t.Ch.Bh(n)}(t,n)]:[3,10];case 9:a.sent(),a.label=10;case 10:return[3,13];case 11:return s("RemoteStore","Failed to raise snapshot:",u=a.sent()),[4,Zo(t,u)];case 12:return a.sent(),[3,13];case 13:return[2]}})})}function Zo(t,e,n){return(0,i.__awaiter)(this,void 0,void 0,function(){var r=this;return(0,i.__generator)(this,function(o){switch(o.label){case 0:if(!or(e))throw e;return t.Fh.add(1),[4,jo(t)];case 1:return o.sent(),t.Mh.set("Offline"),n||(n=function(){return Hi(t.Sh)}),t.fs.bo(function(){return(0,i.__awaiter)(r,void 0,void 0,function(){return(0,i.__generator)(this,function(e){switch(e.label){case 0:return s("RemoteStore","Retrying IndexedDB access"),[4,n()];case 1:return e.sent(),t.Fh.delete(1),[4,Fo(t)];case 2:return e.sent(),[2]}})})}),[2]}})})}function tu(t,e){return e().catch(function(n){return Zo(t,n,e)})}function eu(t){return(0,i.__awaiter)(this,void 0,void 0,function(){var e,n,r,o,u;return(0,i.__generator)(this,function(i){switch(i.label){case 0:e=p(t),n=fu(e),r=e.xh.length>0?e.xh[e.xh.length-1].batchId:-1,i.label=1;case 1:if(!function(t){return Wo(t)&&t.xh.length<10}(e))return[3,7];i.label=2;case 2:return i.trys.push([2,4,,6]),[4,Qi(e.Sh,r)];case 3:return null===(o=i.sent())?(0===e.xh.length&&n.Zu(),[3,7]):(r=o.batchId,function(t,e){t.xh.push(e);var n=fu(t);n.Ju()&&n.fh&&n.dh(e.mutations)}(e,o),[3,6]);case 4:return u=i.sent(),[4,Zo(e,u)];case 5:return i.sent(),[3,6];case 6:return[3,1];case 7:return nu(e)&&ru(e),[2]}})})}function nu(t){return Wo(t)&&!fu(t).Hu()&&t.xh.length>0}function ru(t){fu(t).start()}function iu(t){return(0,i.__awaiter)(this,void 0,void 0,function(){return(0,i.__generator)(this,function(e){return fu(t).Th(),[2]})})}function ou(t){return(0,i.__awaiter)(this,void 0,void 0,function(){var e,n,r,o;return(0,i.__generator)(this,function(i){for(e=fu(t),n=0,r=t.xh;n<r.length;n++)o=r[n],e.dh(o.mutations);return[2]})})}function uu(t,e,n){return(0,i.__awaiter)(this,void 0,void 0,function(){var r,o;return(0,i.__generator)(this,function(i){switch(i.label){case 0:return r=t.xh.shift(),o=Mr.from(r,e,n),[4,tu(t,function(){return t.Ch.qh(o)})];case 1:return i.sent(),[4,eu(t)];case 2:return i.sent(),[2]}})})}function su(t,e){return(0,i.__awaiter)(this,void 0,void 0,function(){return(0,i.__generator)(this,function(n){switch(n.label){case 0:return e&&fu(t).fh?[4,function(t,e){return(0,i.__awaiter)(this,void 0,void 0,function(){var n,r;return(0,i.__generator)(this,function(i){switch(i.label){case 0:return Ge(r=e.code)&&r!==w.ABORTED?(n=t.xh.shift(),fu(t).Xu(),[4,tu(t,function(){return t.Ch.Uh(n.batchId,e)})]):[3,3];case 1:return i.sent(),[4,eu(t)];case 2:i.sent(),i.label=3;case 3:return[2]}})})}(t,e)]:[3,2];case 1:n.sent(),n.label=2;case 2:return nu(t)&&ru(t),[2]}})})}function au(t,e){return(0,i.__awaiter)(this,void 0,void 0,function(){var n;return(0,i.__generator)(this,function(r){switch(r.label){case 0:return n=p(t),e?(n.Fh.delete(2),[4,Fo(n)]):[3,2];case 1:return r.sent(),[3,5];case 2:return e?[3,4]:(n.Fh.add(2),[4,jo(n)]);case 3:r.sent(),n.Mh.set("Unknown"),r.label=4;case 4:r.label=5;case 5:return[2]}})})}function cu(t){var e=this;return t.Qh||(t.Qh=function(t,e,n){var r=p(t);return r.mh(),new Vo(e,r.Ku,r.credentials,r.Kt,n)}(t.Dh,t.fs,{Eu:Yo.bind(null,t),Iu:Xo.bind(null,t),uh:$o.bind(null,t)}),t.Oh.push(function(n){return(0,i.__awaiter)(e,void 0,void 0,function(){return(0,i.__generator)(this,function(e){switch(e.label){case 0:return n?(t.Qh.Xu(),Jo(t)?Ho(t):t.Mh.set("Unknown"),[3,3]):[3,1];case 1:return[4,t.Qh.stop()];case 2:e.sent(),Qo(t),e.label=3;case 3:return[2]}})})})),t.Qh}function fu(t){var e=this;return t.Kh||(t.Kh=function(t,e,n){var r=p(t);return r.mh(),new Ro(e,r.Ku,r.credentials,r.Kt,n)}(t.Dh,t.fs,{Eu:iu.bind(null,t),Iu:su.bind(null,t),Eh:ou.bind(null,t),wh:uu.bind(null,t)}),t.Oh.push(function(n){return(0,i.__awaiter)(e,void 0,void 0,function(){return(0,i.__generator)(this,function(e){switch(e.label){case 0:return n?(t.Kh.Xu(),[4,eu(t)]):[3,2];case 1:return e.sent(),[3,4];case 2:return[4,t.Kh.stop()];case 3:e.sent(),t.xh.length>0&&(s("RemoteStore","Stopping write stream with "+t.xh.length+" pending writes"),t.xh=[]),e.label=4;case 4:return[2]}})})})),t.Kh}var hu=function(){this.Wh=void 0,this.listeners=[]},lu=function(){this.queries=new ui(function(t){return ee(t)},te),this.onlineState="Unknown",this.jh=new Set};function pu(t,e){return(0,i.__awaiter)(this,void 0,void 0,function(){var n,r,o,u,s,a,c;return(0,i.__generator)(this,function(i){switch(i.label){case 0:if(n=p(t),r=e.query,o=!1,(u=n.queries.get(r))||(o=!0,u=new hu),!o)return[3,4];i.label=1;case 1:return i.trys.push([1,3,,4]),s=u,[4,n.Gh(r)];case 2:return s.Wh=i.sent(),[3,4];case 3:return a=i.sent(),c=hr(a,"Initialization of query '"+ne(e.query)+"' failed"),[2,void e.onError(c)];case 4:return n.queries.set(r,u),u.listeners.push(e),e.zh(n.onlineState),u.Wh&&e.Hh(u.Wh)&&gu(n),[2]}})})}function du(t,e){return(0,i.__awaiter)(this,void 0,void 0,function(){var n,r,o,u,s;return(0,i.__generator)(this,function(i){return n=p(t),r=e.query,o=!1,(u=n.queries.get(r))&&(s=u.listeners.indexOf(e))>=0&&(u.listeners.splice(s,1),o=0===u.listeners.length),o?[2,(n.queries.delete(r),n.Jh(r))]:[2]})})}function vu(t,e){for(var n=p(t),r=!1,i=0,o=e;i<o.length;i++){var u=o[i],s=u.query,a=n.queries.get(s);if(a){for(var c=0,f=a.listeners;c<f.length;c++)f[c].Hh(u)&&(r=!0);a.Wh=u}}r&&gu(n)}function yu(t,e,n){var r=p(t),i=r.queries.get(e);if(i)for(var o=0,u=i.listeners;o<u.length;o++)u[o].onError(n);r.queries.delete(e)}function gu(t){t.jh.forEach(function(t){t.next()})}var mu=function(){function t(t,e,n){this.query=t,this.Yh=e,this.Xh=!1,this.Zh=null,this.onlineState="Unknown",this.options=n||{}}return t.prototype.Hh=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&e.push(i)}t=new fn(t.query,t.docs,t.De,e,t.Ce,t.fromCache,t.xe,!0)}var o=!1;return this.Xh?this.tl(t)&&(this.Yh.next(t),o=!0):this.el(t,this.onlineState)&&(this.nl(t),o=!0),this.Zh=t,o},t.prototype.onError=function(t){this.Yh.error(t)},t.prototype.zh=function(t){this.onlineState=t;var e=!1;return this.Zh&&!this.Xh&&this.el(this.Zh,t)&&(this.nl(this.Zh),e=!0),e},t.prototype.el=function(t,e){if(!t.fromCache)return!0;var n="Offline"!==e;return!(this.options.sl&&n||t.docs.nt()&&"Offline"!==e)},t.prototype.tl=function(t){if(t.docChanges.length>0)return!0;var e=this.Zh&&this.Zh.hasPendingWrites!==t.hasPendingWrites;return!(!t.xe&&!e)&&!0===this.options.includeMetadataChanges},t.prototype.nl=function(t){t=fn.Fe(t.query,t.docs,t.Ce,t.fromCache),this.Xh=!0,this.Yh.next(t)},t}(),_u=function(){function t(t,e){this.payload=t,this.byteLength=e}return t.prototype.il=function(){return"metadata"in this.payload},t}(),wu=function(){function t(t){this.Kt=t}return t.prototype.yc=function(t){return kn(this.Kt,t)},t.prototype.gc=function(t){return t.metadata.exists?Rn(this.Kt,t.document,!1):new bt(this.yc(t.metadata.name),this.Vc(t.metadata.readTime))},t.prototype.Vc=function(t){return xn(t)},t}(),bu=function(){function t(t,e,n){this.rl=t,this.Sh=e,this.Kt=n,this.queries=[],this.documents=[],this.progress=Iu(t)}return t.prototype.ol=function(t){this.progress.bytesLoaded+=t.byteLength;var e=this.progress.documentsLoaded;return t.payload.namedQuery?this.queries.push(t.payload.namedQuery):t.payload.documentMetadata?(this.documents.push({metadata:t.payload.documentMetadata}),t.payload.documentMetadata.exists||++e):t.payload.document&&(this.documents[this.documents.length-1].document=t.payload.document,++e),e!==this.progress.documentsLoaded?(this.progress.documentsLoaded=e,Object.assign({},this.progress)):null},t.prototype.cl=function(t){for(var e=new Map,n=new wu(this.Kt),r=0,i=t;r<i.length;r++){var o=i[r];if(o.metadata.queries)for(var u=n.yc(o.metadata.name),s=0,a=o.metadata.queries;s<a.length;s++){var c=a[s],f=(e.get(c)||on()).add(u);e.set(c,f)}}return e},t.prototype.complete=function(){return(0,i.__awaiter)(this,void 0,void 0,function(){var t,e,n,r,o;return(0,i.__generator)(this,function(i){switch(i.label){case 0:return[4,no(this.Sh,new wu(this.Kt),this.documents,this.rl.id)];case 1:t=i.sent(),e=this.cl(this.documents),n=0,r=this.queries,i.label=2;case 2:return n<r.length?(o=r[n],[4,ro(this.Sh,o,e.get(o.name))]):[3,5];case 3:i.sent(),i.label=4;case 4:return n++,[3,2];case 5:return[2,(this.progress.taskState="Success",new Mi(Object.assign({},this.progress),t))]}})})},t}();function Iu(t){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:t.totalDocuments,totalBytes:t.totalBytes}}var Eu=function(t){this.key=t},Tu=function(t){this.key=t},Nu=function(){function t(t,e){this.query=t,this.al=e,this.ul=null,this.qe=!1,this.hl=on(),this.Ce=on(),this.ll=ie(t),this._l=new an(this.ll)}return Object.defineProperty(t.prototype,"fl",{get:function(){return this.al},enumerable:!1,configurable:!0}),t.prototype.dl=function(t,e){var n=this,r=e?e.wl:new cn,i=e?e._l:this._l,o=e?e.Ce:this.Ce,u=i,s=!1,a=Ht(this.query)&&i.size===this.query.limit?i.last():null,c=Jt(this.query)&&i.size===this.query.limit?i.first():null;if(t.Zt(function(t,e){var f=i.get(t),h=e instanceof wt?e:null;h&&(h=re(n.query,h)?h:null);var l=!!f&&n.Ce.has(f.key),p=!!h&&(h.bt||n.Ce.has(h.key)&&h.hasCommittedMutations),d=!1;f&&h?f.data().isEqual(h.data())?l!==p&&(r.track({type:3,doc:h}),d=!0):n.El(f,h)||(r.track({type:2,doc:h}),d=!0,(a&&n.ll(h,a)>0||c&&n.ll(h,c)<0)&&(s=!0)):!f&&h?(r.track({type:0,doc:h}),d=!0):f&&!h&&(r.track({type:1,doc:f}),d=!0,(a||c)&&(s=!0)),d&&(h?(u=u.add(h),o=p?o.add(t):o.delete(t)):(u=u.delete(t),o=o.delete(t)))}),Ht(this.query)||Jt(this.query))for(;u.size>this.query.limit;){var f=Ht(this.query)?u.last():u.first();u=u.delete(f.key),o=o.delete(f.key),r.track({type:1,doc:f})}return{_l:u,wl:r,_c:s,Ce:o}},t.prototype.El=function(t,e){return t.bt&&e.hasCommittedMutations&&!e.bt},t.prototype.Ei=function(t,e,n){var r=this,i=this._l;this._l=t._l,this.Ce=t.Ce;var o=t.wl.Se();o.sort(function(t,e){return function(t,e){var n=function(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return h()}};return n(t)-n(e)}(t.type,e.type)||r.ll(t.doc,e.doc)}),this.Tl(n);var u=e?this.Il():[],s=0===this.hl.size&&this.qe?1:0,a=s!==this.ul;return this.ul=s,0!==o.length||a?{snapshot:new fn(this.query,t._l,i,o,t.Ce,0===s,a,!1),ml:u}:{ml:u}},t.prototype.zh=function(t){return this.qe&&"Offline"===t?(this.qe=!1,this.Ei({_l:this._l,wl:new cn,Ce:this.Ce,_c:!1},!1)):{ml:[]}},t.prototype.Al=function(t){return!this.al.has(t)&&!!this._l.has(t)&&!this._l.get(t).bt},t.prototype.Tl=function(t){var e=this;t&&(t.Ue.forEach(function(t){return e.al=e.al.add(t)}),t.Qe.forEach(function(t){}),t.Ke.forEach(function(t){return e.al=e.al.delete(t)}),this.qe=t.qe)},t.prototype.Il=function(){var t=this;if(!this.qe)return[];var e=this.hl;this.hl=on(),this._l.forEach(function(e){t.Al(e.key)&&(t.hl=t.hl.add(e.key))});var n=[];return e.forEach(function(e){t.hl.has(e)||n.push(new Tu(e))}),this.hl.forEach(function(t){e.has(t)||n.push(new Eu(t))}),n},t.prototype.Rl=function(t){this.al=t.Pc,this.hl=on();var e=this.dl(t.documents);return this.Ei(e,!0)},t.prototype.Pl=function(){return fn.Fe(this.query,this._l,this.Ce,0===this.ul)},t}(),xu=function(t,e,n){this.query=t,this.targetId=e,this.view=n},Au=function(t){this.key=t,this.yl=!1},Su=function(){function t(t,e,n,r,i,o){this.Sh=t,this.gl=e,this.Vl=n,this.pl=r,this.currentUser=i,this.bl=o,this.vl={},this.Sl=new ui(function(t){return ee(t)},te),this.Dl=new Map,this.Cl=[],this.xl=new Ke(z.J),this.Nl=new Map,this.Fl=new oo,this.Ol={},this.kl=new Map,this.Ml=vi.Bi(),this.onlineState="Unknown",this.Ll=void 0}return Object.defineProperty(t.prototype,"$l",{get:function(){return!0===this.Ll},enumerable:!1,configurable:!0}),t}();function Du(t,e){return(0,i.__awaiter)(this,void 0,void 0,function(){var n,r,o,u,s,a;return(0,i.__generator)(this,function(i){switch(i.label){case 0:return n=is(t),(u=n.Sl.get(e))?(r=u.targetId,n.pl.ka(r),o=u.view.Pl(),[3,4]):[3,1];case 1:return[4,Yi(n.Sh,$t(e))];case 2:return s=i.sent(),a=n.pl.ka(s.targetId),r=s.targetId,[4,ku(n,e,r,"current"===a)];case 3:o=i.sent(),n.$l&&zo(n.gl,s),i.label=4;case 4:return[2,o]}})})}function ku(t,e,n,r){return(0,i.__awaiter)(this,void 0,void 0,function(){var o,u,s,a,c,f;return(0,i.__generator)(this,function(h){switch(h.label){case 0:return t.Bl=function(e,n,r){return function(t,e,n,r){return(0,i.__awaiter)(this,void 0,void 0,function(){var o,u,s;return(0,i.__generator)(this,function(i){switch(i.label){case 0:return(o=e.view.dl(n))._c?[4,$i(t.Sh,e.query,!1).then(function(t){var n=t.documents;return e.view.dl(n,o)})]:[3,2];case 1:o=i.sent(),i.label=2;case 2:return u=r&&r.Oe.get(e.targetId),s=e.view.Ei(o,t.$l,u),[2,(Gu(t,e.targetId,s.ml),s.snapshot)]}})})}(t,e,n,r)},[4,$i(t.Sh,e,!0)];case 1:return o=h.sent(),u=new Nu(e,o.Pc),s=u.dl(o.documents),a=ln.Be(n,r&&"Offline"!==t.onlineState),c=u.Ei(s,t.$l,a),Gu(t,n,c.ml),f=new xu(e,n,u),[2,(t.Sl.set(e,f),t.Dl.has(n)?t.Dl.get(n).push(e):t.Dl.set(n,[e]),c.snapshot)]}})})}function Ou(t,e){return(0,i.__awaiter)(this,void 0,void 0,function(){var n,r,o;return(0,i.__generator)(this,function(i){switch(i.label){case 0:return n=p(t),r=n.Sl.get(e),(o=n.Dl.get(r.targetId)).length>1?[2,(n.Dl.set(r.targetId,o.filter(function(t){return!te(t,e)})),void n.Sl.delete(e))]:n.$l?(n.pl.La(r.targetId),n.pl.Ca(r.targetId)?[3,2]:[4,Xi(n.Sh,r.targetId,!1).then(function(){n.pl.Ba(r.targetId),Go(n.gl,r.targetId),ju(n,r.targetId)}).catch(oi)]):[3,3];case 1:i.sent(),i.label=2;case 2:return[3,5];case 3:return ju(n,r.targetId),[4,Xi(n.Sh,r.targetId,!0)];case 4:i.sent(),i.label=5;case 5:return[2]}})})}function Lu(t,e,n){return(0,i.__awaiter)(this,void 0,void 0,function(){var r,o,u,s;return(0,i.__generator)(this,function(i){switch(i.label){case 0:r=os(t),i.label=1;case 1:return i.trys.push([1,5,,6]),[4,function(t,e){var n,r=p(t),i=R.now(),o=e.reduce(function(t,e){return t.add(e.key)},on());return r.persistence.runTransaction("Locally write mutations","readwrite",function(t){return r.Ic.Zo(t,o).next(function(o){n=o;for(var u=[],s=0,a=e;s<a.length;s++){var c=a[s],f=De(c,n.get(c.key));null!=f&&u.push(new Ce(c.key,f,mt(f.proto.mapValue),Te.exists(!0)))}return r.Ho.Pi(t,i,u,e)})}).then(function(t){var e=t.Ns(n);return{batchId:t.batchId,oi:e}})}(r.Sh,e)];case 2:return o=i.sent(),r.pl.xa(o.batchId),function(t,e,n){var r=t.Ol[t.currentUser.R()];r||(r=new Ke(y)),r=r.Ht(e,n),t.Ol[t.currentUser.R()]=r}(r,o.batchId,n),[4,Hu(r,o.oi)];case 3:return i.sent(),[4,eu(r.gl)];case 4:return i.sent(),[3,6];case 5:return u=i.sent(),s=hr(u,"Failed to persist write"),n.reject(s),[3,6];case 6:return[2]}})})}function Cu(t,e){return(0,i.__awaiter)(this,void 0,void 0,function(){var n,r;return(0,i.__generator)(this,function(i){switch(i.label){case 0:n=p(t),i.label=1;case 1:return i.trys.push([1,4,,6]),[4,Ji(n.Sh,e)];case 2:return r=i.sent(),e.Oe.forEach(function(t,e){var r=n.Nl.get(e);r&&(l(t.Ue.size+t.Qe.size+t.Ke.size<=1),t.Ue.size>0?r.yl=!0:t.Qe.size>0?l(r.yl):t.Ke.size>0&&(l(r.yl),r.yl=!1))}),[4,Hu(n,r,e)];case 3:return i.sent(),[3,6];case 4:return[4,oi(i.sent())];case 5:return i.sent(),[3,6];case 6:return[2]}})})}function Pu(t,e,n){var r=p(t);if(r.$l&&0===n||!r.$l&&1===n){var i=[];r.Sl.forEach(function(t,n){var r=n.view.zh(e);r.snapshot&&i.push(r.snapshot)}),function(t,e){var n=p(t);n.onlineState=e;var r=!1;n.queries.forEach(function(t,n){for(var i=0,o=n.listeners;i<o.length;i++)o[i].zh(e)&&(r=!0)}),r&&gu(n)}(r.Vl,e),i.length&&r.vl.uh(i),r.onlineState=e,r.$l&&r.pl.Ka(e)}}function Vu(t,e,n){return(0,i.__awaiter)(this,void 0,void 0,function(){var r,o,u,s,a,c;return(0,i.__generator)(this,function(i){switch(i.label){case 0:return(r=p(t)).pl.qa(e,"rejected",n),o=r.Nl.get(e),(u=o&&o.key)?(s=(s=new Ke(z.J)).Ht(u,new bt(u,U.min())),a=on().add(u),c=new hn(U.min(),new Map,new We(y),s,a),[4,Cu(r,c)]):[3,2];case 1:return i.sent(),r.xl=r.xl.remove(u),r.Nl.delete(e),Ku(r),[3,4];case 2:return[4,Xi(r.Sh,e,!1).then(function(){return ju(r,e,n)}).catch(oi)];case 3:i.sent(),i.label=4;case 4:return[2]}})})}function Ru(t,e){return(0,i.__awaiter)(this,void 0,void 0,function(){var n,r,o;return(0,i.__generator)(this,function(i){switch(i.label){case 0:n=p(t),r=e.batch.batchId,i.label=1;case 1:return i.trys.push([1,4,,6]),[4,Ki(n.Sh,e)];case 2:return o=i.sent(),Fu(n,r,null),qu(n,r),n.pl.Fa(r,"acknowledged"),[4,Hu(n,o)];case 3:return i.sent(),[3,6];case 4:return[4,oi(i.sent())];case 5:return i.sent(),[3,6];case 6:return[2]}})})}function Uu(t,e,n){return(0,i.__awaiter)(this,void 0,void 0,function(){var r,o;return(0,i.__generator)(this,function(i){switch(i.label){case 0:r=p(t),i.label=1;case 1:return i.trys.push([1,4,,6]),[4,function(t,e){var n=p(t);return n.persistence.runTransaction("Reject batch","readwrite-primary",function(t){var r;return n.Ho.yi(t,e).next(function(e){return l(null!==e),r=e.keys(),n.Ho.xi(t,e)}).next(function(){return n.Ho.Oi(t)}).next(function(){return n.Ic.Zo(t,r)})})}(r.Sh,e)];case 2:return o=i.sent(),Fu(r,e,n),qu(r,e),r.pl.Fa(e,"rejected",n),[4,Hu(r,o)];case 3:return i.sent(),[3,6];case 4:return[4,oi(i.sent())];case 5:return i.sent(),[3,6];case 6:return[2]}})})}function Mu(t,e){return(0,i.__awaiter)(this,void 0,void 0,function(){var n,r,o,u,a;return(0,i.__generator)(this,function(i){switch(i.label){case 0:Wo((n=p(t)).gl)||s("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),i.label=1;case 1:return i.trys.push([1,3,,4]),[4,function(t){var e=p(n.Sh);return e.persistence.runTransaction("Get highest unacknowledged batch id","readonly",function(t){return e.Ho.pi(t)})}()];case 2:return-1===(r=i.sent())?[2,void e.resolve()]:((o=n.kl.get(r)||[]).push(e),n.kl.set(r,o),[3,4]);case 3:return u=i.sent(),a=hr(u,"Initialization of waitForPendingWrites() operation failed"),e.reject(a),[3,4];case 4:return[2]}})})}function qu(t,e){(t.kl.get(e)||[]).forEach(function(t){t.resolve()}),t.kl.delete(e)}function Fu(t,e,n){var r=p(t),i=r.Ol[r.currentUser.R()];if(i){var o=i.get(e);o&&(n?o.reject(n):o.resolve(),i=i.remove(e)),r.Ol[r.currentUser.R()]=i}}function ju(t,e,n){void 0===n&&(n=null),t.pl.La(e);for(var r=0,i=t.Dl.get(e);r<i.length;r++){var o=i[r];t.Sl.delete(o),n&&t.vl.ql(o,n)}t.Dl.delete(e),t.$l&&t.Fl.kc(e).forEach(function(e){t.Fl.ki(e)||zu(t,e)})}function zu(t,e){var n=t.xl.get(e);null!==n&&(Go(t.gl,n),t.xl=t.xl.remove(e),t.Nl.delete(n),Ku(t))}function Gu(t,e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r];o instanceof Eu?(t.Fl.sr(o.key,e),Bu(t,o)):o instanceof Tu?(s("SyncEngine","Document no longer in limbo: "+o.key),t.Fl.rr(o.key,e),t.Fl.ki(o.key)||zu(t,o.key)):h()}}function Bu(t,e){var n=e.key;t.xl.get(n)||(s("SyncEngine","New document in limbo: "+n),t.Cl.push(n),Ku(t))}function Ku(t){for(;t.Cl.length>0&&t.xl.size<t.bl;){var e=t.Cl.shift(),n=t.Ml.next();t.Nl.set(n,new Au(e)),t.xl=t.xl.Ht(e,n),zo(t.gl,new ue($t(Kt(e.path)),n,2,V.U))}}function Hu(t,e,n){return(0,i.__awaiter)(this,void 0,void 0,function(){var r,o,u,a;return(0,i.__generator)(this,function(c){switch(c.label){case 0:return r=p(t),o=[],u=[],a=[],r.Sl.nt()?[3,3]:(r.Sl.forEach(function(t,i){a.push(r.Bl(i,e,n).then(function(t){if(t){r.$l&&r.pl.qa(i.targetId,t.fromCache?"not-current":"current"),o.push(t);var e=Fi.cc(i.targetId,t);u.push(e)}}))}),[4,Promise.all(a)]);case 1:return c.sent(),r.vl.uh(o),[4,function(t,e){return(0,i.__awaiter)(this,void 0,void 0,function(){var n,r,o,u,a,c,f,h,l;return(0,i.__generator)(this,function(i){switch(i.label){case 0:n=p(t),i.label=1;case 1:return i.trys.push([1,3,,4]),[4,n.persistence.runTransaction("notifyLocalViewChanges","readwrite",function(t){return tr.forEach(e,function(e){return tr.forEach(e.rc,function(r){return n.persistence.Ii.sr(t,e.targetId,r)}).next(function(){return tr.forEach(e.oc,function(r){return n.persistence.Ii.rr(t,e.targetId,r)})})})})];case 2:return i.sent(),[3,4];case 3:if(!or(r=i.sent()))throw r;return s("LocalStore","Failed to update sequence numbers: "+r),[3,4];case 4:for(o=0,u=e;o<u.length;o++)a=u[o],c=a.targetId,a.fromCache||(f=n.dc.get(c),h=f.Mt,l=f.Bt(h),n.dc=n.dc.Ht(c,l));return[2]}})})}(r.Sh,u)];case 2:c.sent(),c.label=3;case 3:return[2]}})})}function Ju(t,e){return(0,i.__awaiter)(this,void 0,void 0,function(){var n,r;return(0,i.__generator)(this,function(i){switch(i.label){case 0:return(n=p(t)).currentUser.isEqual(e)?[3,3]:(s("SyncEngine","User change. New user:",e.R()),[4,Bi(n.Sh,e)]);case 1:return r=i.sent(),n.currentUser=e,function(t,e){t.kl.forEach(function(t){t.forEach(function(t){t.reject(new b(w.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),t.kl.clear()}(n),n.pl.Qa(e,r.Ac,r.Rc),[4,Hu(n,r.mc)];case 2:i.sent(),i.label=3;case 3:return[2]}})})}function Wu(t,e){var n=p(t),r=n.Nl.get(e);if(r&&r.yl)return on().add(r.key);var i=on(),o=n.Dl.get(e);if(!o)return i;for(var u=0,s=o;u<s.length;u++){var a=s[u],c=n.Sl.get(a);i=i.ye(c.view.fl)}return i}function Qu(t,e){return(0,i.__awaiter)(this,void 0,void 0,function(){var n,r,o;return(0,i.__generator)(this,function(i){switch(i.label){case 0:return[4,$i((n=p(t)).Sh,e.query,!0)];case 1:return r=i.sent(),o=e.view.Rl(r),[2,(n.$l&&Gu(n,e.targetId,o.ml),o)]}})})}function Yu(t){return(0,i.__awaiter)(this,void 0,void 0,function(){var e;return(0,i.__generator)(this,function(n){return[2,to((e=p(t)).Sh).then(function(t){return Hu(e,t)})]})})}function Xu(t,e,n,r){return(0,i.__awaiter)(this,void 0,void 0,function(){var o,u;return(0,i.__generator)(this,function(i){switch(i.label){case 0:return[4,function(t,e){var n=p(t),r=p(n.Ho);return n.persistence.runTransaction("Lookup mutation documents","readonly",function(t){return r.gi(t,e).next(function(e){return e?n.Ic.Zo(t,e):tr.resolve(null)})})}((o=p(t)).Sh,e)];case 1:return null===(u=i.sent())?[3,6]:"pending"!==n?[3,3]:[4,eu(o.gl)];case 2:return i.sent(),[3,4];case 3:"acknowledged"===n||"rejected"===n?(Fu(o,e,r||null),qu(o,e),function(t,e){p(p(t).Ho).Ni(e)}(o.Sh,e)):h(),i.label=4;case 4:return[4,Hu(o,u)];case 5:return i.sent(),[3,7];case 6:s("SyncEngine","Cannot apply mutation batch with id: "+e),i.label=7;case 7:return[2]}})})}function $u(t,e){return(0,i.__awaiter)(this,void 0,void 0,function(){var n,r,o,u,s,a,c,f;return(0,i.__generator)(this,function(i){switch(i.label){case 0:return is(n=p(t)),os(n),!0!==e||!0===n.Ll?[3,3]:(r=n.pl.Sa(),[4,Zu(n,r.rt())]);case 1:return o=i.sent(),n.Ll=!0,[4,au(n.gl,!0)];case 2:for(i.sent(),u=0,s=o;u<s.length;u++)a=s[u],zo(n.gl,a);return[3,7];case 3:return!1!==e||!1===n.Ll?[3,7]:(c=[],f=Promise.resolve(),n.Dl.forEach(function(t,e){n.pl.$a(e)?c.push(e):f=f.then(function(){return ju(n,e),Xi(n.Sh,e,!0)}),Go(n.gl,e)}),[4,f]);case 4:return i.sent(),[4,Zu(n,c)];case 5:return i.sent(),function(t){var e=p(n);e.Nl.forEach(function(t,n){Go(e.gl,n)}),e.Fl.Mc(),e.Nl=new Map,e.xl=new Ke(z.J)}(),n.Ll=!1,[4,au(n.gl,!1)];case 6:i.sent(),i.label=7;case 7:return[2]}})})}function Zu(t,e,n){return(0,i.__awaiter)(this,void 0,void 0,function(){var n,r,o,u,s,a,c,f,h,l,d,v,y,g;return(0,i.__generator)(this,function(i){switch(i.label){case 0:n=p(t),r=[],o=[],u=0,s=e,i.label=1;case 1:return u<s.length?(a=s[u],c=void 0,(f=n.Dl.get(a))&&0!==f.length?[4,Yi(n.Sh,$t(f[0]))]:[3,7]):[3,13];case 2:c=i.sent(),h=0,l=f,i.label=3;case 3:return h<l.length?(d=l[h],v=n.Sl.get(d),[4,Qu(n,v)]):[3,6];case 4:(y=i.sent()).snapshot&&o.push(y.snapshot),i.label=5;case 5:return h++,[3,3];case 6:return[3,11];case 7:return[4,Zi(n.Sh,a)];case 8:return g=i.sent(),[4,Yi(n.Sh,g)];case 9:return c=i.sent(),[4,ku(n,ts(g),a,!1)];case 10:i.sent(),i.label=11;case 11:r.push(c),i.label=12;case 12:return u++,[3,1];case 13:return[2,(n.vl.uh(o),r)]}})})}function ts(t){return Bt(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function es(t){var e=p(t);return p(p(e.Sh).persistence).Qo()}function ns(t,e,n,r){return(0,i.__awaiter)(this,void 0,void 0,function(){var o,u,a;return(0,i.__generator)(this,function(i){switch(i.label){case 0:return(o=p(t)).Ll?(s("SyncEngine","Ignoring unexpected query state notification."),[3,8]):[3,1];case 1:if(!o.Dl.has(e))return[3,8];switch(n){case"current":case"not-current":return[3,2];case"rejected":return[3,5]}return[3,7];case 2:return[4,to(o.Sh)];case 3:return u=i.sent(),a=hn.$e(e,"current"===n),[4,Hu(o,u,a)];case 4:return i.sent(),[3,8];case 5:return[4,Xi(o.Sh,e,!0)];case 6:return i.sent(),ju(o,e,r),[3,8];case 7:h(),i.label=8;case 8:return[2]}})})}function rs(t,e,n){return(0,i.__awaiter)(this,void 0,void 0,function(){var r,o,u,a,c,f,h,l,p,d;return(0,i.__generator)(this,function(v){switch(v.label){case 0:if(!(r=is(t)).Ll)return[3,10];o=0,u=e,v.label=1;case 1:return o<u.length?(a=u[o],r.Dl.has(a)?(s("SyncEngine","Adding an already active target "+a),[3,5]):[4,Zi(r.Sh,a)]):[3,6];case 2:return c=v.sent(),[4,Yi(r.Sh,c)];case 3:return f=v.sent(),[4,ku(r,ts(c),f.targetId,!1)];case 4:v.sent(),zo(r.gl,f),v.label=5;case 5:return o++,[3,1];case 6:h=function(t){return(0,i.__generator)(this,function(e){switch(e.label){case 0:return r.Dl.has(t)?[4,Xi(r.Sh,t,!1).then(function(){Go(r.gl,t),ju(r,t)}).catch(oi)]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}})},l=0,p=n,v.label=7;case 7:return l<p.length?(d=p[l],[5,h(d)]):[3,10];case 8:v.sent(),v.label=9;case 9:return l++,[3,7];case 10:return[2]}})})}function is(t){var e=p(t);return e.gl.Ch.Bh=Cu.bind(null,e),e.gl.Ch.Sn=Wu.bind(null,e),e.gl.Ch.$h=Vu.bind(null,e),e.vl.uh=vu.bind(null,e.Vl),e.vl.ql=yu.bind(null,e.Vl),e}function os(t){var e=p(t);return e.gl.Ch.qh=Ru.bind(null,e),e.gl.Ch.Uh=Uu.bind(null,e),e}function us(t,e,n){var r=p(t);(function(t,e,n){return(0,i.__awaiter)(this,void 0,void 0,function(){var r,o,u,s,a,f;return(0,i.__generator)(this,function(i){switch(i.label){case 0:return i.trys.push([0,14,,15]),[4,e.getMetadata()];case 1:return r=i.sent(),[4,function(t,e){var n=p(t),r=xn(e.createTime);return n.persistence.runTransaction("hasNewerBundle","readonly",function(t){return n.Eo.Ms(t,e.id)}).then(function(t){return!!t&&t.createTime.u(r)>=0})}(t.Sh,r)];case 2:return i.sent()?[4,e.close()]:[3,4];case 3:return[2,(i.sent(),void n.Ul(function(t){return{taskState:"Success",documentsLoaded:t.totalDocuments,bytesLoaded:t.totalBytes,totalDocuments:t.totalDocuments,totalBytes:t.totalBytes}}(r)))];case 4:return n.Ql(Iu(r)),o=new bu(r,t.Sh,e.Kt),[4,e.Kl()];case 5:u=i.sent(),i.label=6;case 6:return u?[4,o.ol(u)]:[3,10];case 7:return(s=i.sent())&&n.Ql(s),[4,e.Kl()];case 8:u=i.sent(),i.label=9;case 9:return[3,6];case 10:return[4,o.complete()];case 11:return a=i.sent(),[4,Hu(t,a.zo,void 0)];case 12:return i.sent(),[4,function(t,e){var n=p(t);return n.persistence.runTransaction("Save bundle","readwrite",function(t){return n.Eo.Ls(t,e)})}(t.Sh,r)];case 13:return i.sent(),n.Ul(a.progress),[3,15];case 14:return c("SyncEngine","Loading bundle failed with "+(f=i.sent())),n.Wl(f),[3,15];case 15:return[2]}})})})(r,e,n).then(function(){r.pl.ja()})}var ss=function(){function t(){this.synchronizeTabs=!1}return t.prototype.initialize=function(t){return(0,i.__awaiter)(this,void 0,void 0,function(){return(0,i.__generator)(this,function(e){switch(e.label){case 0:return this.Kt=Lo(t.gu.T),this.pl=this.jl(t),this.persistence=this.Gl(t),[4,this.persistence.start()];case 1:return e.sent(),this.zl=this.Hl(t),this.Sh=this.Jl(t),[2]}})})},t.prototype.Hl=function(t){return null},t.prototype.Jl=function(t){return Gi(this.persistence,new ji,t.Yl,this.Kt)},t.prototype.Gl=function(t){return new ho(po.ra,this.Kt)},t.prototype.jl=function(t){return new To},t.prototype.terminate=function(){return(0,i.__awaiter)(this,void 0,void 0,function(){return(0,i.__generator)(this,function(t){switch(t.label){case 0:return this.zl&&this.zl.stop(),[4,this.pl.Lo()];case 1:return t.sent(),[4,this.persistence.Lo()];case 2:return t.sent(),[2]}})})},t}(),as=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).Xl=e,i.cacheSizeBytes=n,i.forceOwnership=r,i.synchronizeTabs=!1,i}return(0,i.__extends)(e,t),e.prototype.initialize=function(e){return(0,i.__awaiter)(this,void 0,void 0,function(){return(0,i.__generator)(this,function(n){switch(n.label){case 0:return[4,t.prototype.initialize.call(this,e)];case 1:return n.sent(),[4,eo(this.Sh)];case 2:return n.sent(),[4,this.Xl.initialize(this,e)];case 3:return n.sent(),[4,os(this.Xl.fa)];case 4:return n.sent(),[4,eu(this.Xl.gl)];case 5:return n.sent(),[2]}})})},e.prototype.Jl=function(t){return Gi(this.persistence,new ji,t.Yl,this.Kt)},e.prototype.Hl=function(t){var e=this.persistence.Ii._r;return new Ii(e,t.fs)},e.prototype.Gl=function(t){var e=Ui(t.gu.T,t.gu.persistenceKey),n=void 0!==this.cacheSizeBytes?ii.Xs(this.cacheSizeBytes):ii.ei;return new Pi(this.synchronizeTabs,e,t.clientId,n,t.fs,ko(),Oo(),this.Kt,this.pl,!!this.forceOwnership)},e.prototype.jl=function(t){return new To},e}(ss),cs=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n,!1)||this).Xl=e,r.cacheSizeBytes=n,r.synchronizeTabs=!0,r}return(0,i.__extends)(e,t),e.prototype.initialize=function(e){return(0,i.__awaiter)(this,void 0,void 0,function(){var n,r=this;return(0,i.__generator)(this,function(o){switch(o.label){case 0:return[4,t.prototype.initialize.call(this,e)];case 1:return o.sent(),n=this.Xl.fa,this.pl instanceof Eo?(this.pl.fa={nu:Xu.bind(null,n),su:ns.bind(null,n),iu:rs.bind(null,n),Qo:es.bind(null,n),eu:Yu.bind(null,n)},[4,this.pl.start()]):[3,3];case 2:o.sent(),o.label=3;case 3:return[4,this.persistence.Po(function(t){return(0,i.__awaiter)(r,void 0,void 0,function(){return(0,i.__generator)(this,function(e){switch(e.label){case 0:return[4,$u(this.Xl.fa,t)];case 1:return e.sent(),this.zl&&(t&&!this.zl.Tr?this.zl.start(this.Sh):t||this.zl.stop()),[2]}})})})];case 4:return o.sent(),[2]}})})},e.prototype.jl=function(t){var e=ko();if(!Eo.Wn(e))throw new b(w.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");var n=Ui(t.gu.T,t.gu.persistenceKey);return new Eo(e,t.fs,n,t.clientId,t.Yl)},e}(as),fs=function(){function t(){}return t.prototype.initialize=function(t,e){return(0,i.__awaiter)(this,void 0,void 0,function(){var n=this;return(0,i.__generator)(this,function(r){switch(r.label){case 0:return this.Sh?[3,2]:(this.Sh=t.Sh,this.pl=t.pl,this.Dh=this.Zl(e),this.gl=this.t_(e),this.Vl=this.e_(e),this.fa=this.n_(e,!t.synchronizeTabs),this.pl.da=function(t){return Pu(n.fa,t,1)},this.gl.Ch.s_=Ju.bind(null,this.fa),[4,au(this.gl,this.fa.$l)]);case 1:r.sent(),r.label=2;case 2:return[2]}})})},t.prototype.e_=function(t){return new lu},t.prototype.Zl=function(t){var e,n=Lo(t.gu.T),r=(e=t.gu,new Do(e));return function(t,e,n){return new Uo(t,r,n)}(t.credentials,0,n)},t.prototype.t_=function(t){var e,n,r,i,o,u=this;return e=this.Sh,n=this.Dh,r=t.fs,i=function(t){return Pu(u.fa,t,0)},o=xo.Wn()?new xo:new No,new qo(e,n,r,i,o)},t.prototype.n_=function(t,e){return function(t,e,n,r,i,o,u){var s=new Su(t,e,n,r,i,o);return u&&(s.Ll=!0),s}(this.Sh,this.gl,this.Vl,this.pl,t.Yl,t.bl,e)},t.prototype.terminate=function(){return function(t){return(0,i.__awaiter)(this,void 0,void 0,function(){var e;return(0,i.__generator)(this,function(n){switch(n.label){case 0:return e=p(t),s("RemoteStore","RemoteStore shutting down."),e.Fh.add(5),[4,jo(e)];case 1:return n.sent(),e.kh.Lo(),e.Mh.set("Unknown"),[2]}})})}(this.gl)},t}();function hs(t,e){void 0===e&&(e=10240);var n=0;return{read:function(){return(0,i.__awaiter)(this,void 0,void 0,function(){var r;return(0,i.__generator)(this,function(i){return n<t.byteLength?(r={value:t.slice(n,n+e),done:!1},[2,(n+=e,r)]):[2,{done:!0}]})})},cancel:function(){return(0,i.__awaiter)(this,void 0,void 0,function(){return(0,i.__generator)(this,function(t){return[2]})})},releaseLock:function(){}}}var ls=function(){function t(t){this.observer=t,this.muted=!1}return t.prototype.next=function(t){this.observer.next&&this.i_(this.observer.next,t)},t.prototype.error=function(t){this.observer.error?this.i_(this.observer.error,t):console.error("Uncaught Error in snapshot listener:",t)},t.prototype.r_=function(){this.muted=!0},t.prototype.i_=function(t,e){var n=this;this.muted||setTimeout(function(){n.muted||t(e)},0)},t}(),ps=function(){function t(t,e){var n=this;this.o_=t,this.Kt=e,this.metadata=new Zn,this.buffer=new Uint8Array,this.c_=new TextDecoder("utf-8"),this.a_().then(function(t){t&&t.il()?n.metadata.resolve(t.payload.metadata):n.metadata.reject(new Error("The first element of the bundle is not a metadata, it is\n             "+JSON.stringify(null==t?void 0:t.payload)))},function(t){return n.metadata.reject(t)})}return t.prototype.close=function(){return this.o_.cancel()},t.prototype.getMetadata=function(){return(0,i.__awaiter)(this,void 0,void 0,function(){return(0,i.__generator)(this,function(t){return[2,this.metadata.promise]})})},t.prototype.Kl=function(){return(0,i.__awaiter)(this,void 0,void 0,function(){return(0,i.__generator)(this,function(t){switch(t.label){case 0:return[4,this.getMetadata()];case 1:return[2,(t.sent(),this.a_())]}})})},t.prototype.a_=function(){return(0,i.__awaiter)(this,void 0,void 0,function(){var t,e,n,r;return(0,i.__generator)(this,function(i){switch(i.label){case 0:return[4,this.u_()];case 1:return null===(t=i.sent())?[2,null]:(e=this.c_.decode(t),n=Number(e),isNaN(n)&&this.h_("length string ("+e+") is not valid number"),[4,this.l_(n)]);case 2:return r=i.sent(),[2,new _u(JSON.parse(r),t.length+n)]}})})},t.prototype.__=function(){return this.buffer.findIndex(function(t){return t==="{".charCodeAt(0)})},t.prototype.u_=function(){return(0,i.__awaiter)(this,void 0,void 0,function(){var t,e;return(0,i.__generator)(this,function(n){switch(n.label){case 0:return this.__()<0?[4,this.f_()]:[3,3];case 1:if(n.sent())return[3,3];n.label=2;case 2:return[3,0];case 3:return 0===this.buffer.length?[2,null]:((t=this.__())<0&&this.h_("Reached the end of bundle when a length string is expected."),e=this.buffer.slice(0,t),[2,(this.buffer=this.buffer.slice(t),e)])}})})},t.prototype.l_=function(t){return(0,i.__awaiter)(this,void 0,void 0,function(){var e;return(0,i.__generator)(this,function(n){switch(n.label){case 0:return this.buffer.length<t?[4,this.f_()]:[3,3];case 1:n.sent()&&this.h_("Reached the end of bundle when more is expected."),n.label=2;case 2:return[3,0];case 3:return e=this.c_.decode(this.buffer.slice(0,t)),[2,(this.buffer=this.buffer.slice(t),e)]}})})},t.prototype.h_=function(t){throw this.o_.cancel(),new Error("Invalid bundle format: "+t)},t.prototype.f_=function(){return(0,i.__awaiter)(this,void 0,void 0,function(){var t,e;return(0,i.__generator)(this,function(n){switch(n.label){case 0:return[4,this.o_.read()];case 1:return(t=n.sent()).done||((e=new Uint8Array(this.buffer.length+t.value.length)).set(this.buffer),e.set(t.value,this.buffer.length),this.buffer=e),[2,t.done]}})})},t}(),ds=function(){function t(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=0;n<t.length;++n)if(0===t[n].length)throw new b(w.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this.d_=new j(t)}return t.prototype.isEqual=function(t){return this.d_.isEqual(t.d_)},t}(),vs=function(t){this._methodName=t};function ys(t,e,n){if(!n)throw new b(w.INVALID_ARGUMENT,"Function "+t+"() cannot be called with an empty "+e+".")}function gs(t,e){if(void 0===e)return{merge:!1};if(void 0!==e.mergeFields&&void 0!==e.merge)throw new b(w.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');return e}function ms(t,e,n,r){if(!0===e&&!0===r)throw new b(w.INVALID_ARGUMENT,t+" and "+n+" cannot be used together.")}function _s(t){if(!z.Et(t))throw new b(w.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t+" has "+t.length+".")}function ws(t){if(z.Et(t))throw new b(w.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t+" has "+t.length+".")}function bs(t){if(void 0===t)return"undefined";if(null===t)return"null";if("string"==typeof t)return t.length>20&&(t=t.substring(0,20)+"..."),JSON.stringify(t);if("number"==typeof t||"boolean"==typeof t)return""+t;if("object"==typeof t){if(t instanceof Array)return"an array";var e=function(t){if(t.constructor){var e=/function\s+([^\s(]+)\s*\(/.exec(t.constructor.toString());if(e&&e.length>1)return e[1]}return null}(t);return e?"a custom "+e+" object":"an object"}return"function"==typeof t?"a function":h()}function Is(t,e){if("_delegate"in t&&(t=t._),!(t instanceof e)){if(e.name===t.constructor.name)throw new b(w.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");var n=bs(t);throw new b(w.INVALID_ARGUMENT,"Expected type '"+e.name+"', but it was: "+n)}return t}function Es(t,e){if(e<=0)throw new b(w.INVALID_ARGUMENT,"Function "+t+"() requires a positive number, but it was: "+e+".")}var Ts=function(){function t(t){var e;if(void 0===t.host){if(void 0!==t.ssl)throw new b(w.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(e=t.ssl)||void 0===e||e;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new b(w.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,ms("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling)}return t.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties},t}(),Ns=new Map,xs=function(){function t(t,e){this.w_="(lite)",this.E_=new Ts({}),this.T_=!1,t instanceof S?(this.I_=t,this.m_=new O):(this.A_=t,this.I_=function(t){if(!Object.prototype.hasOwnProperty.apply(t.options,["projectId"]))throw new b(w.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new S(t.options.projectId)}(t),this.m_=new L(e))}return Object.defineProperty(t.prototype,"app",{get:function(){if(!this.A_)throw new b(w.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.A_},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"R_",{get:function(){return this.T_},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"P_",{get:function(){return void 0!==this.y_},enumerable:!1,configurable:!0}),t.prototype.g_=function(t){if(this.T_)throw new b(w.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this.E_=new Ts(t),void 0!==t.credentials&&(this.m_=function(t){if(!t)return new O;switch(t.type){case"gapi":var e=t.client;return l(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new P(e,t.sessionIndex||"0");case"provider":return t.client;default:throw new b(w.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(t.credentials))},t.prototype.V_=function(){return this.E_},t.prototype.p_=function(){return this.T_=!0,this.E_},t.prototype._delete=function(){return this.y_||(this.y_=this.b_()),this.y_},t.prototype.toJSON=function(){return{app:this.A_,T:this.I_,settings:this.E_}},t.prototype.b_=function(){return this,(t=Ns.get(this))&&(s("ComponentProvider","Removing Datastore"),Ns.delete(this),t.terminate()),Promise.resolve();var t},t}(),As=function(){function t(t,e,n){this.v_=e,this.S_=n,this.type="document",this.firestore=t}return Object.defineProperty(t.prototype,"D_",{get:function(){return this.S_.path},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"id",{get:function(){return this.S_.path.et()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"path",{get:function(){return this.S_.path.ot()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){return new Ds(this.firestore,this.v_,this.S_.path.Z())},enumerable:!1,configurable:!0}),t.prototype.withConverter=function(e){return new t(this.firestore,e,this.S_)},t}(),Ss=function(){function t(t,e,n){this.v_=e,this.C_=n,this.type="query",this.firestore=t}return t.prototype.withConverter=function(e){return new t(this.firestore,e,this.C_)},t}(),Ds=function(t){function e(e,n,r){var i=this;return(i=t.call(this,e,n,Kt(r))||this).firestore=e,i.D_=r,i.type="collection",i}return(0,i.__extends)(e,t),Object.defineProperty(e.prototype,"id",{get:function(){return this.C_.path.et()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this.C_.path.ot()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){var t=this.D_.Z();return t.nt()?null:new As(this.firestore,null,new z(t))},enumerable:!1,configurable:!0}),e.prototype.withConverter=function(t){return new e(this.firestore,t,this.D_)},e}(Ss);function ks(t,e){for(var n,r=[],o=2;o<arguments.length;o++)r[o-2]=arguments[o];if(t instanceof E&&(t=t._),ys("collection","path",e),t instanceof xs)return ws(n=q.ct.apply(q,(0,i.__spreadArrays)([e],r))),new Ds(t,null,n);if(!(t instanceof As||t instanceof Ds))throw new b(w.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");return ws(n=q.ct.apply(q,(0,i.__spreadArrays)([t.path],r)).child(q.ct(e))),new Ds(t.firestore,null,n)}function Os(t,e){for(var n,r=[],o=2;o<arguments.length;o++)r[o-2]=arguments[o];if(t instanceof E&&(t=t._),1===arguments.length&&(e=v.t()),ys("doc","path",e),t instanceof xs)return _s(n=q.ct.apply(q,(0,i.__spreadArrays)([e],r))),new As(t,null,new z(n));if(!(t instanceof As||t instanceof Ds))throw new b(w.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");return _s(n=t.D_.child(q.ct.apply(q,(0,i.__spreadArrays)([e],r)))),new As(t.firestore,t instanceof Ds?t.v_:null,new z(n))}function Ls(t,e){return t instanceof E&&(t=t._),e instanceof E&&(e=e._),(t instanceof As||t instanceof Ds)&&(e instanceof As||e instanceof Ds)&&t.firestore===e.firestore&&t.path===e.path&&t.v_===e.v_}function Cs(t,e){return t instanceof E&&(t=t._),e instanceof E&&(e=e._),t instanceof Ss&&e instanceof Ss&&t.firestore===e.firestore&&te(t.C_,e.C_)&&t.v_===e.v_}var Ps=function(){function t(t,e){if(!isFinite(t)||t<-90||t>90)throw new b(w.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||e>180)throw new b(w.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this.x_=t,this.N_=e}return Object.defineProperty(t.prototype,"latitude",{get:function(){return this.x_},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"longitude",{get:function(){return this.N_},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){return this.x_===t.x_&&this.N_===t.N_},t.prototype.toJSON=function(){return{latitude:this.x_,longitude:this.N_}},t.prototype.K=function(t){return y(this.x_,t.x_)||y(this.N_,t.N_)},t}(),Vs=/^__.*__$/,Rs=function(){function t(t,e,n){this.data=t,this.zt=e,this.fieldTransforms=n}return t.prototype.F_=function(t,e){return null!==this.zt?new Ce(t,this.data,this.zt,e,this.fieldTransforms):new Le(t,this.data,e,this.fieldTransforms)},t}(),Us=function(){function t(t,e,n){this.data=t,this.zt=e,this.fieldTransforms=n}return t.prototype.F_=function(t,e){return new Ce(t,this.data,this.zt,e,this.fieldTransforms)},t}();function Ms(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw h()}}exports.n=Ps;var qs=function(){function t(t,e,n,r,i,o){this.settings=t,this.T=e,this.Kt=n,this.ignoreUndefinedProperties=r,void 0===i&&this.O_(),this.fieldTransforms=i||[],this.zt=o||[]}return Object.defineProperty(t.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"k_",{get:function(){return this.settings.k_},enumerable:!1,configurable:!0}),t.prototype.M_=function(e){return new t(Object.assign(Object.assign({},this.settings),e),this.T,this.Kt,this.ignoreUndefinedProperties,this.fieldTransforms,this.zt)},t.prototype.L_=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.M_({path:n,B_:!1});return r.q_(t),r},t.prototype.U_=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.M_({path:n,B_:!1});return r.O_(),r},t.prototype.Q_=function(t){return this.M_({path:void 0,B_:!0})},t.prototype.K_=function(t){return oa(t,this.settings.methodName,this.settings.W_||!1,this.path,this.settings.j_)},t.prototype.contains=function(t){return void 0!==this.zt.find(function(e){return t.st(e)})||void 0!==this.fieldTransforms.find(function(e){return t.st(e.field)})},t.prototype.O_=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.q_(this.path.get(t))},t.prototype.q_=function(t){if(0===t.length)throw this.K_("Document fields must not be empty");if(Ms(this.k_)&&Vs.test(t))throw this.K_('Document fields cannot begin and end with "__"')},t}(),Fs=function(){function t(t,e,n){this.T=t,this.ignoreUndefinedProperties=e,this.Kt=n||Lo(t)}return t.prototype.G_=function(t,e,n,r){return void 0===r&&(r=!1),new qs({k_:t,methodName:e,j_:n,path:j.at(),B_:!1,W_:r},this.T,this.Kt,this.ignoreUndefinedProperties)},t}();function js(t){var e=t.p_(),n=Lo(t.I_);return new Fs(t.I_,!!e.ignoreUndefinedProperties,n)}function zs(t,e,n,r,i,o){void 0===o&&(o={});var u=t.G_(o.merge||o.mergeFields?2:0,e,n,i);ea("Data must be an object, but it was:",u,r);var s,a,c=Zs(r,u);if(o.merge)s=new H(u.zt),a=u.fieldTransforms;else if(o.mergeFields){for(var f=[],h=0,l=o.mergeFields;h<l.length;h++){var p=na(e,l[h],n);if(!u.contains(p))throw new b(w.INVALID_ARGUMENT,"Field '"+p+"' is specified in your field mask but missing from your input data.");ua(f,p)||f.push(p)}s=new H(f),a=u.fieldTransforms.filter(function(t){return s.It(t.field)})}else s=null,a=u.fieldTransforms;return new Rs(new yt(c),s,a)}var Gs=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return(0,i.__extends)(e,t),e.prototype.z_=function(t){if(2!==t.k_)throw 1===t.k_?t.K_(this._methodName+"() can only appear at the top level of your update data"):t.K_(this._methodName+"() cannot be used with set() unless you pass {merge:true}");return t.zt.push(t.path),null},e.prototype.isEqual=function(t){return t instanceof e},e}(vs);function Bs(t,e,n){return new qs({k_:3,j_:e.settings.j_,methodName:t._methodName,B_:n},e.T,e.Kt,e.ignoreUndefinedProperties)}var Ks=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return(0,i.__extends)(e,t),e.prototype.z_=function(t){return new Ie(t.path,new de)},e.prototype.isEqual=function(t){return t instanceof e},e}(vs),Hs=function(t){function e(e,n){var r=this;return(r=t.call(this,e)||this).H_=n,r}return(0,i.__extends)(e,t),e.prototype.z_=function(t){var e=Bs(this,t,!0),n=this.H_.map(function(t){return $s(t,e)}),r=new ve(n);return new Ie(t.path,r)},e.prototype.isEqual=function(t){return this===t},e}(vs),Js=function(t){function e(e,n){var r=this;return(r=t.call(this,e)||this).H_=n,r}return(0,i.__extends)(e,t),e.prototype.z_=function(t){var e=Bs(this,t,!0),n=this.H_.map(function(t){return $s(t,e)}),r=new ge(n);return new Ie(t.path,r)},e.prototype.isEqual=function(t){return this===t},e}(vs),Ws=function(t){function e(e,n){var r=this;return(r=t.call(this,e)||this).J_=n,r}return(0,i.__extends)(e,t),e.prototype.z_=function(t){var e=new _e(t.Kt,ce(t.Kt,this.J_));return new Ie(t.path,e)},e.prototype.isEqual=function(t){return this===t},e}(vs);function Qs(t,e,n,r){var i=t.G_(1,e,n);ea("Data must be an object, but it was:",i,r);var o=[],u=new gt;B(r,function(t,r){var s=ia(e,t,n);r instanceof E&&(r=r._);var a=i.U_(s);if(r instanceof Gs)o.push(s);else{var c=$s(r,a);null!=c&&(o.push(s),u.set(s,c))}});var s=new H(o);return new Us(u.yt(),s,i.fieldTransforms)}function Ys(t,e,n,r,i,o){var u=t.G_(1,e,n),s=[na(e,r,n)],a=[i];if(o.length%2!=0)throw new b(w.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var c=0;c<o.length;c+=2)s.push(na(e,o[c])),a.push(o[c+1]);for(var f=[],h=new gt,l=s.length-1;l>=0;--l)if(!ua(f,s[l])){var p=s[l],d=a[l];d instanceof E&&(d=d._);var v=u.U_(p);if(d instanceof Gs)f.push(p);else{var y=$s(d,v);null!=y&&(f.push(p),h.set(p,y))}}var g=new H(f);return new Us(h.yt(),g,u.fieldTransforms)}function Xs(t,e,n,r){return void 0===r&&(r=!1),$s(n,t.G_(r?4:3,e))}function $s(t,e){if(t instanceof E&&(t=t._),ta(t))return ea("Unsupported field value:",e,t),Zs(t,e);if(t instanceof vs)return function(t,e){if(!Ms(e.k_))throw e.K_(t._methodName+"() can only be used with update() and set()");if(!e.path)throw e.K_(t._methodName+"() is not currently supported inside arrays");var n=t.z_(e);n&&e.fieldTransforms.push(n)}(t,e),null;if(e.path&&e.zt.push(e.path),t instanceof Array){if(e.settings.B_&&4!==e.k_)throw e.K_("Nested arrays are not supported");return function(t,e){for(var n=[],r=0,i=0,o=t;i<o.length;i++){var u=$s(o[i],e.Q_(r));null==u&&(u={nullValue:"NULL_VALUE"}),n.push(u),r++}return{arrayValue:{values:n}}}(t,e)}return function(t,e){if(t instanceof E&&(t=t._),null===t)return{nullValue:"NULL_VALUE"};if("number"==typeof t)return ce(e.Kt,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=R.fromDate(t);return{timestampValue:En(e.Kt,n)}}if(t instanceof R)return n=new R(t.seconds,1e3*Math.floor(t.nanoseconds/1e3)),{timestampValue:En(e.Kt,n)};if(t instanceof Ps)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof I)return{bytesValue:Tn(e.Kt,t.l)};if(t instanceof As){n=e.T;var r=t.firestore.I_;if(!r.isEqual(n))throw e.K_("Document reference is for database "+r.projectId+"/"+r.database+" but should be for database "+n.projectId+"/"+n.database);return{referenceValue:An(t.firestore.I_||e.T,t.S_.path)}}if(void 0===t&&e.ignoreUndefinedProperties)return null;throw e.K_("Unsupported field value: "+bs(t))}(t,e)}function Zs(t,e){var n={};return K(t)?e.path&&e.path.length>0&&e.zt.push(e.path):B(t,function(t,r){var i=$s(r,e.L_(t));null!=i&&(n[t]=i)}),{mapValue:{fields:n}}}function ta(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof R||t instanceof Ps||t instanceof I||t instanceof As||t instanceof vs)}function ea(t,e,n){if(!ta(n)||!function(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}(n)){var r=bs(n);throw"an object"===r?e.K_(t+" a custom object"):e.K_(t+" "+r)}}function na(t,e,n){if(e instanceof E&&(e=e._),e instanceof ds)return e.d_;if("string"==typeof e)return ia(t,e);throw oa("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}var ra=new RegExp("[~\\*/\\[\\]]");function ia(t,e,n){if(e.search(ra)>=0)throw oa("Invalid field path ("+e+"). Paths must not contain '~', '*', '/', '[', or ']'",t,!1,void 0,n);try{return(new(ds.bind.apply(ds,(0,i.__spreadArrays)([void 0],e.split("."))))).d_}catch(r){throw oa("Invalid field path ("+e+"). Paths must not be empty, begin with '.', end with '.', or contain '..'",t,!1,void 0,n)}}function oa(t,e,n,r,i){var o=r&&!r.nt(),u=void 0!==i,s="Function "+e+"() called with invalid data";n&&(s+=" (via `toFirestore()`)");var a="";return(o||u)&&(a+=" (found",o&&(a+=" in field "+r),u&&(a+=" in document "+i),a+=")"),new b(w.INVALID_ARGUMENT,(s+=". ")+t+a)}function ua(t,e){return t.some(function(t){return t.isEqual(e)})}var sa=function(){function t(t){this.Dh=t,this.Y_=new Map,this.mutations=[],this.X_=!1,this.Z_=null,this.tf=new Set}return t.prototype.ef=function(t){return(0,i.__awaiter)(this,void 0,void 0,function(){var e,n=this;return(0,i.__generator)(this,function(r){switch(r.label){case 0:if(this.nf(),this.mutations.length>0)throw new b(w.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(t,e){return(0,i.__awaiter)(this,void 0,void 0,function(){var n,r,o,u,s,a;return(0,i.__generator)(this,function(i){switch(i.label){case 0:return n=p(t),r=Cn(n.Kt)+"/documents",o={documents:e.map(function(t){return Dn(n.Kt,t)})},[4,n.Cu("BatchGetDocuments",r,o)];case 1:return u=i.sent(),s=new Map,u.forEach(function(t){var e=function(t,e){return"found"in e?function(t,e){l(!!e.found),e.found.name,e.found.updateTime;var n=kn(t,e.found.name),r=xn(e.found.updateTime),i=new yt({mapValue:{fields:e.found.fields}});return new wt(n,r,i,{})}(t,e):"missing"in e?function(t,e){l(!!e.missing),l(!!e.readTime);var n=kn(t,e.missing),r=xn(e.readTime);return new bt(n,r)}(t,e):h()}(n.Kt,t);s.set(e.key.toString(),e)}),a=[],[2,(e.forEach(function(t){var e=s.get(t.toString());l(!!e),a.push(e)}),a)]}})})}(this.Dh,t)];case 1:return[2,((e=r.sent()).forEach(function(t){t instanceof bt||t instanceof wt?n.sf(t):h()}),e)]}})})},t.prototype.set=function(t,e){this.write(e.F_(t,this.Gt(t))),this.tf.add(t.toString())},t.prototype.update=function(t,e){try{this.write(e.F_(t,this.rf(t)))}catch(t){this.Z_=t}this.tf.add(t.toString())},t.prototype.delete=function(t){this.write(new Fe(t,this.Gt(t))),this.tf.add(t.toString())},t.prototype.commit=function(){return(0,i.__awaiter)(this,void 0,void 0,function(){var t,e=this;return(0,i.__generator)(this,function(n){switch(n.label){case 0:if(this.nf(),this.Z_)throw this.Z_;return t=this.Y_,this.mutations.forEach(function(e){t.delete(e.key.toString())}),t.forEach(function(t,n){var r=z.ft(n);e.mutations.push(new je(r,e.Gt(r)))}),[4,function(t,e){return(0,i.__awaiter)(this,void 0,void 0,function(){var n,r,o;return(0,i.__generator)(this,function(i){switch(i.label){case 0:return n=p(t),r=Cn(n.Kt)+"/documents",o={writes:e.map(function(t){return Un(n.Kt,t)})},[4,n.bu("Commit",r,o)];case 1:return i.sent(),[2]}})})}(this.Dh,this.mutations)];case 1:return n.sent(),this.X_=!0,[2]}})})},t.prototype.sf=function(t){var e;if(t instanceof wt)e=t.version;else{if(!(t instanceof bt))throw h();e=U.min()}var n=this.Y_.get(t.key.toString());if(n){if(!e.isEqual(n))throw new b(w.ABORTED,"Document version changed between two reads.")}else this.Y_.set(t.key.toString(),e)},t.prototype.Gt=function(t){var e=this.Y_.get(t.toString());return!this.tf.has(t.toString())&&e?Te.updateTime(e):Te.Wt()},t.prototype.rf=function(t){var e=this.Y_.get(t.toString());if(!this.tf.has(t.toString())&&e){if(e.isEqual(U.min()))throw new b(w.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Te.updateTime(e)}return Te.exists(!0)},t.prototype.write=function(t){this.nf(),this.mutations.push(t)},t.prototype.nf=function(){},t}(),aa=function(){function t(t,e,n,r){this.fs=t,this.Dh=e,this.updateFunction=n,this.Ts=r,this.cf=5,this.zu=new Co(this.fs,"transaction_retry")}return t.prototype.run=function(){this.af()},t.prototype.af=function(){var t=this;this.zu.Bu(function(){return(0,i.__awaiter)(t,void 0,void 0,function(){var t,e,n=this;return(0,i.__generator)(this,function(r){return t=new sa(this.Dh),(e=this.uf(t))&&e.then(function(e){n.fs.ys(function(){return t.commit().then(function(){n.Ts.resolve(e)}).catch(function(t){n.hf(t)})})}).catch(function(t){n.hf(t)}),[2]})})})},t.prototype.uf=function(t){try{var e=this.updateFunction(t);return!tt(e)&&e.catch&&e.then?e:(this.Ts.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.Ts.reject(t),null}},t.prototype.hf=function(t){var e=this;this.cf>0&&this.lf(t)?(this.cf-=1,this.fs.ys(function(){return e.af(),Promise.resolve()})):this.Ts.reject(t)},t.prototype.lf=function(t){if("FirebaseError"===t.name){var e=t.code;return"aborted"===e||"failed-precondition"===e||!Ge(e)}return!1},t}(),ca=function(){function t(t,e,n){var r=this;this.credentials=t,this.fs=e,this.gu=n,this.user=D.UNAUTHENTICATED,this.clientId=v.t(),this._f=function(){},this.N=new Zn,this.credentials.S(function(t){s("FirestoreClient","Received user=",t.uid),r.user=t,r._f(t),r.N.resolve()})}return t.prototype.getConfiguration=function(){return(0,i.__awaiter)(this,void 0,void 0,function(){return(0,i.__generator)(this,function(t){switch(t.label){case 0:return[4,this.N.promise];case 1:return[2,(t.sent(),{fs:this.fs,gu:this.gu,clientId:this.clientId,credentials:this.credentials,Yl:this.user,bl:100})]}})})},t.prototype.ff=function(t){var e=this;this._f=t,this.N.promise.then(function(){return e._f(e.user)})},t.prototype.df=function(){if(this.fs.wf)throw new b(w.FAILED_PRECONDITION,"The client has already been terminated.")},t.prototype.terminate=function(){var t=this;this.fs.Ef();var e=new Zn;return this.fs.Tf(function(){return(0,i.__awaiter)(t,void 0,void 0,function(){var t,n;return(0,i.__generator)(this,function(r){switch(r.label){case 0:return r.trys.push([0,5,,6]),this.If?[4,this.If.terminate()]:[3,2];case 1:r.sent(),r.label=2;case 2:return this.mf?[4,this.mf.terminate()]:[3,4];case 3:r.sent(),r.label=4;case 4:return this.credentials.D(),e.resolve(),[3,6];case 5:return t=r.sent(),n=hr(t,"Failed to shutdown persistence"),e.reject(n),[3,6];case 6:return[2]}})})}),e.promise},t}();function fa(t,e){return(0,i.__awaiter)(this,void 0,void 0,function(){var n,r,o=this;return(0,i.__generator)(this,function(u){switch(u.label){case 0:return t.fs.Af(),s("FirestoreClient","Initializing OfflineComponentProvider"),[4,t.getConfiguration()];case 1:return n=u.sent(),[4,e.initialize(n)];case 2:return u.sent(),r=n.Yl,t.ff(function(n){r.isEqual(n)||(r=n,t.fs.bo(function(){return(0,i.__awaiter)(o,void 0,void 0,function(){return(0,i.__generator)(this,function(t){switch(t.label){case 0:return[4,Bi(e.Sh,n)];case 1:return t.sent(),[2]}})})}))}),e.persistence.yo(function(){return t.terminate()}),t.mf=e,[2]}})})}function ha(t,e){return(0,i.__awaiter)(this,void 0,void 0,function(){var n,r;return(0,i.__generator)(this,function(o){switch(o.label){case 0:return t.fs.Af(),[4,la(t)];case 1:return n=o.sent(),s("FirestoreClient","Initializing OnlineComponentProvider"),[4,t.getConfiguration()];case 2:return r=o.sent(),[4,e.initialize(n,r)];case 3:return o.sent(),t.ff(function(n){return t.fs.bo(function(){return function(t,e){return(0,i.__awaiter)(this,void 0,void 0,function(){var n,r;return(0,i.__generator)(this,function(i){switch(i.label){case 0:return(n=p(t)).fs.Af(),s("RemoteStore","RemoteStore received new credentials"),r=Wo(n),n.Fh.add(3),[4,jo(n)];case 1:return i.sent(),r&&n.Mh.set("Unknown"),[4,n.Ch.s_(e)];case 2:return i.sent(),n.Fh.delete(3),[4,Fo(n)];case 3:return i.sent(),[2]}})})}(e.gl,n)})}),t.If=e,[2]}})})}function la(t){return(0,i.__awaiter)(this,void 0,void 0,function(){return(0,i.__generator)(this,function(e){switch(e.label){case 0:return t.mf?[3,2]:(s("FirestoreClient","Using default OfflineComponentProvider"),[4,fa(t,new ss)]);case 1:e.sent(),e.label=2;case 2:return[2,t.mf]}})})}function pa(t){return(0,i.__awaiter)(this,void 0,void 0,function(){return(0,i.__generator)(this,function(e){switch(e.label){case 0:return t.If?[3,2]:(s("FirestoreClient","Using default OnlineComponentProvider"),[4,ha(t,new fs)]);case 1:e.sent(),e.label=2;case 2:return[2,t.If]}})})}function da(t){return la(t).then(function(t){return t.persistence})}function va(t){return la(t).then(function(t){return t.Sh})}function ya(t){return pa(t).then(function(t){return t.gl})}function ga(t){return pa(t).then(function(t){return t.fa})}function ma(t){return(0,i.__awaiter)(this,void 0,void 0,function(){var e,n;return(0,i.__generator)(this,function(r){switch(r.label){case 0:return[4,pa(t)];case 1:return e=r.sent(),[2,((n=e.Vl).Gh=Du.bind(null,e.fa),n.Jh=Ou.bind(null,e.fa),n)]}})})}function _a(t,e,n){var r=this;void 0===n&&(n={});var o=new Zn;return t.fs.ys(function(){return(0,i.__awaiter)(r,void 0,void 0,function(){var r;return(0,i.__generator)(this,function(i){switch(i.label){case 0:return r=function(t,e,n,r,i){var o=new ls({next:function(o){e.ys(function(){return du(t,u)});var s=o.docs.has(n);!s&&o.fromCache?i.reject(new b(w.UNAVAILABLE,"Failed to get document because the client is offline.")):s&&o.fromCache&&r&&"server"===r.source?i.reject(new b(w.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):i.resolve(o)},error:function(t){return i.reject(t)}}),u=new mu(Kt(n.path),o,{includeMetadataChanges:!0,sl:!0});return pu(t,u)},[4,ma(t)];case 1:return[2,r.apply(void 0,[i.sent(),t.fs,e,n,o])]}})})}),o.promise}function wa(t,e,n){var r=this;void 0===n&&(n={});var o=new Zn;return t.fs.ys(function(){return(0,i.__awaiter)(r,void 0,void 0,function(){var r;return(0,i.__generator)(this,function(i){switch(i.label){case 0:return r=function(t,e,n,r,i){var o=new ls({next:function(n){e.ys(function(){return du(t,u)}),n.fromCache&&"server"===r.source?i.reject(new b(w.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(n)},error:function(t){return i.reject(t)}}),u=new mu(n,o,{includeMetadataChanges:!0,sl:!0});return pu(t,u)},[4,ma(t)];case 1:return[2,r.apply(void 0,[i.sent(),t.fs,e,n,o])]}})})}),o.promise}var ba=function(){function t(){var t=this;this.Rf=Promise.resolve(),this.Pf=[],this.yf=!1,this.gf=[],this.Vf=null,this.pf=!1,this.bf=[],this.zu=new Co(this,"async_queue_retry"),this.vf=function(){var e=Oo();e&&s("AsyncQueue","Visibility state changed to "+e.visibilityState),t.zu.Uu()};var e=Oo();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.vf)}return Object.defineProperty(t.prototype,"wf",{get:function(){return this.yf},enumerable:!1,configurable:!0}),t.prototype.ys=function(t){this.enqueue(t)},t.prototype.Tf=function(t){this.Sf(),this.Df(t)},t.prototype.Ef=function(){if(!this.yf){this.yf=!0;var t=Oo();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.vf)}},t.prototype.enqueue=function(t){return this.Sf(),this.yf?new Promise(function(t){}):this.Df(t)},t.prototype.bo=function(t){var e=this;this.ys(function(){return e.Pf.push(t),e.Cf()})},t.prototype.Cf=function(){return(0,i.__awaiter)(this,void 0,void 0,function(){var t,e=this;return(0,i.__generator)(this,function(n){switch(n.label){case 0:if(0===this.Pf.length)return[3,5];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this.Pf[0]()];case 2:return n.sent(),this.Pf.shift(),this.zu.reset(),[3,4];case 3:if(!or(t=n.sent()))throw t;return s("AsyncQueue","Operation failed with retryable error: "+t),[3,4];case 4:this.Pf.length>0&&this.zu.Bu(function(){return e.Cf()}),n.label=5;case 5:return[2]}})})},t.prototype.Df=function(t){var e=this,n=this.Rf.then(function(){return e.pf=!0,t().catch(function(t){throw e.Vf=t,e.pf=!1,a("INTERNAL UNHANDLED ERROR: ",function(t){var e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+"\n"+t.stack),e}(t)),t}).then(function(t){return e.pf=!1,t})});return this.Rf=n,n},t.prototype.Ir=function(t,e,n){var r=this;this.Sf(),this.bf.indexOf(t)>-1&&(e=0);var i=fr.Is(this,t,e,n,function(t){return r.xf(t)});return this.gf.push(i),i},t.prototype.Sf=function(){this.Vf&&h()},t.prototype.Af=function(){},t.prototype.Nf=function(){return(0,i.__awaiter)(this,void 0,void 0,function(){var t;return(0,i.__generator)(this,function(e){switch(e.label){case 0:return[4,t=this.Rf];case 1:e.sent(),e.label=2;case 2:if(t!==this.Rf)return[3,0];e.label=3;case 3:return[2]}})})},t.prototype.Ff=function(t){for(var e=0,n=this.gf;e<n.length;e++)if(n[e].ds===t)return!0;return!1},t.prototype.Of=function(t){var e=this;return this.Nf().then(function(){e.gf.sort(function(t,e){return t.ws-e.ws});for(var n=0,r=e.gf;n<r.length;n++){var i=r[n];if(i.Ps(),"all"!==t&&i.ds===t)break}return e.Nf()})},t.prototype.kf=function(t){this.bf.push(t)},t.prototype.xf=function(t){var e=this.gf.indexOf(t);this.gf.splice(e,1)},t}(),Ia=-1,Ea=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n)||this).Mf=new ba,r.w_="name"in e?e.name:"[DEFAULT]",r}return(0,i.__extends)(e,t),e.prototype.b_=function(){return this.Lf||Na(this),this.Lf.terminate()},e}(xs);function Ta(t){return t.Lf||Na(t),t.Lf.df(),t.Lf}function Na(t){var e=t.p_(),n=function(t,e,n){return new A(t,e,n.host,n.ssl,n.experimentalForceLongPolling,n.experimentalAutoDetectLongPolling)}(t.I_,t.w_,e);t.Lf=new ca(t.m_,t.Mf,n)}function xa(t,e,n){var r=this,o=new Zn;return t.fs.enqueue(function(){return(0,i.__awaiter)(r,void 0,void 0,function(){var r;return(0,i.__generator)(this,function(i){switch(i.label){case 0:return i.trys.push([0,3,,4]),[4,fa(t,n)];case 1:return i.sent(),[4,ha(t,e)];case 2:return i.sent(),o.resolve(),[3,4];case 3:if(!function(t){return"FirebaseError"===t.name?t.code===w.FAILED_PRECONDITION||t.code===w.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code}(r=i.sent()))throw r;return console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+r),o.reject(r),[3,4];case 4:return[2]}})})}).then(function(){return o.promise})}function Aa(t){if(t.R_||t.P_)throw new b(w.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}exports.Z=Ea,exports.d=Ia;var Sa=function(){function t(){}return t.prototype.$f=function(t,e){switch(void 0===e&&(e="none"),rt(t)){case 0:return null;case 1:return t.booleanValue;case 2:return Q(t.integerValue||t.doubleValue);case 3:return this.Bf(t.timestampValue);case 4:return this.qf(t,e);case 5:return t.stringValue;case 6:return this.Uf(Y(t.bytesValue));case 7:return this.Qf(t.referenceValue);case 8:return this.Kf(t.geoPointValue);case 9:return this.Wf(t.arrayValue,e);case 10:return this.jf(t.mapValue,e);default:throw h()}},t.prototype.jf=function(t,e){var n=this,r={};return B(t.fields||{},function(t,i){r[t]=n.$f(i,e)}),r},t.prototype.Kf=function(t){return new Ps(Q(t.latitude),Q(t.longitude))},t.prototype.Wf=function(t,e){var n=this;return(t.values||[]).map(function(t){return n.$f(t,e)})},t.prototype.qf=function(t,e){switch(e){case"previous":var n=$(t);return null==n?null:this.$f(n,e);case"estimate":return this.Bf(Z(t));default:return null}},t.prototype.Bf=function(t){var e=W(t);return new R(e.seconds,e.nanos)},t.prototype.Gf=function(t,e){var n=q.ct(t);l($n(n));var r=new S(n.get(1),n.get(3)),i=new z(n.X(5));return r.isEqual(e)||a("Document "+i+" contains a document reference within a different database ("+r.projectId+"/"+r.database+") which is not supported. It will be treated as a reference in the current database ("+e.projectId+"/"+e.database+") instead."),i},t}(),Da=function(){function t(t,e,n,r,i){this.zf=t,this.Hf=e,this.S_=n,this.Jf=r,this.v_=i}return Object.defineProperty(t.prototype,"id",{get:function(){return this.S_.path.et()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ref",{get:function(){return new As(this.zf,this.v_,this.S_)},enumerable:!1,configurable:!0}),t.prototype.exists=function(){return null!==this.Jf},t.prototype.data=function(){if(this.Jf){if(this.v_){var t=new ka(this.zf,this.Hf,this.S_,this.Jf,null);return this.v_.fromFirestore(t)}return this.Hf.$f(this.Jf.vt())}},t.prototype.get=function(t){if(this.Jf){var e=this.Jf.data().field(Oa("DocumentSnapshot.get",t));if(null!==e)return this.Hf.$f(e)}},t}(),ka=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return(0,i.__extends)(e,t),e.prototype.data=function(){return t.prototype.data.call(this)},e}(Da);function Oa(t,e){return"string"==typeof e?ia(t,e):e instanceof E?e._.d_:e.d_}function La(t){if(Jt(t)&&0===t.Nt.length)throw new b(w.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var Ca=function(){};function Pa(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r=0,i=e;r<i.length;r++){t=i[r].Yf(t)}return t}var Va=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).Xf=e,i.Zf=n,i.td=r,i.type="where",i}return(0,i.__extends)(e,t),e.prototype.Yf=function(t){var e=js(t.firestore),n=function(t,e,n,r,i,o,u){var s;if(i.ht()){if("array-contains"===o||"array-contains-any"===o)throw new b(w.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+o+"' queries on FieldPath.documentId().");if("in"===o||"not-in"===o){za(u,o);for(var a=[],c=0,f=u;c<f.length;c++){var h=f[c];a.push(ja(r,t,h))}s={arrayValue:{values:a}}}else s=ja(r,t,u)}else"in"!==o&&"not-in"!==o&&"array-contains-any"!==o||za(u,o),s=Xs(n,"where",u,"in"===o||"not-in"===o);var l=St.create(i,o,s);return function(t,e){if(e.xt()){var n=Qt(t);if(null!==n&&!n.isEqual(e.field))throw new b(w.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '"+n.toString()+"' and '"+e.field.toString()+"'");var r=Wt(t);null!==r&&Ga(t,e.field,r)}var i=function(t,e){for(var n=0,r=t.filters;n<r.length;n++){var i=r[n];if(e.indexOf(i.op)>=0)return i.op}return null}(t,function(t){switch(e.op){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}());if(null!==i)throw i===e.op?new b(w.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+e.op.toString()+"' filter."):new b(w.INVALID_ARGUMENT,"Invalid query. You cannot use '"+e.op.toString()+"' filters with '"+i.toString()+"' filters.")}(t,l),l}(t.C_,0,e,t.firestore.I_,this.Xf,this.Zf,this.td);return new Ss(t.firestore,t.v_,function(t,e){var n=t.filters.concat([e]);return new Gt(t.path,t.collectionGroup,t.Nt.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}(t.C_,n))},e}(Ca),Ra=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).Xf=e,r.ed=n,r.type="orderBy",r}return(0,i.__extends)(e,t),e.prototype.Yf=function(t){var e=function(t,e,n){if(null!==t.startAt)throw new b(w.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new b(w.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var r=new qt(e,n);return function(t,e){if(null===Wt(t)){var n=Qt(t);null!==n&&Ga(t,n,e.field)}}(t,r),r}(t.C_,this.Xf,this.ed);return new Ss(t.firestore,t.v_,function(t,e){var n=t.Nt.concat([e]);return new Gt(t.path,t.collectionGroup,n,t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)}(t.C_,e))},e}(Ca),Ua=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).type=e,i.nd=n,i.sd=r,i}return(0,i.__extends)(e,t),e.prototype.Yf=function(t){return new Ss(t.firestore,t.v_,Zt(t.C_,this.nd,this.sd))},e}(Ca),Ma=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).type=e,i.rd=n,i.od=r,i}return(0,i.__extends)(e,t),e.prototype.Yf=function(t){var e=Fa(t,this.type,this.rd,this.od);return new Ss(t.firestore,t.v_,function(t,e){return new Gt(t.path,t.collectionGroup,t.Nt.slice(),t.filters.slice(),t.limit,t.limitType,e,t.endAt)}(t.C_,e))},e}(Ca),qa=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).type=e,i.rd=n,i.od=r,i}return(0,i.__extends)(e,t),e.prototype.Yf=function(t){var e=Fa(t,this.type,this.rd,this.od);return new Ss(t.firestore,t.v_,function(t,e){return new Gt(t.path,t.collectionGroup,t.Nt.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,e)}(t.C_,e))},e}(Ca);function Fa(t,e,n,r){if(n[0]instanceof E&&(n[0]=n[0]._),n[0]instanceof Da)return function(t,e,n,r,i){if(!r)throw new b(w.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+n+"().");for(var o=[],u=0,s=Xt(t);u<s.length;u++){var a=s[u];if(a.field.ht())o.push(ft(e,r.key));else{var c=r.field(a.field);if(X(c))throw new b(w.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+a.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===c){var f=a.field.ot();throw new b(w.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+f+"' (used as the orderBy) does not exist.")}o.push(c)}}return new Ut(o,i)}(t.C_,t.firestore.I_,e,n[0].Jf,r);var i=js(t.firestore);return function(t,e,n,r,i,o){var u=t.Nt;if(i.length>u.length)throw new b(w.INVALID_ARGUMENT,"Too many arguments provided to "+r+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var s=[],a=0;a<i.length;a++){var c=i[a];if(u[a].field.ht()){if("string"!=typeof c)throw new b(w.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+r+"(), but got a "+typeof c);if(!Yt(t)&&-1!==c.indexOf("/"))throw new b(w.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+r+"() must be a plain document ID, but '"+c+"' contains a slash.");var f=t.path.child(q.ct(c));if(!z.Et(f))throw new b(w.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+r+"() must result in a valid document path, but '"+f+"' is not because it contains an odd number of segments.");var h=new z(f);s.push(ft(e,h))}else{var l=Xs(n,r,c);s.push(l)}}return new Ut(s,o)}(t.C_,t.firestore.I_,i,e,n,r)}function ja(t,e,n){if(n instanceof E&&(n=n._),"string"==typeof n){if(""===n)throw new b(w.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!Yt(e)&&-1!==n.indexOf("/"))throw new b(w.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+n+"' contains a '/' character.");var r=e.path.child(q.ct(n));if(!z.Et(r))throw new b(w.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+r+"' is not because it has an odd number of segments ("+r.length+").");return ft(t,new z(r))}if(n instanceof As)return ft(t,n.S_);throw new b(w.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+bs(n)+".")}function za(t,e){if(!Array.isArray(t)||0===t.length)throw new b(w.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(t.length>10)throw new b(w.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.")}function Ga(t,e,n){if(!n.isEqual(e))throw new b(w.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '"+e.toString()+"' and so you must also use '"+e.toString()+"' as your first argument to orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}function Ba(t){return function(t,e){if("object"!=typeof t||null===t)return!1;for(var n=t,r=0,i=["next","error","complete"];r<i.length;r++){var o=i[r];if(o in n&&"function"==typeof n[o])return!0}return!1}(t)}function Ka(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}var Ha=function(t){function e(e){var n=this;return(n=t.call(this)||this).firestore=e,n}return(0,i.__extends)(e,t),e.prototype.Uf=function(t){return new I(t)},e.prototype.Qf=function(t){var e=this.Gf(t,this.firestore.I_);return new As(this.firestore,null,e)},e}(Sa),Ja=function(){function t(t,e){this.hasPendingWrites=t,this.fromCache=e}return t.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},t}(),Wa=function(t){function e(e,n,r,i,o,u){var s=this;return(s=t.call(this,e,n,r,i,u)||this).zf=e,s.ad=e,s.metadata=o,s}return(0,i.__extends)(e,t),e.prototype.exists=function(){return t.prototype.exists.call(this)},e.prototype.data=function(t){if(void 0===t&&(t={}),this.Jf){if(this.v_){var e=new Qa(this.zf,this.Hf,this.S_,this.Jf,this.metadata,null);return this.v_.fromFirestore(e,t)}return this.Hf.$f(this.Jf.vt(),t.serverTimestamps)}},e.prototype.get=function(t,e){if(void 0===e&&(e={}),this.Jf){var n=this.Jf.data().field(Oa("DocumentSnapshot.get",t));if(null!==n)return this.Hf.$f(n,e.serverTimestamps)}},e}(Da),Qa=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return(0,i.__extends)(e,t),e.prototype.data=function(e){return void 0===e&&(e={}),t.prototype.data.call(this,e)},e}(Wa),Ya=function(){function t(t,e,n,r){this.zf=t,this.Hf=e,this.ud=r,this.metadata=new Ja(r.hasPendingWrites,r.fromCache),this.query=n}return Object.defineProperty(t.prototype,"docs",{get:function(){var t=[];return this.forEach(function(e){return t.push(e)}),t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this.ud.docs.size},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"empty",{get:function(){return 0===this.size},enumerable:!1,configurable:!0}),t.prototype.forEach=function(t,e){var n=this;this.ud.docs.forEach(function(r){t.call(e,new Qa(n.zf,n.Hf,r.key,r,new Ja(n.ud.Ce.has(r.key),n.ud.fromCache),n.query.v_))})},t.prototype.docChanges=function(t){void 0===t&&(t={});var e=!!t.includeMetadataChanges;if(e&&this.ud.Ne)throw new b(w.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this.hd&&this.ld===e||(this.hd=function(t,e){if(t.ud.De.nt()){var n=0;return t.ud.docChanges.map(function(e){var r=new Qa(t.zf,t.Hf,e.doc.key,e.doc,new Ja(t.ud.Ce.has(e.doc.key),t.ud.fromCache),t.query.v_);return e.doc,{type:"added",doc:r,oldIndex:-1,newIndex:n++}})}var r=t.ud.De;return t.ud.docChanges.filter(function(t){return e||3!==t.type}).map(function(e){var n=new Qa(t.zf,t.Hf,e.doc.key,e.doc,new Ja(t.ud.Ce.has(e.doc.key),t.ud.fromCache),t.query.v_),i=-1,o=-1;return 0!==e.type&&(i=r.indexOf(e.doc.key),r=r.delete(e.doc.key)),1!==e.type&&(o=(r=r.add(e.doc)).indexOf(e.doc.key)),{type:Xa(e.type),doc:n,oldIndex:i,newIndex:o}})}(this,e),this.ld=e),this.hd},t}();function Xa(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return h()}}function $a(t,e){return t instanceof Wa&&e instanceof Wa?t.zf===e.zf&&t.S_.isEqual(e.S_)&&(null===t.Jf?null===e.Jf:t.Jf.isEqual(e.Jf))&&t.v_===e.v_:t instanceof Ya&&e instanceof Ya&&t.zf===e.zf&&Cs(t.query,e.query)&&t.metadata.isEqual(e.metadata)&&t.ud.isEqual(e.ud)}var Za=function(t){function e(e){var n=this;return(n=t.call(this)||this).firestore=e,n}return(0,i.__extends)(e,t),e.prototype.Uf=function(t){return new I(t)},e.prototype.Qf=function(t){var e=this.Gf(t,this.firestore.I_);return new As(this.firestore,null,e)},e}(Sa);function tc(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];t=Is(t,As);var o=Is(t.firestore,Ea),u=js(o);return e instanceof E&&(e=e._),nc(o,[("string"==typeof e||e instanceof ds?Ys(u,"updateDoc",t.S_,e,n,r):Qs(u,"updateDoc",t.S_,e)).F_(t.S_,Te.exists(!0))])}function ec(t){for(var e,n,r,o=[],u=1;u<arguments.length;u++)o[u-1]=arguments[u];t instanceof E&&(t=t._);var s={includeMetadataChanges:!1},a=0;"object"!=typeof o[a]||Ba(o[a])||(s=o[a],a++);var c,f,h,l={includeMetadataChanges:s.includeMetadataChanges};if(Ba(o[a])){var p=o[a];o[a]=null===(e=p.next)||void 0===e?void 0:e.bind(p),o[a+1]=null===(n=p.error)||void 0===n?void 0:n.bind(p),o[a+2]=null===(r=p.complete)||void 0===r?void 0:r.bind(p)}if(t instanceof As)f=Is(t.firestore,Ea),h=Kt(t.S_.path),c={next:function(e){o[a]&&o[a](rc(f,t,e))},error:o[a+1],complete:o[a+2]};else{var d=Is(t,Ss);f=Is(d.firestore,Ea),h=d.C_;var v=new Za(f);c={next:function(t){o[a]&&o[a](new Ya(f,v,d,t))},error:o[a+1],complete:o[a+2]},La(t.C_)}return function(t,e,n,r){var o=this,u=new ls(c),s=new mu(e,u,n);return t.fs.ys(function(){return(0,i.__awaiter)(o,void 0,void 0,function(){var e;return(0,i.__generator)(this,function(n){switch(n.label){case 0:return e=pu,[4,ma(t)];case 1:return[2,e.apply(void 0,[n.sent(),s])]}})})}),function(){u.r_(),t.fs.ys(function(){return(0,i.__awaiter)(o,void 0,void 0,function(){var e;return(0,i.__generator)(this,function(n){switch(n.label){case 0:return e=du,[4,ma(t)];case 1:return[2,e.apply(void 0,[n.sent(),s])]}})})})}}(Ta(f),h,l)}function nc(t,e){return function(t,e){var n=this,r=new Zn;return t.fs.ys(function(){return(0,i.__awaiter)(n,void 0,void 0,function(){var n;return(0,i.__generator)(this,function(i){switch(i.label){case 0:return n=Lu,[4,ga(t)];case 1:return[2,n.apply(void 0,[i.sent(),e,r])]}})})}),r.promise}(Ta(t),e)}function rc(t,e,n){var r=n.docs.get(e.S_),i=new Za(t);return new Wa(t,i,e.S_,r,new Ja(n.hasPendingWrites,n.fromCache),e.v_)}var ic=function(){function t(t,e){this.zf=t,this._d=e,this.fd=[],this.dd=!1,this.wd=js(t)}return t.prototype.set=function(t,e,n){this.Ed();var r=oc(t,this.zf),i=Ka(r.v_,e,n),o=zs(this.wd,"WriteBatch.set",r.S_,i,null!==r.v_,n);return this.fd.push(o.F_(r.S_,Te.Wt())),this},t.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];this.Ed();var o,u=oc(t,this.zf);return e instanceof E&&(e=e._),o="string"==typeof e||e instanceof ds?Ys(this.wd,"WriteBatch.update",u.S_,e,n,r):Qs(this.wd,"WriteBatch.update",u.S_,e),this.fd.push(o.F_(u.S_,Te.exists(!0))),this},t.prototype.delete=function(t){this.Ed();var e=oc(t,this.zf);return this.fd=this.fd.concat(new Fe(e.S_,Te.Wt())),this},t.prototype.commit=function(){return this.Ed(),this.dd=!0,this.fd.length>0?this._d(this.fd):Promise.resolve()},t.prototype.Ed=function(){if(this.dd)throw new b(w.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},t}();function oc(t,e){if(t instanceof E&&(t=t._),t.firestore!==e)throw new b(w.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}var uc=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n)||this).zf=e,r}return(0,i.__extends)(e,t),e.prototype.get=function(e){var n=this,r=oc(e,this.zf),i=new Za(this.zf);return t.prototype.get.call(this,e).then(function(t){return new Wa(n.zf,i,r.S_,t.Jf,new Ja(!1,!1),r.v_)})},e}(function(){function t(t,e){this.zf=t,this.Td=e,this.wd=js(t)}return t.prototype.get=function(t){var e=this,n=oc(t,this.zf),r=new Ha(this.zf);return this.Td.ef([n.S_]).then(function(t){if(!t||1!==t.length)return h();var i=t[0];if(i instanceof bt)return new Da(e.zf,r,n.S_,null,n.v_);if(i instanceof wt)return new Da(e.zf,r,i.key,i,n.v_);throw h()})},t.prototype.set=function(t,e,n){var r=oc(t,this.zf),i=Ka(r.v_,e,n),o=zs(this.wd,"Transaction.set",r.S_,i,null!==r.v_,n);return this.Td.set(r.S_,o),this},t.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];var o,u=oc(t,this.zf);return e instanceof E&&(e=e._),o="string"==typeof e||e instanceof ds?Ys(this.wd,"Transaction.update",u.S_,e,n,r):Qs(this.wd,"Transaction.update",u.S_,e),this.Td.update(u.S_,o),this},t.prototype.delete=function(t){var e=oc(t,this.zf);return this.Td.delete(e.S_),this},t}()),sc=function(){function t(){}return t.prototype.enableIndexedDbPersistence=function(t,e){return function(t,e){Aa(t=Is(t,Ea));var n=Ta(t),r=t.p_(),i=new fs;return xa(n,i,new as(i,r.cacheSizeBytes,null==e?void 0:e.forceOwnership))}(t._,{forceOwnership:e})},t.prototype.enableMultiTabIndexedDbPersistence=function(t){return function(t){Aa(t=Is(t,Ea));var e=Ta(t),n=t.p_(),r=new fs;return xa(e,r,new cs(r,n.cacheSizeBytes))}(t._)},t.prototype.clearIndexedDbPersistence=function(t){return function(t){var e=this;if(t.R_&&!t.P_)throw new b(w.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");var n=new Zn;return t.Mf.Tf(function(){return(0,i.__awaiter)(e,void 0,void 0,function(){var e;return(0,i.__generator)(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,function(t){return(0,i.__awaiter)(this,void 0,void 0,function(){var e;return(0,i.__generator)(this,function(n){switch(n.label){case 0:return nr.Wn()?(e=t+"main",[4,nr.delete(e)]):[2,Promise.resolve()];case 1:return n.sent(),[2]}})})}(Ui(t.I_,t.w_))];case 1:return r.sent(),n.resolve(),[3,3];case 2:return e=r.sent(),n.reject(e),[3,3];case 3:return[2]}})})}),n.promise}(t._)},t}(),ac=function(t){function e(e,n,r){var i=this;return(i=t.call(this,n)||this).Id=r,i.INTERNAL={delete:function(){return i.terminate()}},e instanceof S||(i.md=e),i}return(0,i.__extends)(e,t),Object.defineProperty(e.prototype,"I_",{get:function(){return this._.I_},enumerable:!1,configurable:!0}),e.prototype.settings=function(t){t.merge&&delete(t=Object.assign(Object.assign({},this._.V_()),t)).merge,this._.g_(t)},e.prototype.useEmulator=function(t,e){!function(t,e,n){var r=(t=Is(t,xs)).V_();"firestore.googleapis.com"!==r.host&&r.host!==e&&c("Host has been set in both settings() and useEmulator(), emulator host will be used"),t.g_(Object.assign(Object.assign({},r),{host:e+":"+n,ssl:!1}))}(this._,t,e)},e.prototype.enableNetwork=function(){return function(t){var e=this;return t.fs.enqueue(function(){return(0,i.__awaiter)(e,void 0,void 0,function(){var e,n;return(0,i.__generator)(this,function(r){switch(r.label){case 0:return[4,da(t)];case 1:return e=r.sent(),[4,ya(t)];case 2:return n=r.sent(),[2,(e.Vo(!0),function(t){var e=p(n);return e.Fh.delete(0),Fo(e)}())]}})})})}(Ta(Is(this._,Ea)))},e.prototype.disableNetwork=function(){return function(t){var e=this;return t.fs.enqueue(function(){return(0,i.__awaiter)(e,void 0,void 0,function(){var e,n;return(0,i.__generator)(this,function(r){switch(r.label){case 0:return[4,da(t)];case 1:return e=r.sent(),[4,ya(t)];case 2:return n=r.sent(),[2,(e.Vo(!1),function(t){return(0,i.__awaiter)(this,void 0,void 0,function(){var e;return(0,i.__generator)(this,function(n){switch(n.label){case 0:return(e=p(t)).Fh.add(0),[4,jo(e)];case 1:return n.sent(),e.Mh.set("Offline"),[2]}})})}(n))]}})})})}(Ta(Is(this._,Ea)))},e.prototype.enablePersistence=function(t){var e=!1,n=!1;return t&&ms("synchronizeTabs",e=!!t.synchronizeTabs,"experimentalForceOwningTab",n=!!t.experimentalForceOwningTab),e?this.Id.enableMultiTabIndexedDbPersistence(this):this.Id.enableIndexedDbPersistence(this,n)},e.prototype.clearPersistence=function(){return this.Id.clearIndexedDbPersistence(this)},e.prototype.terminate=function(){return this.md&&(this.md._removeServiceInstance("firestore"),this.md._removeServiceInstance("firestore-exp")),this._._delete()},e.prototype.waitForPendingWrites=function(){return function(t){var e=this,n=new Zn;return t.fs.ys(function(){return(0,i.__awaiter)(e,void 0,void 0,function(){var e;return(0,i.__generator)(this,function(r){switch(r.label){case 0:return e=Mu,[4,ga(t)];case 1:return[2,e.apply(void 0,[r.sent(),n])]}})})}),n.promise}(Ta(Is(this._,Ea)))},e.prototype.onSnapshotsInSync=function(t){return function(t,e){return function(t,e){var n=this,r=new ls(e);return t.fs.ys(function(){return(0,i.__awaiter)(n,void 0,void 0,function(){var e;return(0,i.__generator)(this,function(n){switch(n.label){case 0:return e=function(t,e){p(t).jh.add(e),e.next()},[4,ma(t)];case 1:return[2,e.apply(void 0,[n.sent(),r])]}})})}),function(){r.r_(),t.fs.ys(function(){return(0,i.__awaiter)(n,void 0,void 0,function(){var e;return(0,i.__generator)(this,function(n){switch(n.label){case 0:return e=function(t,e){p(t).jh.delete(e)},[4,ma(t)];case 1:return[2,e.apply(void 0,[n.sent(),r])]}})})})}}(Ta(t=Is(t,Ea)),Ba(e)?e:{next:e})}(this._,t)},Object.defineProperty(e.prototype,"app",{get:function(){if(!this.md)throw new b(w.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.md},enumerable:!1,configurable:!0}),e.prototype.collection=function(t){try{return new Ec(this,ks(this._,t))}catch(t){throw vc(t,"collection()","Firestore.collection()")}},e.prototype.doc=function(t){try{return new dc(this,Os(this._,t))}catch(t){throw vc(t,"doc()","Firestore.doc()")}},e.prototype.collectionGroup=function(t){try{return new wc(this,function(t,e){if(t=Is(t,xs),ys("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new b(w.INVALID_ARGUMENT,"Invalid collection ID '"+e+"' passed to function collectionGroup(). Collection IDs must not contain '/'.");return new Ss(t,null,function(t){return new Gt(q.at(),t)}(e))}(this._,t))}catch(t){throw vc(t,"collectionGroup()","Firestore.collectionGroup()")}},e.prototype.runTransaction=function(t){var e=this;return function(t,e){return function(t,e){var n=this,r=new Zn;return t.fs.ys(function(){return(0,i.__awaiter)(n,void 0,void 0,function(){var n;return(0,i.__generator)(this,function(i){switch(i.label){case 0:return[4,function(t){return pa(t).then(function(t){return t.Dh})}(t)];case 1:return n=i.sent(),new aa(t.fs,n,e,r).run(),[2]}})})}),r.promise}(Ta(t),function(n){return e(new uc(t,n))})}(this._,function(n){return t(new hc(e,n))})},e.prototype.batch=function(){var t=this;return Ta(this._),new lc(new ic(this._,function(e){return nc(t._,e)}))},e.prototype.loadBundle=function(t){throw new b(w.FAILED_PRECONDITION,'"loadBundle()" does not exist, have you imported "firebase/firestore/bundle"?')},e.prototype.namedQuery=function(t){throw new b(w.FAILED_PRECONDITION,'"namedQuery()" does not exist, have you imported "firebase/firestore/bundle"?')},e}(E),cc=function(t){function e(e){var n=this;return(n=t.call(this)||this).firestore=e,n}return(0,i.__extends)(e,t),e.prototype.Uf=function(t){return new x(new I(t))},e.prototype.Qf=function(t){var e=this.Gf(t,this.firestore.I_);return dc.Ad(e,this.firestore,null)},e}(Sa);function fc(t){var e;e=t,o.setLogLevel(e)}exports.U=ac,exports.q=sc;var hc=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).zf=e,r.Hf=new cc(e),r}return(0,i.__extends)(e,t),e.prototype.get=function(t){var e=this,n=Tc(t);return this._.get(n).then(function(t){return new mc(e.zf,new Wa(e.zf._,e.Hf,t.S_,t.Jf,t.metadata,n.v_))})},e.prototype.set=function(t,e,n){var r=Tc(t);return n?(gs("Transaction.set",n),this._.set(r,e,n)):this._.set(r,e),this},e.prototype.update=function(t,e,n){for(var r,o=[],u=3;u<arguments.length;u++)o[u-3]=arguments[u];var s=Tc(t);return 2===arguments.length?this._.update(s,e):(r=this._).update.apply(r,(0,i.__spreadArrays)([s,e,n],o)),this},e.prototype.delete=function(t){var e=Tc(t);return this._.delete(e),this},e}(E),lc=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return(0,i.__extends)(e,t),e.prototype.set=function(t,e,n){var r=Tc(t);return n?(gs("WriteBatch.set",n),this._.set(r,e,n)):this._.set(r,e),this},e.prototype.update=function(t,e,n){for(var r,o=[],u=3;u<arguments.length;u++)o[u-3]=arguments[u];var s=Tc(t);return 2===arguments.length?this._.update(s,e):(r=this._).update.apply(r,(0,i.__spreadArrays)([s,e,n],o)),this},e.prototype.delete=function(t){var e=Tc(t);return this._.delete(e),this},e.prototype.commit=function(){return this._.commit()},e}(E),pc=function(t){function e(e,n,r){var i=this;return(i=t.call(this,r)||this).zf=e,i.Hf=n,i}return(0,i.__extends)(e,t),e.prototype.fromFirestore=function(t,e){var n=new Qa(this.zf._,this.Hf,t.S_,t.Jf,t.metadata,null);return this._.fromFirestore(new _c(this.zf,n),null!=e?e:{})},e.prototype.toFirestore=function(t,e){return e?this._.toFirestore(t,e):this._.toFirestore(t)},e.Rd=function(t,n){var r=e.Pd,i=r.get(t);i||(i=new WeakMap,r.set(t,i));var o=i.get(n);return o||(o=new e(t,new cc(t),n),i.set(n,o)),o},e}(E);exports.j=lc,exports.W=hc,pc.Pd=new WeakMap;var dc=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).firestore=e,r.Hf=new cc(e),r}return(0,i.__extends)(e,t),e.yd=function(t,n,r){if(t.length%2!=0)throw new b(w.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t.ot()+" has "+t.length);return new e(n,new As(n._,r,new z(t)))},e.Ad=function(t,n,r){return new e(n,new As(n._,r,t))},Object.defineProperty(e.prototype,"id",{get:function(){return this._.id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){return new Ec(this.firestore,this._.parent)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this._.path},enumerable:!1,configurable:!0}),e.prototype.collection=function(t){try{return new Ec(this.firestore,ks(this._,t))}catch(t){throw vc(t,"collection()","DocumentReference.collection()")}},e.prototype.isEqual=function(t){return t instanceof E&&(t=t._),t instanceof As&&Ls(this._,t)},e.prototype.set=function(t,e){e=gs("DocumentReference.set",e);try{return function(t,e,n){t=Is(t,As);var r=Is(t.firestore,Ea),i=Ka(t.v_,e,n);return nc(r,[zs(js(r),"setDoc",t.S_,i,null!==t.v_,n).F_(t.S_,Te.Wt())])}(this._,t,e)}catch(t){throw vc(t,"setDoc()","DocumentReference.set()")}},e.prototype.update=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];try{return 1===arguments.length?tc(this._,t):tc.apply(void 0,(0,i.__spreadArrays)([this._,t,e],n))}catch(t){throw vc(t,"updateDoc()","DocumentReference.update()")}},e.prototype.delete=function(){return nc(Is((t=this._).firestore,Ea),[new Fe(t.S_,Te.Wt())]);var t},e.prototype.onSnapshot=function(){for(var t=this,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=yc(e),i=gc(e,function(e){return new mc(t.firestore,new Wa(t.firestore._,t.Hf,e.S_,e.Jf,e.metadata,t._.v_))});return ec(this._,r,i)},e.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(t){t=Is(t,As);var e=Is(t.firestore,Ea),n=Ta(e),r=new Za(e);return function(t,e){var n=this,r=new Zn;return t.fs.ys(function(){return(0,i.__awaiter)(n,void 0,void 0,function(){var n;return(0,i.__generator)(this,function(o){switch(o.label){case 0:return n=function(t,e,n){return(0,i.__awaiter)(this,void 0,void 0,function(){var r,o;return(0,i.__generator)(this,function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,function(t,e){var n=p(t);return n.persistence.runTransaction("read document","readonly",function(t){return n.Ic.Jo(t,e)})}(t,e)];case 1:return(o=i.sent())instanceof wt?n.resolve(o):o instanceof bt?n.resolve(null):n.reject(new b(w.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return r=i.sent(),o=hr(r,"Failed to get document '"+e+" from cache"),n.reject(o),[3,3];case 3:return[2]}})})},[4,va(t)];case 1:return[2,n.apply(void 0,[o.sent(),e,r])]}})})}),r.promise}(n,t.S_).then(function(n){return new Wa(e,r,t.S_,n,new Ja(n instanceof wt&&n.bt,!0),t.v_)})}(this._):"server"===(null==t?void 0:t.source)?function(t){t=Is(t,As);var e=Is(t.firestore,Ea);return _a(Ta(e),t.S_,{source:"server"}).then(function(n){return rc(e,t,n)})}(this._):function(t){t=Is(t,As);var e=Is(t.firestore,Ea);return _a(Ta(e),t.S_).then(function(n){return rc(e,t,n)})}(this._)).then(function(t){return new mc(e.firestore,new Wa(e.firestore._,e.Hf,t.S_,t.Jf,t.metadata,e._.v_))})},e.prototype.withConverter=function(t){return new e(this.firestore,this._.withConverter(pc.Rd(this.firestore,t)))},e}(E);function vc(t,e,n){return t.message=t.message.replace(e,n),t}function yc(t){for(var e=0,n=t;e<n.length;e++){var r=n[e];if("object"==typeof r&&!Ba(r))return r}return{}}function gc(t,e){var n,r,i;return{next:function(t){i.next&&i.next(e(t))},error:null===(n=(i=Ba(t[0])?t[0]:Ba(t[1])?t[1]:"function"==typeof t[0]?{next:t[0],error:t[1],complete:t[2]}:{next:t[1],error:t[2],complete:t[3]}).error)||void 0===n?void 0:n.bind(i),complete:null===(r=i.complete)||void 0===r?void 0:r.bind(i)}}exports.a=dc;var mc=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).zf=e,r}return(0,i.__extends)(e,t),Object.defineProperty(e.prototype,"ref",{get:function(){return new dc(this.zf,this._.ref)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"id",{get:function(){return this._.id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"metadata",{get:function(){return this._.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"exists",{get:function(){return this._.exists()},enumerable:!1,configurable:!0}),e.prototype.data=function(t){return this._.data(t)},e.prototype.get=function(t,e){return this._.get(t,e)},e.prototype.isEqual=function(t){return $a(this._,t._)},e}(E),_c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return(0,i.__extends)(e,t),e.prototype.data=function(t){return this._.data(t)},e}(mc),wc=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).firestore=e,r.Hf=new cc(e),r}return(0,i.__extends)(e,t),e.prototype.where=function(t,n,r){try{return new e(this.firestore,Pa(this._,function(t,e,n){var r=e,i=Oa("where",t);return new Va(i,r,n)}(t,n,r)))}catch(t){throw vc(t,/(orderBy|where)\(\)/,"Query.$1()")}},e.prototype.orderBy=function(t,n){try{return new e(this.firestore,Pa(this._,function(t,e){void 0===e&&(e="asc");var n=e,r=Oa("orderBy",t);return new Ra(r,n)}(t,n)))}catch(t){throw vc(t,/(orderBy|where)\(\)/,"Query.$1()")}},e.prototype.limit=function(t){try{return new e(this.firestore,Pa(this._,function(t){return Es("limit",t),new Ua("limit",t,"F")}(t)))}catch(t){throw vc(t,"limit()","Query.limit()")}},e.prototype.limitToLast=function(t){try{return new e(this.firestore,Pa(this._,function(t){return Es("limitToLast",t),new Ua("limitToLast",t,"L")}(t)))}catch(t){throw vc(t,"limitToLast()","Query.limitToLast()")}},e.prototype.startAt=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return new e(this.firestore,Pa(this._,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Ma("startAt",t,!0)}.apply(void 0,t)))}catch(t){throw vc(t,"startAt()","Query.startAt()")}},e.prototype.startAfter=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return new e(this.firestore,Pa(this._,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Ma("startAfter",t,!1)}.apply(void 0,t)))}catch(t){throw vc(t,"startAfter()","Query.startAfter()")}},e.prototype.endBefore=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return new e(this.firestore,Pa(this._,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new qa("endBefore",t,!0)}.apply(void 0,t)))}catch(t){throw vc(t,"endBefore()","Query.endBefore()")}},e.prototype.endAt=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return new e(this.firestore,Pa(this._,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new qa("endAt",t,!1)}.apply(void 0,t)))}catch(t){throw vc(t,"endAt()","Query.endAt()")}},e.prototype.isEqual=function(t){return Cs(this._,t._)},e.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(t){t=Is(t,Ss);var e=Is(t.firestore,Ea),n=Ta(e),r=new Za(e);return function(t,e){var n=this,r=new Zn;return t.fs.ys(function(){return(0,i.__awaiter)(n,void 0,void 0,function(){var n;return(0,i.__generator)(this,function(o){switch(o.label){case 0:return n=function(t,e,n){return(0,i.__awaiter)(this,void 0,void 0,function(){var r,o,u,s,a;return(0,i.__generator)(this,function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,$i(t,e,!0)];case 1:return a=i.sent(),r=new Nu(e,a.Pc),o=r.dl(a.documents),u=r.Ei(o,!1),n.resolve(u.snapshot),[3,3];case 2:return s=i.sent(),a=hr(s,"Failed to execute query '"+e+" against cache"),n.reject(a),[3,3];case 3:return[2]}})})},[4,va(t)];case 1:return[2,n.apply(void 0,[o.sent(),e,r])]}})})}),r.promise}(n,t.C_).then(function(n){return new Ya(e,r,t,n)})}(this._):"server"===(null==t?void 0:t.source)?function(t){t=Is(t,Ss);var e=Is(t.firestore,Ea),n=Ta(e),r=new Za(e);return wa(n,t.C_,{source:"server"}).then(function(n){return new Ya(e,r,t,n)})}(this._):function(t){t=Is(t,Ss);var e=Is(t.firestore,Ea),n=Ta(e),r=new Za(e);return La(t.C_),wa(n,t.C_).then(function(n){return new Ya(e,r,t,n)})}(this._)).then(function(t){return new Ic(e.firestore,new Ya(e.firestore._,e.Hf,e._,t.ud))})},e.prototype.onSnapshot=function(){for(var t=this,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=yc(e),i=gc(e,function(e){return new Ic(t.firestore,new Ya(t.firestore._,t.Hf,t._,e.ud))});return ec(this._,r,i)},e.prototype.withConverter=function(t){return new e(this.firestore,this._.withConverter(pc.Rd(this.firestore,t)))},e}(E),bc=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).zf=e,r}return(0,i.__extends)(e,t),Object.defineProperty(e.prototype,"type",{get:function(){return this._.type},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"doc",{get:function(){return new _c(this.zf,this._.doc)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"oldIndex",{get:function(){return this._.oldIndex},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"newIndex",{get:function(){return this._.newIndex},enumerable:!1,configurable:!0}),e}(E),Ic=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).zf=e,r}return(0,i.__extends)(e,t),Object.defineProperty(e.prototype,"query",{get:function(){return new wc(this.zf,this._.query)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"metadata",{get:function(){return this._.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"size",{get:function(){return this._.size},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"empty",{get:function(){return this._.empty},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"docs",{get:function(){var t=this;return this._.docs.map(function(e){return new _c(t.zf,e)})},enumerable:!1,configurable:!0}),e.prototype.docChanges=function(t){var e=this;return this._.docChanges(t).map(function(t){return new bc(e.zf,t)})},e.prototype.forEach=function(t,e){var n=this;this._.forEach(function(r){t.call(e,new _c(n.zf,r))})},e.prototype.isEqual=function(t){return $a(this._,t._)},e}(E),Ec=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n)||this).firestore=e,r._=n,r}return(0,i.__extends)(e,t),Object.defineProperty(e.prototype,"id",{get:function(){return this._.id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this._.path},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){var t=this._.parent;return t?new dc(this.firestore,t):null},enumerable:!1,configurable:!0}),e.prototype.doc=function(t){try{return new dc(this.firestore,void 0===t?Os(this._):Os(this._,t))}catch(t){throw vc(t,"doc()","CollectionReference.doc()")}},e.prototype.add=function(t){var e=this;return function(t,e){var n=Is(t.firestore,Ea),r=Os(t),i=Ka(t.v_,e);return nc(n,[zs(js(t.firestore),"addDoc",r.S_,i,null!==t.v_,{}).F_(r.S_,Te.exists(!1))]).then(function(){return r})}(this._,t).then(function(t){return new dc(e.firestore,t)})},e.prototype.isEqual=function(t){return Ls(this._,t._)},e.prototype.withConverter=function(t){return new e(this.firestore,this._.withConverter(pc.Rd(this.firestore,t)))},e}(wc);function Tc(t){return t instanceof E&&(t=t._),Is(t,As)}exports.s=Ec,exports.c=Ic,exports.t=wc,exports.b=_c,exports.X=mc;var Nc=function(t){function e(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return t.call(this,new(ds.bind.apply(ds,(0,i.__spreadArrays)([void 0],e))))||this}return(0,i.__extends)(e,t),e.documentId=function(){return new e(j.lt().ot())},e.prototype.isEqual=function(t){return t instanceof E&&(t=t._),t instanceof ds&&this._.d_.isEqual(t.d_)},e}(E),xc=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return(0,i.__extends)(e,t),e.serverTimestamp=function(){var t=new Ks("serverTimestamp");return t._methodName="FieldValue.serverTimestamp",new e(t)},e.delete=function(){var t=new Gs("deleteField");return t._methodName="FieldValue.delete",new e(t)},e.arrayUnion=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Hs("arrayUnion",t)}.apply(void 0,t);return r._methodName="FieldValue.arrayUnion",new e(r)},e.arrayRemove=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Js("arrayRemove",t)}.apply(void 0,t);return r._methodName="FieldValue.arrayRemove",new e(r)},e.increment=function(t){var n=function(t){return new Ws("increment",t)}(t);return n._methodName="FieldValue.increment",new e(n)},e.prototype.isEqual=function(t){return this._.isEqual(t._)},e}(E),Ac=function(){function t(){this.gd={},this.Vd=new Zn,this.pd={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}return t.prototype.onProgress=function(t,e,n){this.gd={next:t,error:e,complete:n}},t.prototype.catch=function(t){return this.Vd.promise.catch(t)},t.prototype.then=function(t,e){return this.Vd.promise.then(t,e)},t.prototype.Ul=function(t){this.Ql(t),this.gd.complete&&this.gd.complete(),this.Vd.resolve(t)},t.prototype.Wl=function(t){this.pd.taskState="Error",this.gd.next&&this.gd.next(this.pd),this.gd.error&&this.gd.error(t),this.Vd.reject(t)},t.prototype.Ql=function(t){this.pd=t,this.gd.next&&this.gd.next(t)},t}();function Sc(t,e){var n=new Ac;return function(t,e,n,r){var o=this,u=function(t,e){return function(t,e){return new ps(t,e)}(function(t,e){if(t instanceof Uint8Array)return hs(t,e);if(t instanceof ArrayBuffer)return hs(new Uint8Array(t),e);if(t instanceof ReadableStream)return t.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}("string"==typeof t?(new TextEncoder).encode(t):t),e)}(n,Lo(e));t.fs.ys(function(){return(0,i.__awaiter)(o,void 0,void 0,function(){var e;return(0,i.__generator)(this,function(n){switch(n.label){case 0:return e=us,[4,ga(t)];case 1:return e.apply(void 0,[n.sent(),u,r]),[2]}})})})}(Ta(t._),t.I_,e,n),n}function Dc(t,e){return function(t,e){var n=this;return t.fs.enqueue(function(){return(0,i.__awaiter)(n,void 0,void 0,function(){var n;return(0,i.__generator)(this,function(r){switch(r.label){case 0:return n=function(t,e){var n=p(t);return n.persistence.runTransaction("Get named query","readonly",function(t){return n.Eo.$s(t,e)})},[4,va(t)];case 1:return[2,n.apply(void 0,[r.sent(),e])]}})})})}(Ta(t._),e).then(function(e){return e?new wc(t,new Ss(t._,null,e.query)):null})}exports.o=xc,exports.r=Nc;
},{"@firebase/logger":"TUpU","@firebase/util":"KxmD","@firebase/webchannel-wrapper":"ueHA","tslib":"vCxL","process":"pBGv"}],"oyBH":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.registerFirestore=o;var e=i(require("@firebase/app"));require("@firebase/logger"),require("@firebase/util"),require("@firebase/webchannel-wrapper"),require("tslib");var r=require("./prebuilt-d06d81e8-efab67e4.js"),t=require("@firebase/component");function i(e){return e&&e.__esModule?e:{default:e}}var n={Firestore:r.U,GeoPoint:r.n,Timestamp:r.z,Blob:r.L,Transaction:r.W,WriteBatch:r.j,DocumentReference:r.a,DocumentSnapshot:r.X,Query:r.t,QueryDocumentSnapshot:r.b,QuerySnapshot:r.c,CollectionReference:r.s,FieldPath:r.r,FieldValue:r.o,setLogLevel:r.K,CACHE_SIZE_UNLIMITED:r.d};function o(e){!function(e,i){e.INTERNAL.registerComponent(new t.Component("firestore",function(e){return function(e,t){return new r.U(e,new r.Z(e,t),new r.q)}(e.getProvider("app").getImmediate(),e.getProvider("auth-internal"))},"PUBLIC").setServiceProps(Object.assign({},n)))}(e),e.registerVersion("@firebase/firestore","2.1.4")}o(e.default);
},{"@firebase/app":"VxYX","@firebase/logger":"TUpU","@firebase/util":"KxmD","@firebase/webchannel-wrapper":"ueHA","tslib":"vCxL","./prebuilt-d06d81e8-efab67e4.js":"ydGY","@firebase/component":"sLOu"}],"vHL5":[function(require,module,exports) {
"use strict";require("@firebase/firestore");
},{"@firebase/firestore":"oyBH"}],"BSXI":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.firebaseKeys=void 0;const e={apiKey:"AIzaSyDsI-WePDEVH-ipRRYuV-uUZiLZBljN-dg",authDomain:"korn-fan-site.firebaseapp.com",projectId:"korn-fan-site",storageBucket:"korn-fan-site.appspot.com",messagingSenderId:"283242489356",appId:"1:283242489356:web:d3555a6276f86e495af029"};exports.firebaseKeys=e;
},{}],"UsDM":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.messages=void 0;var e=t(require("firebase/app"));require("firebase/firestore");var s=require("./keys");function t(e){return e&&e.__esModule?e:{default:e}}e.default.initializeApp(s.firebaseKeys);const a=e.default.firestore(),r={updateVotes:(s,t)=>a.collection("messages").doc(s).update({votes:e.default.firestore.FieldValue.increment(t)}),delete:e=>a.collection("messages").doc(e).delete(),create:e=>a.collection("messages").add({message:e,votes:0}),getAll:()=>a.collection("messages").get().then(e=>e.docs.map(e=>({id:e.id,...e.data()})))};exports.messages=r;
},{"firebase/app":"OJEJ","firebase/firestore":"vHL5","./keys":"BSXI"}],"Focm":[function(require,module,exports) {
"use strict";var e=n(require("./database"));function t(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return t=function(){return e},e}function n(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=t();if(n&&n.has(e))return n.get(e);var a={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in e)if(Object.prototype.hasOwnProperty.call(e,s)){var c=r?Object.getOwnPropertyDescriptor(e,s):null;c&&(c.get||c.set)?Object.defineProperty(a,s,c):a[s]=e[s]}return a.default=e,n&&n.set(e,a),a}const a=t=>{const n=document.createElement("tr");return n.setAttribute("id",t.id),n.innerHTML="\n    <td>".concat(t.message,"</td>\n    <td>").concat(t.votes,'</td>\n    <td>\n      <i class="material-icons upvote">thumb_up</i>\n      <i class="material-icons downvote">thumb_down</i>\n      <i class="material-icons delete">delete</i>\n    </td>\n  '),n.querySelector(".upvote").addEventListener("click",async()=>{await e.messages.updateVotes(t.id,1),r()}),n.querySelector(".downvote").addEventListener("click",async()=>{await e.messages.updateVotes(t.id,-1),r()}),n.querySelector(".delete").addEventListener("click",async()=>{await e.messages.delete(t.id),r()}),n},r=async()=>{const t=document.getElementById("message-container"),n=await e.messages.getAll();t.innerHTML="",n.forEach(e=>{const n=a(e);t.append(n)})},s=async()=>{await r(),document.getElementById("submit").addEventListener("click",async t=>{t.preventDefault();const n=document.getElementById("newmessage");await e.messages.create(n.value),r(),n.value=""})};"loading"===document.readyState?document.addEventListener("DOMContentLoaded",s):s();
},{"./database":"UsDM"}]},{},["Focm"], null)
//# sourceMappingURL=src.b48b7ddf.js.map